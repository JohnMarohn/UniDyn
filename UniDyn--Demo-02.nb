(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     40492,        974]
NotebookOptionsPosition[     35879,        897]
NotebookOutlinePosition[     36332,        915]
CellTagsIndexPosition[     36289,        912]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["UniDyn--Demo-02.nb", "Title",
 CellChangeTimes->{{3.6352690845273046`*^9, 3.635269100847275*^9}, {
  3.6609180081345453`*^9, 3.660918013241088*^9}, {3.661433595181979*^9, 
  3.661433595493599*^9}},ExpressionUUID->"fca9def9-7c4a-43e1-b1de-\
916338efabe2"],

Cell["\<\
John A. Marohn
jam99@cornell.edu
Cornell University\
\>", "Text",
 CellChangeTimes->{{3.635269101985786*^9, 3.635269121580956*^9}},
 FontSize->18,ExpressionUUID->"940bbff1-bf05-40de-8bd9-719010930089"],

Cell[TextData[{
 StyleBox["Abstract:",
  FontWeight->"Bold"],
 "  Use the ",
 StyleBox["UniDyn",
  FontWeight->"Bold"],
 " Evolver function to calculate the evolution of the magnetization of a \
single spin 1/2 particle under off-resonance, variable-phase irradiation.  \
Plot the evolving magnetization for various combinations of resonance offset \
and irradiation phase."
}], "Text",
 CellChangeTimes->{{3.6352698622319117`*^9, 3.635269926908793*^9}, {
   3.6352701305950613`*^9, 3.635270138669529*^9}, {3.6614336154747458`*^9, 
   3.661433666560676*^9}, {3.661433776071369*^9, 3.6614337761699266`*^9}, {
   3.6614620415959*^9, 3.66146210493357*^9}, 3.859897027180781*^9},
 FontSize->18,ExpressionUUID->"06f4ce1c-b841-4757-8def-0bcfef6e6d1f"],

Cell[CellGroupData[{

Cell["Set the path to the package", "Section",
 CellChangeTimes->{{3.635270036711257*^9, 
  3.63527004852262*^9}},ExpressionUUID->"6fbb75f9-49a0-4a91-8942-\
ec96386d5952"],

Cell[TextData[{
 "Tell ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " the path to the directory containing the package.    \n\nEDIT THE \
FOLLOWING PATH STRINGS:"
}], "Text",
 CellChangeTimes->{{3.635270060901009*^9, 3.635270086988311*^9}, {
   3.6610825274488792`*^9, 3.6610825288209763`*^9}, 3.8598970571970263`*^9},
 FontSize->16,ExpressionUUID->"2faf2085-ed1f-44e3-bb4c-6505fc87d772"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
   "$UniDynPath", " ", "=", 
    "\"\</Users/jam99/Dropbox/MarohnGroup__Software_Library/UniDyn/unidyn\>\"\
"}], ";"}], " "}]], "Input",
 CellChangeTimes->{{3.6349053527016897`*^9, 3.6349054064223843`*^9}, {
   3.634910931339162*^9, 3.634910931457775*^9}, {3.634914337947165*^9, 
   3.6349143671071568`*^9}, {3.634922597904743*^9, 3.634922606812076*^9}, {
   3.635268730835155*^9, 3.635268731125407*^9}, {3.635269951638358*^9, 
   3.635269958323474*^9}, {3.660918115324842*^9, 3.660918132325369*^9}, {
   3.660918590921587*^9, 3.660918600403768*^9}, 3.859897066393388*^9, 
   3.9401813644960327`*^9},
 FontSize->16,
 CellLabel->"In[1]:=",ExpressionUUID->"69d76d11-3be0-4f4b-8175-4ecb94e003b7"],

Cell["YOU SHOULD NOT NEED TO EDIT ANYTHING FROM HERE ONWARDS.", "Text",
 CellChangeTimes->{{3.635270073196437*^9, 3.635270077357624*^9}},
 FontSize->16,ExpressionUUID->"be4519d5-a74b-4bf3-9bfa-30560f9a71ee"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Load the package", "Section",
 CellChangeTimes->{{3.635269129230983*^9, 
  3.63526913095236*^9}},ExpressionUUID->"43fa3d42-aa34-41cc-9efc-\
0347c21e3a60"],

Cell[TextData[{
 "Append the package path to the system path.  Before trying to load the \
package, ask ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " to find it.  This is a test that we directed ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " to the correct directory.  The output of this command should be the full \
system path to the UniDyn.m file.   "
}], "Text",
 CellChangeTimes->{{3.635269223597199*^9, 3.635269340159473*^9}, {
   3.635269947982662*^9, 3.6352699492517843`*^9}, {3.635269985297124*^9, 
   3.63527000724584*^9}, 3.635270066996499*^9, {3.63527010818321*^9, 
   3.6352701131658497`*^9}, {3.660918102499856*^9, 3.6609181035465183`*^9}},
 FontSize->18,ExpressionUUID->"fa22e656-7282-4b34-8fb8-9fc01f941d8c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$Path", " ", "=", " ", 
   RowBox[{"AppendTo", "[", 
    RowBox[{"$Path", ",", "$UniDynPath"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"FindFile", "[", "\"\<UniDyn`\>\"", "]"}]}], "Input",
 CellChangeTimes->{{3.634906393354924*^9, 3.634906398308229*^9}, {
   3.634922599063291*^9, 3.634922599752222*^9}, {3.635268728673848*^9, 
   3.6352687402094*^9}, {3.635269954012105*^9, 3.6352699550474253`*^9}, {
   3.859897078324489*^9, 3.8598970853975677`*^9}, 3.8598971531428223`*^9, {
   3.940181368955099*^9, 3.940181372281011*^9}},
 FontSize->16,
 CellLabel->"In[2]:=",ExpressionUUID->"2de83763-a67c-4565-9352-3b68249d64e5"],

Cell["\<\
Now that we are confident that the path is set correctly, load the package.  \
Setting the global $VerboseLoad variable to True will print out the help \
strings for key commands in the package.  \
\>", "Text",
 CellChangeTimes->{{3.635269347360386*^9, 3.63526943190546*^9}, 
   3.859897841574958*^9},
 FontSize->18,ExpressionUUID->"4408d83d-8eca-4921-99dc-00913b46a067"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$VerboseLoad", " ", "=", "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Needs", "[", "\"\<UniDyn`\>\"", "]"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQfYUjQpVD9LXjxxR+TRC9peyGEyeQ/lH0EExXTKuJ
BdGbVk8B0zYvFOpA9Ik35o0gmsEzcwKI3ruyF0yrn4ubDqITDHPAdMGBGUdA
9K1JG8G0V4+DGg+Q1vtwBUyLu5WcAtE8yv6nQfT861tdBUDm3NFxA9F2v/Ym
g+h4M4cUED09+VEGiC6rzcoH0RUNSUHSQHqfnVQoiP6uyGkiC6T5nmeCabdp
f25FAekIO8nbINqkKUQlBUiz/Z0DplNs3jwG0Q88GJ+A6Bf2PcZdQNqjYi6Y
XnQt//l3t9eOqzNZX4DoFiF11h9A+sM0WzCtqnCwYKH7a8c9B1ULQTQAyl6Q
EA==
  "],
 FontSize->16,
 CellLabel->"In[4]:=",ExpressionUUID->"040a79b4-1eb2-4cbd-b38d-08741e01bd05"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Function to help draw the magnetization", "Section",
 CellChangeTimes->{{3.661456120234693*^9, 3.661456137146701*^9}, {
  3.661461808207046*^9, 3.661461808530703*^9}, {3.859897219334643*^9, 
  3.859897224642501*^9}},ExpressionUUID->"071ca845-3af7-4202-b311-\
c65823ae3498"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "my$drawing", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetAttributes", "[", 
    RowBox[{"my$drawing", ",", "HoldAll"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"my$drawing", "[", 
   RowBox[{
    RowBox[{"func_", "[", 
     RowBox[{"t_", ",", "a___"}], "]"}], ",", " ", "t$final_", ",", " ", 
    "N$step_"}], "]"}], " ", ":=", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\[Rho]$vector$data", ",", "\[Rho]$arrows", ",", "axes$arrows", ",", " ",
       "big$plot"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Calculate", " ", "a", " ", "final", " ", "time", " ", "and", " ", "a", 
      " ", "time", " ", "step"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "The", " ", "final", " ", "time", " ", "point", " ", "should", " ", 
      "not", " ", "be", " ", "included", " ", "in", " ", "the", " ", "plot"}],
      " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"T$max", " ", "=", " ", 
      RowBox[{"t$final", "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"N$step", "-", "1"}], ")"}], "/", "N$step"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"T$step", " ", "=", " ", 
      RowBox[{"t$final", "/", "N$step"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Make", " ", "a", " ", "table", " ", "of", " ", "data", " ", "of", " ", 
       "the", " ", "form"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.", ",", 
          RowBox[{"{", 
           RowBox[{"0.", ",", "0.", ",", "1."}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.5", ",", 
          RowBox[{"{", 
           RowBox[{"0.", ",", 
            RowBox[{"-", "0.9"}], ",", 
            RowBox[{"-", "0.5"}]}], "}"}]}], "}"}]}], " "}], "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]$vector$data", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"N", "[", 
           RowBox[{"t", "/", "T$max"}], "]"}], ",", 
          RowBox[{"N", "[", 
           RowBox[{"func", "[", 
            RowBox[{"t", ",", "a"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "T$max", ",", "T$step"}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Add", " ", "arrows"}], ";", " ", 
       RowBox[{
       "the", " ", "arrows", " ", "grow", " ", "from", " ", "light", " ", 
        "to", " ", "dark", " ", "as", " ", "time", " ", "progresses", " ", 
        "in", " ", "the", " ", "plot"}]}], "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Rho]$arrows", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"GrayLevel", "[", 
            RowBox[{"1.0", "-", 
             RowBox[{"N", "[", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Arrowheads", "[", "0.015", "]"}], ",", 
             RowBox[{"Arrow", "[", 
              RowBox[{"Tube", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}], "]"}]}], 
            "}"}]}], "}"}], "]"}], "&"}], "/@", "\[Rho]$vector$data"}]}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Add", " ", "axes", " ", 
       RowBox[{"arrows", ".", "  ", "Here"}], " ", "we", " ", "make", " ", 
       "the", " ", "assumption", " ", "that", " ", "the", " ", 
       "magnetization", " ", "vector"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", "  ", 
      RowBox[{"has", " ", "a", " ", "magnitude", " ", "of", " ", "1."}], " ", 
      "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"axes$arrows", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Black", ",", 
           RowBox[{"Arrow", "[", 
            RowBox[{"Tube", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "#"}], "}"}], 
             "]"}], "]"}]}], "}"}], "]"}], "&"}], " ", "/@", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1.25"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1.25", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1.25", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           RowBox[{"-", "1.25"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"-", "1.25"}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1.25"}], ",", "0", ",", "0"}], "}"}]}], "}"}]}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"big$plot", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Append", "[", 
        RowBox[{"\[Rho]$arrows", ",", "axes$arrows"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Add", " ", "axes", " ", 
       RowBox[{"labels", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"big$plot", " ", "=", " ", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Append", "[", 
        RowBox[{"big$plot", ",", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"z", ",", "Large"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "1.35"}], "}"}]}], "]"}], "]"}]}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"big$plot", " ", "=", " ", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Append", "[", 
        RowBox[{"big$plot", ",", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"y", ",", "Large"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1.35", ",", "0"}], "}"}]}], "]"}], "]"}]}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"big$plot", " ", "=", " ", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Append", "[", 
        RowBox[{"big$plot", ",", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"x", ",", "Large"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"1.35", ",", "0", ",", "0"}], "}"}]}], "]"}], "]"}]}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Plot", " ", "all", " ", "the", " ", 
       RowBox[{"arrows", ".", "  ", "The"}], " ", "neutral", " ", "lighting", 
       " ", "helps", " ", "making", " ", "the", " ", "rendering", " ", 
       RowBox[{"fast", " ", "--"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", "  ", 
      RowBox[{
       RowBox[{
       "the", " ", "default", " ", "Mathematica", " ", "camera", " ", "has", 
        " ", "three"}], "-", 
       RowBox[{
       "colored", " ", "lights", " ", "which", " ", "makes", " ", "funny", 
        " ", "reflections"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", "  ", 
      RowBox[{
      "of", " ", "off", " ", "small", " ", "objects", " ", "like", " ", "our",
        " ", 
       RowBox[{"arrows", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{"big$plot", ",", 
       RowBox[{"Boxed", "\[Rule]", " ", "False"}], ",", " ", 
       RowBox[{"ViewVertical", "->", 
        RowBox[{"{", 
         RowBox[{"0", ",", " ", "0", ",", " ", "1"}], "}"}]}], ",", 
       RowBox[{"ViewPoint", "\[Rule]", " ", 
        RowBox[{"{", 
         RowBox[{"2.0", ",", 
          RowBox[{"-", "1.0"}], ",", "1.0"}], "}"}]}], ",", 
       RowBox[{"Lighting", "\[Rule]", " ", "\"\<Neutral\>\""}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwdzlkowwEABvBZsbkKkXKTKyIUORdWm4RQm6OIMUeZ6wEJseTYwzLkmHLk
HEOuaEmhbNay8CKWxEIJI8zRsO//8PV7+L6Hz5NTlcklk0gkL2Pgfepbu5T5
kKCrk3dCmsehEA6I2ntgI0s+CO3V3ePQ5qNyDh5tMiTQJT3/DCZXu53DRNWx
FoY/h93BqcdVPSwu7f2Evok0A9S+jFgvGi18urKFFHNlIFT+VYTAj/DLCLht
MhkDv8VpsbCpVU6H2WW3TNgf7Z0GT2J1eUQ/ts2BAa/cEhjpYOBBVQu5AY5K
1oeJXdQFoewzZwbuBNfMQsG7zTLkMRwJxSt0NXxhUk7h777mC6rd236I/xt6
yyWjQu2BFXS4kTlDp2axK8weSwqAB1RZKPTetIgjzNLQYO3WFAM+LhQwoWHy
OgWyPeIyYFFGAwteUZLYkLWbkguDNHtc2NVSz4OmAkYl9NlR8aH/uq4Drk0P
i+CQwLcPSjylP3BposIAr/nldstGzRR8QsW8wg9SpQ/x8B8YrB4O
  "],
 FontSize->16,
 CellLabel->"In[6]:=",ExpressionUUID->"6ee73c83-4b14-471b-aa6c-d4c7ad6c8361"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Examples of unitary evolution in a spin 1/2 system", "Section",
 CellChangeTimes->{{3.6614338330758963`*^9, 3.661433850988009*^9}, {
  3.6614339433230333`*^9, 
  3.661433947755453*^9}},ExpressionUUID->"6bafe0c4-7af5-45e4-a285-\
4186ce080de1"],

Cell[CellGroupData[{

Cell["Create a single spin", "Subsection",
 CellChangeTimes->{{3.661433931683024*^9, 
  3.661433953976736*^9}},ExpressionUUID->"711b3caf-7152-4654-abc9-\
5df556ca8417"],

Cell[TextData[{
 "The assumptions define below are required for ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " to recognize ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SqrtBox[
     RowBox[{"\[Dash]", 
      RowBox[{
       SuperscriptBox["\[CapitalDelta]", "2"], "-", 
       SuperscriptBox["\[Omega]", "2"]}]}]], "=", " ", 
    RowBox[{"I", 
     SqrtBox[
      RowBox[{
       SuperscriptBox["\[CapitalDelta]", "2"], "+", 
       SuperscriptBox["\[Omega]", "2"]}]]}]}], TraditionalForm]],
  FontSize->14,ExpressionUUID->"74c803da-7ce4-4b5e-bc6c-a57068adb365"],
 " inside an exponential.   One of the variables has to be defined to be > 0 \
and not just \[GreaterSlantEqual] 0."
}], "Text",
 CellChangeTimes->{{3.661454934610312*^9, 3.661455077339642*^9}, {
   3.661455120999338*^9, 3.6614551250107203`*^9}, {3.66145516298409*^9, 
   3.661455238939184*^9}, {3.6614552751916943`*^9, 3.6614553005499*^9}, 
   3.66169791700492*^9},
 FontSize->18,ExpressionUUID->"77da6aa8-fdb0-48b2-ae2f-064ed48122f1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"\[CapitalDelta]", ",", "                     ", 
    RowBox[{"(*", " ", 
     RowBox[{"resonance", " ", "offset", " ", "frequency"}], " ", "*)"}], 
    "\[IndentingNewLine]", "\[Omega]", ",", "                     ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Rabi", " ", "frequency", " ", "of", " ", "the", " ", "applied", " ", 
      "irradiation"}], " ", "*)"}], "\[IndentingNewLine]", "\[Phi]", ",", 
    "                     ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "phase", " ", "of", " ", "the", " ", "applied", " ", "irradiation"}], 
     " ", "*)"}], "\[IndentingNewLine]", "t", ",", "                      ", 
    RowBox[{"(*", " ", "time", " ", "*)"}], "\[IndentingNewLine]", "Ix", ",", 
    " ", "Iy", ",", " ", "Iz", ",", " ", 
    RowBox[{"(*", " ", 
     RowBox[{"spin", " ", "angular", " ", "momentum", " ", "operators"}], " ",
      "*)"}], "\[IndentingNewLine]", "\[Rho]", ",", "                      ", 
    
    RowBox[{"(*", " ", 
     RowBox[{"spin", " ", "density", " ", "operator"}], " ", "*)"}], " ", 
    "\[IndentingNewLine]", "\[Rho]$0", ",", "                  ", 
    RowBox[{"(*", " ", 
     RowBox[{"initial", " ", "spin", " ", "density", " ", "operator"}], " ", 
     "*)"}], "\[IndentingNewLine]", "H"}], "                          ", 
   RowBox[{"(*", " ", 
    RowBox[{"spin", " ", "Hamiltonian"}], " ", "*)"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CreateScalar", "[", 
   RowBox[{"\[CapitalDelta]", ",", "\[Omega]", ",", "\[Phi]", " ", ",", "t"}],
    "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SpinSingle$CreateOperators", "[", 
    RowBox[{"Ix", ",", " ", "Iy", ",", " ", "Iz", ",", " ", 
     RowBox[{"L", "=", 
      RowBox[{"1", "/", "2"}]}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$Assumptions", "  ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Element", "[", 
      RowBox[{"\[CapitalDelta]", ",", " ", "Reals"}], "]"}], ",", " ", 
     RowBox[{"\[CapitalDelta]", " ", "\[GreaterSlantEqual]", " ", "0"}], ",", 
     " ", 
     RowBox[{"Element", "[", 
      RowBox[{"\[Omega]", ",", " ", "Reals"}], "]"}], ",", " ", 
     RowBox[{"\[Omega]", "  ", ">", " ", "0"}], ",", 
     RowBox[{"Element", "[", 
      RowBox[{"t", ",", " ", "Reals"}], "]"}], ",", " ", 
     RowBox[{"t", "  ", "\[GreaterSlantEqual]", " ", "0"}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.6614339585492563`*^9, 3.661434010703532*^9}, {
   3.661434214867899*^9, 3.661434222437502*^9}, {3.661434384868638*^9, 
   3.6614346039604807`*^9}, {3.6614346490398808`*^9, 3.661434789890903*^9}, {
   3.661435094092959*^9, 3.661435125986967*^9}, {3.6614352184576807`*^9, 
   3.661435260920999*^9}, 3.661454979504386*^9, {3.6614550830373096`*^9, 
   3.6614550896485147`*^9}, {3.661455140167131*^9, 3.66145514338946*^9}, {
   3.6614552141564493`*^9, 3.661455268214559*^9}, {3.8598975287957563`*^9, 
   3.859897599934474*^9}},
 FontSize->16,
 CellLabel->"In[9]:=",ExpressionUUID->"cb060012-c97e-4f6b-97db-610ad428555c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Off-resonance variable-phase nutation", "Subsection",
 CellChangeTimes->{{3.661433867714074*^9, 3.661433876857678*^9}},
 FontSize->18,ExpressionUUID->"dbfd9f6d-d321-4530-8fbd-774f4c2da47e"],

Cell[TextData[{
 "Irradiation Hamiltonian written in the interaction representation.  The \
intial density operator is parallel to ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["I", "z"], TraditionalForm]],ExpressionUUID->
  "20da6cda-6afc-4b21-b60b-80202365cc58"],
 "."
}], "Text",
 CellChangeTimes->{{3.66145534764102*^9, 3.661455424815099*^9}, 
   3.8598972880237627`*^9},
 FontSize->18,ExpressionUUID->"6a081577-3dc4-4cdf-8a1b-0dd2bf8d719a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"H", " ", "=", " ", 
   RowBox[{
    RowBox[{"\[CapitalDelta]", " ", "Iz"}], " ", "+", " ", 
    RowBox[{"\[Omega]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", "Ix"}], " ", "+", " ", 
       RowBox[{
        RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", "Iy"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]$0", " ", "=", " ", "Iz"}], ";"}]}], "Input",
 CellChangeTimes->{{3.661435227848398*^9, 3.6614352284068127`*^9}},
 FontSize->18,
 CellLabel->"In[13]:=",ExpressionUUID->"df6a6e30-a247-4f85-ac4d-acd947a03247"],

Cell["\<\
Calculating the time-dependent density operator might take as long as 10 to \
15 seconds to complete.  \
\>", "Text",
 CellChangeTimes->{{3.6614351443358517`*^9, 3.661435173054531*^9}, {
   3.6614549233087606`*^9, 3.661454923410828*^9}, {3.66145543210454*^9, 
   3.661455456329935*^9}, 3.859897291075653*^9},
 FontSize->18,ExpressionUUID->"648eaf02-76e3-41b2-8d79-1d8886269ca0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Rho]", " ", "[", 
     RowBox[{
     "t_", ",", "\[CapitalDelta]_", ",", " ", "\[Omega]_", ",", "\[Phi]_"}], 
     "]"}], "=", " ", 
    RowBox[{"Collect", "[", " ", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Evolver", "[", 
           RowBox[{"H", ",", " ", "t", ",", " ", "\[Rho]$0"}], "]"}], "//", 
          "Simplify"}], "//", " ", "ExpToTrig"}], " ", "//", " ", 
        "FullSimplify"}], ")"}], ",", " ", "\[IndentingNewLine]", "\t", 
      RowBox[{"{", 
       RowBox[{"Ix", ",", "Iy", ",", " ", "Iz"}], "}"}]}], "]"}]}], ";"}], 
  " "}]], "Input",
 CellChangeTimes->{{3.6614340197481413`*^9, 3.661434178968038*^9}, {
   3.661434272954471*^9, 3.661434333128969*^9}, {3.661434640514575*^9, 
   3.661434643212017*^9}, {3.661434786650895*^9, 3.661434809637779*^9}, {
   3.661435106977956*^9, 3.661435116198124*^9}, {3.6614351828003273`*^9, 
   3.661435197915441*^9}, 3.661455661961378*^9, {3.6614557085212173`*^9, 
   3.6614557978065453`*^9}, {3.661455834919834*^9, 3.6614558778332987`*^9}, 
   3.859897483478348*^9},
 FontSize->18,
 CellLabel->"In[15]:=",ExpressionUUID->"5a3b56d6-e734-41ef-b80c-1c7b2a6069a0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]", "[", 
    RowBox[{
    "t", ",", "\[CapitalDelta]", ",", " ", "\[Omega]", ",", "\[Phi]"}], "]"}],
    " ", "/.", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[CapitalDelta]", "->", " ", 
      RowBox[{"Subscript", "[", 
       RowBox[{"\[Omega]", ",", "0"}], "]"}]}], ",", " ", 
     RowBox[{"\[Omega]", " ", "->", " ", 
      RowBox[{"Subscript", "[", 
       RowBox[{"\[Omega]", ",", "1"}], "]"}]}]}], "}"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.6614340197481413`*^9, 3.661434178968038*^9}, {
   3.661434272954471*^9, 3.661434333128969*^9}, {3.661434640514575*^9, 
   3.661434643212017*^9}, {3.661434786650895*^9, 3.661434809637779*^9}, {
   3.661435106977956*^9, 3.661435116198124*^9}, {3.6614351828003273`*^9, 
   3.661435197915441*^9}, 3.661455661961378*^9, {3.6614557085212173`*^9, 
   3.6614557978065453`*^9}, {3.661455834919834*^9, 3.6614558778332987`*^9}, 
   3.859897483478348*^9},
 FontSize->18,
 CellLabel->"In[16]:=",ExpressionUUID->"c1927ee8-d5d0-4ab0-aa6c-23d543413e21"],

Cell[TextData[{
 "Below we want a function that returns a triple of numbers describing the \
magnetization vector.  We turn the above expression for the density operator \
into a triple of numbers using the ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " function Coefficient.  I tried using the NCAlgebra\[CloseCurlyQuote]s \
NCCoefficient function but could not get it to work.  The function below does \
what we want."
}], "Text",
 CellChangeTimes->{{3.661456225990507*^9, 3.66145635020822*^9}, 
   3.661697941532072*^9, 3.8598972587929153`*^9},
 FontSize->18,ExpressionUUID->"3989c68d-dc8b-44f2-8ed3-94938d0ad7b2"],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{"\[Rho]$vector", "[", 
    RowBox[{
    "t_", ",", "\[CapitalDelta]_", ",", " ", "\[Omega]_", ",", "\[Phi]_"}], 
    "]"}], " ", "=", " ", 
   RowBox[{"Simplify", "[", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Coefficient", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{
         "t", ",", "\[CapitalDelta]", ",", " ", "\[Omega]", ",", "\[Phi]"}], 
         "]"}], ",", "#", ",", "1"}], "]"}], "&"}], " ", "/@", " ", 
     RowBox[{"{", 
      RowBox[{"Ix", " ", ",", "Iy", ",", "Iz"}], "}"}]}], "]"}]}]}]], "Input",\

 CellChangeTimes->{{3.6614561412281027`*^9, 3.6614561982630243`*^9}},
 FontSize->18,
 CellLabel->"In[17]:=",ExpressionUUID->"fb5f8160-1748-4220-8900-b66c49becac7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Check limiting cases", "Subsection",
 CellChangeTimes->{{3.6614350013632603`*^9, 
  3.661435010998869*^9}},ExpressionUUID->"4979c1af-e4a2-4b5f-b580-\
b915d6bb2226"],

Cell["\<\
On resonance, the effective field is in the x-y plane.  The z magnetization \
will oscillate co-sinusoidally while the magnetization in the x-y plane will \
oscillate sinusoidally.\
\>", "Text",
 CellChangeTimes->{{3.661445141236219*^9, 3.6614452239058037`*^9}, {
   3.661445259226839*^9, 3.6614452766541243`*^9}, {3.661454738110759*^9, 
   3.6614547399929447`*^9}, {3.661454771642885*^9, 3.6614547726337423`*^9}, 
   3.859897337651609*^9},
 FontSize->18,ExpressionUUID->"2eea17c6-998a-456b-9775-5827f8ed9d2f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]", "[", 
    RowBox[{"t", ",", "0", ",", " ", "\[Omega]", ",", "\[Phi]"}], "]"}], " ", 
   "//", " ", "PowerExpand"}], " ", "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.66143488240217*^9, 3.661434967708303*^9}, {
  3.661445228335499*^9, 3.6614452460563383`*^9}, {3.6614559115613832`*^9, 
  3.661455913330413*^9}},
 FontSize->18,
 CellLabel->"In[18]:=",ExpressionUUID->"402420b7-4c3a-479a-ac92-27c59247adc0"],

Cell["\<\
Apply a \[Pi] pulse.  Observe that the magnetization is indeed inverted.\
\>", "Text",
 CellChangeTimes->{{3.6614453092819777`*^9, 3.66144535098521*^9}, {
  3.661454779672694*^9, 3.661454786158607*^9}},
 FontSize->18,ExpressionUUID->"22933d09-e88f-41f4-98c1-a70eb409b1fb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Rho]", "[", " ", 
   RowBox[{
    RowBox[{"\[Pi]", "/", "\[Omega]"}], ",", "0", ",", " ", "\[Omega]", ",", 
    "0"}], "]"}], " ", "//", " ", "PowerExpand"}]], "Input",
 CellChangeTimes->{{3.661445022077269*^9, 3.661445075882185*^9}, {
  3.6614451120833187`*^9, 3.661445122595236*^9}, {3.661455920740048*^9, 
  3.661455944740162*^9}},
 FontSize->18,
 CellLabel->"In[19]:=",ExpressionUUID->"6e465590-8aad-4a5f-b374-842d3fbeab3b"],

Cell["\<\
Now apply a \[Pi]/2 pulse.  Appying an \[OpenCurlyDoubleQuote]x\
\[CloseCurlyDoubleQuote] pulse, one with a relative phase of \[Phi]=0, places \
the magnetization along the -y axis.  A \[OpenCurlyDoubleQuote]y\
\[CloseCurlyDoubleQuote] pulse, one with a relative phase of \[Phi] = \
\[Pi]/2, places the magnetization along the +x axis.\
\>", "Text",
 CellChangeTimes->{{3.661454789358259*^9, 3.661454880990548*^9}},
 FontSize->18,ExpressionUUID->"1c33cc67-03a3-4f74-a268-87bfcf9ee211"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Rho]", "[", 
     RowBox[{
      RowBox[{"\[Pi]", "/", 
       RowBox[{"(", 
        RowBox[{"2", " ", "\[Omega]"}], ")"}]}], ",", "0", ",", " ", 
      "\[Omega]", ",", "#"}], "]"}], "&"}], " ", "/@", " ", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"\[Pi]", "/", "2"}]}], "}"}]}], " ", "//", " ", 
  "PowerExpand"}]], "Input",
 CellChangeTimes->{{3.661455950795164*^9, 3.6614560706602993`*^9}},
 FontSize->18,
 CellLabel->"In[20]:=",ExpressionUUID->"c87a60b8-421f-4086-ab0e-db403e83b573"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Draw the magnetization", "Subsection",
 CellChangeTimes->{{3.661458528049267*^9, 
  3.661458532459564*^9}},ExpressionUUID->"86ead0d7-ed6f-484f-bdfc-\
3a9a40b1d0fe"],

Cell[TextData[{
 "Set the rf phase to \[Phi] = 0,  set the Rabi frequency to \[Omega] = 1, \
and set the resonance offset to \[CapitalDelta] = 2.  The effective field has \
a magnitude of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SqrtBox[
     RowBox[{
      SuperscriptBox["2", "2"], "+", 
      SuperscriptBox["1", "2"]}]], "=", " ", 
    SqrtBox["5"]}], TraditionalForm]],ExpressionUUID->
  "6536d5e2-8f7f-44a9-8743-1bb820dba4e1"],
 ", so we\[CloseCurlyQuote]ll watch the magnetization out to a time of ",
 Cell[BoxData[
  FormBox[
   RowBox[{"2", 
    RowBox[{"\[Pi]", " ", "/", 
     SqrtBox["5"]}]}], TraditionalForm]],ExpressionUUID->
  "caf98c7a-2802-45ce-b5cb-d00a5fa19eb5"],
 " in order to capture the magnetization orbiting once around the effective \
field."
}], "Text",
 CellChangeTimes->{{3.661462346470071*^9, 3.661462499410248*^9}, 
   3.859897725189808*^9},
 FontSize->16,ExpressionUUID->"df129454-f1be-436a-86d1-2b160c0dc454"],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"my$drawing", "[", 
    RowBox[{
     RowBox[{"\[Rho]$vector", "[", 
      RowBox[{"t", ",", "2", ",", " ", "1", ",", "0"}], "]"}], ",", 
     FractionBox[
      RowBox[{"2", "\[Pi]"}], 
      SqrtBox["5"]], " ", ",", " ", "36"}], "]"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Full"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.661462193294182*^9, 3.66146224993227*^9}, {
  3.661462307266276*^9, 3.661462310232806*^9}, {3.661540782826396*^9, 
  3.661540790387157*^9}},
 FontSize->16,
 CellLabel->"In[21]:=",ExpressionUUID->"c5a6e0e9-458c-40a2-bfb3-977a0b93e2e5"],

Cell["\<\
Set the rf phase to \[Phi] = 0, set the Rabi frequency to \[Omega] = 1, and \
look at magnetization out to times equal to \[Pi]/2.  Vary the resonance \
offset and plot the magnetization. \
\>", "Text",
 CellChangeTimes->{{3.661461161171054*^9, 3.661461323175413*^9}, {
   3.661461367913107*^9, 3.661461369017161*^9}, {3.6614625161410723`*^9, 
   3.661462539093068*^9}, 3.859897757554124*^9},
 FontSize->18,ExpressionUUID->"898d6f7d-7daa-47c5-a803-020d5ecafc84"],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"GraphicsGrid", " ", "@@", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"my$drawing", "[", 
         RowBox[{
          RowBox[{"\[Rho]$vector", "[", 
           RowBox[{"t", ",", "#", ",", " ", "1", ",", "0"}], "]"}], ",", 
          RowBox[{"\[Pi]", "/", "2"}], ",", " ", "18"}], "]"}], "}"}], "&"}], 
      " ", "\[IndentingNewLine]", "/@", " ", 
      RowBox[{"{", 
       RowBox[{"0.", ",", "1.", ",", "2.", ",", "3."}], "}"}]}], "}"}]}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Full"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.661458588798538*^9, 3.6614586115330048`*^9}, {
   3.66145869490186*^9, 3.6614586959315653`*^9}, {3.661458753453403*^9, 
   3.6614587742943687`*^9}, {3.6614588320579653`*^9, 
   3.6614588559055033`*^9}, {3.661458970940702*^9, 3.6614589795445957`*^9}, {
   3.661459149537085*^9, 3.661459149598215*^9}, {3.661459327692335*^9, 
   3.661459329264583*^9}, {3.661459478162506*^9, 3.661459480710063*^9}, {
   3.661459771728294*^9, 3.661459786310679*^9}, {3.6614598268972797`*^9, 
   3.6614598312304792`*^9}, {3.6614600007656393`*^9, 3.6614600010010643`*^9}, 
   3.6614600604054737`*^9, {3.661460541372858*^9, 3.661460541685663*^9}, {
   3.661460863084551*^9, 3.661460996693246*^9}, {3.661461036241066*^9, 
   3.6614611032299643`*^9}, {3.661461489360958*^9, 3.66146151236849*^9}, 
   3.661461568373617*^9},
 FontSize->18,
 CellLabel->"In[22]:=",ExpressionUUID->"0ea7aa7f-81fc-483f-9da9-12235b0c711e"],

Cell["\<\
Set the resonance offset d \[CapitalDelta] = 0, set the Rabi frequency to \
\[Omega] = 1, and look at magnetization out to times equal to \[Pi]/2.  Vary \
the rf phase and plot the magnetization.\
\>", "Text",
 CellChangeTimes->{{3.661461161171054*^9, 3.661461363138595*^9}, {
  3.661462550241778*^9, 3.661462550904059*^9}, {3.859897773611088*^9, 
  3.859897792296879*^9}},
 FontSize->18,ExpressionUUID->"e550e490-59de-4d5c-a778-728094967acc"],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"GraphicsGrid", " ", "@@", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"my$drawing", "[", 
         RowBox[{
          RowBox[{"\[Rho]$vector", "[", 
           RowBox[{"t", ",", "0", ",", " ", "1", ",", "#"}], "]"}], ",", 
          RowBox[{"\[Pi]", "/", "2"}], ",", " ", "18"}], "]"}], "}"}], "&"}], 
      " ", "\[IndentingNewLine]", "/@", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.", ",", "45", ",", "90", ",", "180", ",", " ", "270"}], 
         "}"}], " ", 
        FractionBox["\[Pi]", "180"]}], ")"}]}], "}"}]}], ",", 
   RowBox[{"ImageSize", "\[Rule]", " ", "Full"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.661458588798538*^9, 3.6614586115330048`*^9}, {
   3.66145869490186*^9, 3.6614586959315653`*^9}, {3.661458753453403*^9, 
   3.6614587742943687`*^9}, {3.6614588320579653`*^9, 
   3.6614588559055033`*^9}, {3.661458970940702*^9, 3.6614589795445957`*^9}, {
   3.661459149537085*^9, 3.661459149598215*^9}, {3.661459327692335*^9, 
   3.661459329264583*^9}, {3.661459478162506*^9, 3.661459480710063*^9}, {
   3.661459771728294*^9, 3.661459786310679*^9}, {3.6614598268972797`*^9, 
   3.6614598312304792`*^9}, {3.6614600007656393`*^9, 3.6614600010010643`*^9}, 
   3.6614600604054737`*^9, {3.661460541372858*^9, 3.661460541685663*^9}, {
   3.661460863084551*^9, 3.661460996693246*^9}, {3.661461036241066*^9, 
   3.6614611032299643`*^9}, {3.6614613756774282`*^9, 3.661461430361413*^9}, {
   3.66146153004705*^9, 3.6614616290756187`*^9}},
 FontSize->18,
 CellLabel->"In[23]:=",ExpressionUUID->"4fb489fc-d733-41b3-831a-2778d839f1e2"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Clean up", "Section",
 CellChangeTimes->{{3.661434199971715*^9, 
  3.661434206498426*^9}},ExpressionUUID->"e41863f1-4338-49d3-9216-\
37d168d3bcd5"],

Cell[BoxData[
 RowBox[{"(*", " ", "\[IndentingNewLine]", 
  RowBox[{"Clear", "[", 
   RowBox[{
   "\[Omega]", ",", " ", "\[CapitalDelta]", ",", " ", "\[Phi]", ",", " ", "t",
     ",", " ", "Ix", ",", " ", "Iy", ",", " ", "Iz", ",", " ", "\[Rho]", ",", 
    " ", "\[Rho]$0", ",", " ", "H"}], "]"}], "\[IndentingNewLine]", 
  "*)"}]], "Input",
 CellChangeTimes->{{3.6614342078368998`*^9, 3.661434242329479*^9}, {
  3.661434698858177*^9, 3.6614347003281317`*^9}, {3.6614347626672*^9, 
  3.661434766309744*^9}, {3.661439580768929*^9, 3.661439585503661*^9}, {
  3.859897802591381*^9, 3.859897803030715*^9}},
 FontSize->16,
 CellLabel->"In[24]:=",ExpressionUUID->"46982449-0780-45cf-810c-46e66814c863"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1074, 1098},
WindowMargins->{{Automatic, 153}, {Automatic, 82}},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
FrontEndVersion->"13.0 for Mac OS X x86 (64-bit) (December 2, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"79f1e0f6-f261-4521-890f-4f34bc4a3b4e"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 260, 4, 98, "Title",ExpressionUUID->"fca9def9-7c4a-43e1-b1de-916338efabe2"],
Cell[843, 28, 211, 6, 90, "Text",ExpressionUUID->"940bbff1-bf05-40de-8bd9-719010930089"],
Cell[1057, 36, 745, 15, 90, "Text",ExpressionUUID->"06f4ce1c-b841-4757-8def-0bcfef6e6d1f"],
Cell[CellGroupData[{
Cell[1827, 55, 171, 3, 67, "Section",ExpressionUUID->"6fbb75f9-49a0-4a91-8942-ec96386d5952"],
Cell[2001, 60, 396, 9, 84, "Text",ExpressionUUID->"2faf2085-ed1f-44e3-bb4c-6505fc87d772"],
Cell[2400, 71, 740, 15, 34, "Input",ExpressionUUID->"69d76d11-3be0-4f4b-8175-4ecb94e003b7"],
Cell[3143, 88, 207, 2, 36, "Text",ExpressionUUID->"be4519d5-a74b-4bf3-9bfa-30560f9a71ee"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3387, 95, 160, 3, 67, "Section",ExpressionUUID->"43fa3d42-aa34-41cc-9efc-0347c21e3a60"],
Cell[3550, 100, 741, 15, 90, "Text",ExpressionUUID->"fa22e656-7282-4b34-8fb8-9fc01f941d8c"],
Cell[4294, 117, 668, 13, 61, "Input",ExpressionUUID->"2de83763-a67c-4565-9352-3b68249d64e5"],
Cell[4965, 132, 381, 7, 64, "Text",ExpressionUUID->"4408d83d-8eca-4921-99dc-00913b46a067"],
Cell[5349, 141, 668, 14, 61, "Input",ExpressionUUID->"040a79b4-1eb2-4cbd-b38d-08741e01bd05"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6054, 160, 279, 4, 67, "Section",ExpressionUUID->"071ca845-3af7-4202-b311-c65823ae3498"],
Cell[6336, 166, 9548, 231, 1205, "Input",ExpressionUUID->"6ee73c83-4b14-471b-aa6c-d4c7ad6c8361"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15921, 402, 248, 4, 67, "Section",ExpressionUUID->"6bafe0c4-7af5-45e4-a285-4186ce080de1"],
Cell[CellGroupData[{
Cell[16194, 410, 168, 3, 54, "Subsection",ExpressionUUID->"711b3caf-7152-4654-abc9-5df556ca8417"],
Cell[16365, 415, 1009, 26, 64, "Text",ExpressionUUID->"77da6aa8-fdb0-48b2-ae2f-064ed48122f1"],
Cell[17377, 443, 3165, 66, 399, "Input",ExpressionUUID->"cb060012-c97e-4f6b-97db-610ad428555c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20579, 514, 195, 2, 51, "Subsection",ExpressionUUID->"dbfd9f6d-d321-4530-8fbd-774f4c2da47e"],
Cell[20777, 518, 444, 11, 39, "Text",ExpressionUUID->"6a081577-3dc4-4cdf-8a1b-0dd2bf8d719a"],
Cell[21224, 531, 639, 17, 67, "Input",ExpressionUUID->"df6a6e30-a247-4f85-ac4d-acd947a03247"],
Cell[21866, 550, 388, 7, 38, "Text",ExpressionUUID->"648eaf02-76e3-41b2-8d79-1d8886269ca0"],
Cell[22257, 559, 1269, 29, 96, "Input",ExpressionUUID->"5a3b56d6-e734-41ef-b80c-1c7b2a6069a0"],
Cell[23529, 590, 1072, 24, 67, "Input",ExpressionUUID->"c1927ee8-d5d0-4ab0-aa6c-23d543413e21"],
Cell[24604, 616, 625, 12, 90, "Text",ExpressionUUID->"3989c68d-dc8b-44f2-8ed3-94938d0ad7b2"],
Cell[25232, 630, 763, 21, 37, "Input",ExpressionUUID->"fb5f8160-1748-4220-8900-b66c49becac7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26032, 656, 170, 3, 54, "Subsection",ExpressionUUID->"4979c1af-e4a2-4b5f-b580-b915d6bb2226"],
Cell[26205, 661, 520, 9, 64, "Text",ExpressionUUID->"2eea17c6-998a-456b-9775-5827f8ed9d2f"],
Cell[26728, 672, 471, 10, 37, "Input",ExpressionUUID->"402420b7-4c3a-479a-ac92-27c59247adc0"],
Cell[27202, 684, 282, 5, 38, "Text",ExpressionUUID->"22933d09-e88f-41f4-98c1-a70eb409b1fb"],
Cell[27487, 691, 465, 10, 37, "Input",ExpressionUUID->"6e465590-8aad-4a5f-b374-842d3fbeab3b"],
Cell[27955, 703, 495, 8, 64, "Text",ExpressionUUID->"1c33cc67-03a3-4f74-a268-87bfcf9ee211"],
Cell[28453, 713, 562, 16, 37, "Input",ExpressionUUID->"c87a60b8-421f-4086-ab0e-db403e83b573"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29052, 734, 170, 3, 54, "Subsection",ExpressionUUID->"86ead0d7-ed6f-484f-bdfc-3a9a40b1d0fe"],
Cell[29225, 739, 947, 25, 93, "Text",ExpressionUUID->"df129454-f1be-436a-86d1-2b160c0dc454"],
Cell[30175, 766, 623, 15, 61, "Input",ExpressionUUID->"c5a6e0e9-458c-40a2-bfb3-977a0b93e2e5"],
Cell[30801, 783, 472, 8, 64, "Text",ExpressionUUID->"898d6f7d-7daa-47c5-a803-020d5ecafc84"],
Cell[31276, 793, 1531, 30, 67, "Input",ExpressionUUID->"0ea7aa7f-81fc-483f-9da9-12235b0c711e"],
Cell[32810, 825, 453, 8, 64, "Text",ExpressionUUID->"e550e490-59de-4d5c-a778-728094967acc"],
Cell[33266, 835, 1684, 34, 95, "Input",ExpressionUUID->"4fb489fc-d733-41b3-831a-2778d839f1e2"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[34999, 875, 153, 3, 67, "Section",ExpressionUUID->"e41863f1-4338-49d3-9216-37d168d3bcd5"],
Cell[35155, 880, 696, 13, 87, "Input",ExpressionUUID->"46982449-0780-45cf-810c-46e66814c863"]
}, Open  ]]
}, Open  ]]
}
]
*)

