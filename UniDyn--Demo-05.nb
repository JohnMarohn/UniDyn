(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    160816,       3903]
NotebookOptionsPosition[    144263,       3663]
NotebookOutlinePosition[    144715,       3681]
CellTagsIndexPosition[    144672,       3678]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["UniDyn--Demo-05.nb", "Title",
 CellChangeTimes->{{3.6352690845273046`*^9, 3.635269100847275*^9}, {
  3.6609180081345453`*^9, 3.660918013241088*^9}, {3.661433595181979*^9, 
  3.661433595493599*^9}, {3.671421633380262*^9, 3.6714216336468887`*^9}, {
  3.6718772443958178`*^9, 
  3.671877244528224*^9}},ExpressionUUID->"7be64f62-ccaa-4f0f-a03b-\
45500d5ee327"],

Cell["\<\
John A. Marohn
jam99@cornell.edu
Cornell University\
\>", "Text",
 CellChangeTimes->{{3.635269101985786*^9, 3.635269121580956*^9}},
 FontSize->18,ExpressionUUID->"a39a3e0c-2de9-477d-b41b-054fd008c4d5"],

Cell[TextData[{
 StyleBox["Abstract:",
  FontWeight->"Bold"],
 "  Use the ",
 StyleBox["UniDyn",
  FontWeight->"Bold"],
 " Evolver function to calculate the evolution of the magnetization of a two \
coupled spin = 1/2 particles under free evolution, a heteronuclear COSY pulse \
sequence, and a homonuclear pulse sequence."
}], "Text",
 CellChangeTimes->{{3.6352698622319117`*^9, 3.635269926908793*^9}, {
   3.6352701305950613`*^9, 3.635270138669529*^9}, {3.6614336154747458`*^9, 
   3.661433666560676*^9}, {3.661433776071369*^9, 3.6614337761699266`*^9}, {
   3.6614620415959*^9, 3.66146210493357*^9}, {3.67142163980396*^9, 
   3.671421654441256*^9}, {3.6714566972027082`*^9, 3.6714567047338247`*^9}, {
   3.67187725160753*^9, 3.671877263858714*^9}, {3.671970360631181*^9, 
   3.671970382703347*^9}, 3.859917018935553*^9},
 FontSize->18,ExpressionUUID->"5fa08270-95cf-4020-9639-dc0d59fa5688"],

Cell[CellGroupData[{

Cell["Instructions", "Section",
 FontSize->24,ExpressionUUID->"972cccd7-cf27-472f-adb2-81c557c5fb8a"],

Cell[TextData[{
 "Once you edit the directory path below, you should be able to run the \
notebook.  This notebook will calculate, for two protons that are \"J\" \
coupled, the free induction decay and the two-dimensional COrrelation \
SpectroscopY (COSY) signal.  Both the heteronuclear (e.g., a coupled ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["\[InvisiblePrefixScriptBase]", "13"], 
    StyleBox["C",
     FontSlant->"Plain"]}], TraditionalForm]],ExpressionUUID->
  "66d7529f-724a-4249-94ee-339d80a5631f"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["\[InvisiblePrefixScriptBase]", "1"], 
    StyleBox["H",
     FontSlant->"Plain"]}], TraditionalForm]],ExpressionUUID->
  "9d4a2ad1-4200-40d6-b80f-431acec70a66"],
 ")  and homonuclear (e.g., two coupled ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["\[InvisiblePrefixScriptBase]", "1"], 
    StyleBox["H",
     FontSlant->"Plain"]}], TraditionalForm]],ExpressionUUID->
  "74419c61-43cd-459e-90a6-8d4793daf1cf"],
 "\[CloseCurlyQuote]s) experiments are written out below.  I have highlighted \
in yellow and grey the places in the file where you may want to change \
parameters. \n\nAnswer these questions after lab.\n\n1) ",
 StyleBox["Free evolution signal",
  FontWeight->"Bold",
  FontVariations->{"Underline"->True}],
 " \n\nI give some suggested values for the two proton chemical shifts, the J \
coupling, and the transverse relaxation time that will give nice looking \
spectra. "
}], "Text",
 CellMargins->{{54, Inherited}, {Inherited, Inherited}},
 CellChangeTimes->{{3.4180935248930798`*^9, 3.418093526765773*^9}, {
  3.671970431883233*^9, 3.671970570731018*^9}},
 TextAlignment->Left,
 TextJustification->0,
 FontSize->18,ExpressionUUID->"86ac4292-cc19-44f8-b8db-401f269b7e94"],

Cell["\<\
a) Edit the J-coupling to zero and re-run the free-induction decay \
calculation. Does the spectrum look like you expect? (Reset the J-coupling \
back to something reasonble before continuing.)

b) Below I plot the real part of the Fourier transform.  Now plot the \
imaginary part and magnitude.  Is the resolution better for the real part of \
the signal or the magnitude part?  Can you explain the result qualitatively?\
\>", "Text",
 CellMargins->{{108, Inherited}, {Inherited, Inherited}},
 CellChangeTimes->{{3.67197058696099*^9, 3.671970595790347*^9}, {
  3.671970830769031*^9, 3.671970851708448*^9}},
 FontSize->18,ExpressionUUID->"6225042e-55b3-4027-aa9b-ba6d4e9ea444"],

Cell[TextData[{
 "\n2) ",
 StyleBox["COSY",
  FontWeight->"Bold",
  FontVariations->{"Underline"->True}],
 ".  Each COSY signal takes a few seconds to calculate.   "
}], "Text",
 CellChangeTimes->{{3.639273270959442*^9, 3.639273273038609*^9}, {
  3.671970865106908*^9, 3.671970865310254*^9}, {3.671971066508307*^9, 
  3.6719711536549463`*^9}, {3.671971192346159*^9, 3.671971249510413*^9}, {
  3.671971282554853*^9, 3.671971292154003*^9}},
 FontSize->18,ExpressionUUID->"80981ff7-beca-4cac-b26c-3a6084bb8261"],

Cell["\<\
a) Draw out the pulse sequence for the Heteronuclear COSY and the Homonuclear \
COSY experiments.  How are the experiments different?

b) In each spectum, there is a small signal blip at the center of the plot.  \
This is not due to the spins -- I added that fake signal.  How did I add it?  \
Why did I add it?\
\>", "Text",
 CellMargins->{{108, Inherited}, {Inherited, Inherited}},
 CellChangeTimes->{{3.639273136000342*^9, 3.639273145875243*^9}, {
  3.6719708766891603`*^9, 3.671970882920882*^9}, {3.6719709846987333`*^9, 
  3.6719710602761183`*^9}, {3.671971271233128*^9, 3.671971272411804*^9}, {
  3.671971345081327*^9, 3.671971493737226*^9}},
 FontSize->18,ExpressionUUID->"d002cce0-1407-455c-bbb6-9c5f6df1c24e"],

Cell["\<\
For both the Heteronuclear COSY and the Homonuclear COSY experiments,\
\>", "Text",
 CellChangeTimes->{{3.671971279707144*^9, 3.671971286434424*^9}, {
  3.6719714979812403`*^9, 3.6719714991052113`*^9}},
 FontSize->18,ExpressionUUID->"17636970-2f0a-4132-803d-e043a745f127"],

Cell[TextData[{
 "c) Edit the J-coupling to zero and recalculate the spectrum.  Does the COSY \
spectrum look any different?  (Reset the J-coupling back to something \
reasonble before continuing.)\n\nd) Below I plot the two-dimensional Fourier \
transform of the COSY signal.  The signal is not symmetric in \[Omega]1 and \
\[Omega]2. Can you explain this? Look at the terms in the ",
 StyleBox["\[Rho]$4$A",
  FontWeight->"Bold"],
 ", ",
 StyleBox["\[Rho]$4$B",
  FontWeight->"Bold"],
 ", and ",
 StyleBox["\[Rho]$4",
  FontWeight->"Bold"],
 " signals.  How was each of these signals created?s\n \ne) Like you did with \
the FID, plot the imaginary, real,and magnitude of the two-dimensional \
Fourier transform of the COSY(t1,t2) signal -- these are the plots ",
 StyleBox["p1",
  FontWeight->"Bold"],
 ", ",
 StyleBox["p2",
  FontWeight->"Bold"],
 ", and ",
 StyleBox["p3",
  FontWeight->"Bold"],
 " returned by the 2D Fourier transform function. Note the peak shapes.  For \
example, are all the peaks positive?  To see whether the peaks in the \
spectrum are positive or negative, you can rotate the plot around using the \
mouse."
}], "Text",
 CellMargins->{{108, Inherited}, {Inherited, Inherited}},
 CellChangeTimes->{{3.639273136000342*^9, 3.639273145875243*^9}, {
   3.6719708766891603`*^9, 3.671970882920882*^9}, {3.6719709846987333`*^9, 
   3.6719710602761183`*^9}, {3.671971296042631*^9, 3.671971342952244*^9}, {
   3.67197139969138*^9, 3.671971408746414*^9}, {3.671971504242578*^9, 
   3.671971508769294*^9}, 3.672140559768456*^9, 3.859917033172653*^9},
 FontSize->18,ExpressionUUID->"aaecd8b6-be0f-460f-bae2-73862d4525c9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Preliminaries", "Section",
 CellChangeTimes->{{3.671969802395784*^9, 
  3.671969809537006*^9}},ExpressionUUID->"4ed0d17a-06c5-493e-9cc3-\
f294b201bc8c"],

Cell[CellGroupData[{

Cell["Set the path to the package", "Subsection",
 CellChangeTimes->{{3.635270036711257*^9, 
  3.63527004852262*^9}},ExpressionUUID->"d19429d6-b1f4-469f-811e-\
61c63e8e0603"],

Cell[TextData[{
 "Tell ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " the path to the directory containing the package.    \n\nEDIT THE \
FOLLOWING PATH STRING:"
}], "Text",
 CellChangeTimes->{{3.635270060901009*^9, 3.635270086988311*^9}, {
  3.6610825274488792`*^9, 3.6610825288209763`*^9}},
 FontSize->16,ExpressionUUID->"c7913457-435b-4ccd-91da-afcdf29a12fd"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
   "$UniDynPath", " ", "=", 
    "\"\</Users/jam99/Dropbox/MarohnGroup__Software_Library/UniDyn/unidyn\>\"\
"}], ";"}], " "}]], "Input",
 CellChangeTimes->{{3.6349053527016897`*^9, 3.6349054064223843`*^9}, {
   3.634910931339162*^9, 3.634910931457775*^9}, {3.634914337947165*^9, 
   3.6349143671071568`*^9}, {3.634922597904743*^9, 3.634922606812076*^9}, {
   3.635268730835155*^9, 3.635268731125407*^9}, {3.635269951638358*^9, 
   3.635269958323474*^9}, {3.660918115324842*^9, 3.660918132325369*^9}, {
   3.660918590921587*^9, 3.660918600403768*^9}, 3.859917053531866*^9, {
   3.940182060321372*^9, 3.940182061827682*^9}},
 FontSize->16,ExpressionUUID->"cd5e990d-a1a7-4a0c-ab21-582ea8a73825"],

Cell["YOU SHOULD NOT NEED TO EDIT ANYTHING FROM HERE ONWARDS.", "Text",
 CellChangeTimes->{{3.635270073196437*^9, 3.635270077357624*^9}},
 FontSize->16,ExpressionUUID->"9763b5fc-1af0-4271-8e50-7b036440db9d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Load the package", "Subsection",
 CellChangeTimes->{{3.635269129230983*^9, 
  3.63526913095236*^9}},ExpressionUUID->"ed4f1380-ed80-4f76-b614-\
7a5f55da7198"],

Cell[TextData[{
 "Append the package path to the system path.  Before trying to load the \
package, ask ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " to find it.  This is a test that we directed ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " to the correct directory.  The output of this command should be the full \
system path to the UniDyn.m file.   "
}], "Text",
 CellChangeTimes->{{3.635269223597199*^9, 3.635269340159473*^9}, {
   3.635269947982662*^9, 3.6352699492517843`*^9}, {3.635269985297124*^9, 
   3.63527000724584*^9}, 3.635270066996499*^9, {3.63527010818321*^9, 
   3.6352701131658497`*^9}, {3.660918102499856*^9, 3.6609181035465183`*^9}},
 FontSize->18,ExpressionUUID->"50410498-573d-4342-9171-efba2d7767fa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$Path", " ", "=", " ", 
   RowBox[{"AppendTo", "[", 
    RowBox[{"$Path", ",", "$UniDynPath"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"FindFile", "[", "\"\<UniDyn`\>\"", "]"}]}], "Input",
 CellChangeTimes->{{3.634906393354924*^9, 3.634906398308229*^9}, {
   3.634922599063291*^9, 3.634922599752222*^9}, {3.635268728673848*^9, 
   3.6352687402094*^9}, {3.635269954012105*^9, 3.6352699550474253`*^9}, 
   3.8599170629085703`*^9, {3.9401820655991287`*^9, 3.940182069769898*^9}},
 FontSize->16,
 CellLabel->"In[67]:=",ExpressionUUID->"eb48b2dd-65e6-4a37-adf8-696291a9f692"],

Cell["\<\
Now that we are confident that the path is set correctlly, load the package.  \
Setting the global $VerboseLoad variable to True will print out the help \
strings for key commands in the package.  \
\>", "Text",
 CellChangeTimes->{{3.635269347360386*^9, 3.63526943190546*^9}},
 FontSize->18,ExpressionUUID->"8563de62-ca2d-4b11-a688-09c38ba1e536"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$VerboseLoad", " ", "=", "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Needs", "[", "\"\<UniDyn`\>\"", "]"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAGIQfYUjQpVD9LXjxxR+TRC9peyGEyeQ/lH0EExXTKuJ
BdGbVk8B0zYvFOpA9Ik35o0gmsEzcwKI3ruyF0yrn4ubDqITDHPAdMGBGUdA
9K1JG8G0V4+DGg+Q1vtwBUyLu5WcAtE8yv6nQfT861tdBUDm3NFxA9F2v/Ym
g+h4M4cUED09+VEGiC6rzcoH0RUNSUHSQHqfnVQoiP6uyGkiC6T5nmeCabdp
f25FAekIO8nbINqkKUQlBUiz/Z0DplNs3jwG0Q88GJ+A6Bf2PcZdQNqjYi6Y
XnQt//l3t9eOqzNZX4DoFiF11h9A+sM0WzCtqnCwYKH7a8c9B1ULQfQUn1WX
e6JfO17R07gGop8XdtwG0RfPLADTH4ynHVwCpA+I7gHTAHQ2q7E=
  "],
 FontSize->16,
 CellLabel->"In[69]:=",ExpressionUUID->"d5d749bc-001f-4cd3-a42b-96ca09dd3b1b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Evolver function with simplification ", "Section",
 CellChangeTimes->{{3.6714440687071867`*^9, 3.671444088666716*^9}, {
  3.671880302829075*^9, 3.671880303781885*^9}, {3.6719244911101007`*^9, 
  3.6719244959724007`*^9}},ExpressionUUID->"89fc8b18-07bf-4b2f-88d9-\
d063d50ecd45"],

Cell["Create a free-evolution operator.", "Text",
 CellChangeTimes->{{3.671880176378189*^9, 3.671880184855246*^9}, {
  3.671924537517173*^9, 3.671924541034936*^9}, {3.8599170946243896`*^9, 
  3.859917100876422*^9}},
 FontSize->18,ExpressionUUID->"e290d079-5037-49bd-8834-66ab0ccf5e1b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SimplifyingEvolver", "[", 
   RowBox[{"H_", ",", "t_", ",", "\[Rho]$0_"}], "]"}], ":=", "  ", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", "   ", 
   RowBox[{"H", " ", "=", " ", 
    RowBox[{"Hamiltonian", " ", "operator"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "   ", 
   RowBox[{"t", " ", "=", " ", 
    RowBox[{"time", " ", "varaible"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"\[Rho]$0", " ", "=", " ", 
    RowBox[{"initial", " ", "density", " ", "operator"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Evolver", "[", 
      RowBox[{"H", ",", " ", "t", ",", " ", "\[Rho]$0"}], "]"}], "//", 
     "Simplify"}], "//", " ", "ExpToTrig"}], " ", "//", " ", "FullSimplify", 
   " "}]}]], "Input",
 CellChangeTimes->{{3.671444089823865*^9, 3.671444165795093*^9}, {
  3.671880250049287*^9, 3.6718802930947857`*^9}, {3.671925896699779*^9, 
  3.671925898519351*^9}},
 FontSize->16,
 CellLabel->"In[71]:=",ExpressionUUID->"9f8e0b58-ae56-468c-9e4b-a8ed572df4ad"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Implement pulses with simplification", "Section",
 CellChangeTimes->{{3.671924509162469*^9, 3.67192453111033*^9}, {
  3.8599171159901876`*^9, 
  3.8599171222293167`*^9}},ExpressionUUID->"1004882e-54c4-4e38-8e89-\
142bca709a41"],

Cell[CellGroupData[{

Cell["I spins", "Subsection",
 CellChangeTimes->{{3.6719248204181223`*^9, 
  3.671924825871171*^9}},ExpressionUUID->"7456496e-e53b-477e-987a-\
e175d5adcb1d"],

Cell["\<\
Evolve the I spins under a short burst of applied on-resonance irradiation, \
in the delta-function pulse approximation.  Specify the total pulse angle and \
the pulse phase and the PulseI operator evolves the density operator \
accordingly.\
\>", "Text",
 CellChangeTimes->{{3.671880188061632*^9, 3.671880199649797*^9}, {
  3.671892307249003*^9, 3.671892352394723*^9}, {3.6718926596400623`*^9, 
  3.6718926618696127`*^9}, {3.671924555111989*^9, 3.6719246015464067`*^9}, {
  3.671924644090493*^9, 3.671924785894499*^9}},
 FontSize->18,ExpressionUUID->"dd2e5afe-1933-4ffc-9fed-f4afbd615b8e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "PulseI", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PulseI", "[", 
   RowBox[{"\[Rho]$0_", ",", "\[Phi]_", ",", "\[Theta]_"}], "]"}], " ", ":=", 
  " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"\[Rho]$0", " ", "=", " ", 
    RowBox[{"initial", " ", "density", " ", "operator"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "   ", 
   RowBox[{"\[Phi]", " ", "=", " ", 
    RowBox[{"pulse", " ", "phase", " ", "in", " ", "radians"}]}], " ", "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{"(*", "   ", 
   RowBox[{"\[Theta]", " ", "=", " ", 
    RowBox[{"pulse", " ", "angle", " ", "in", " ", "radians"}]}], " ", "*)"}],
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"\[Rho]$0", " ", "//", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"SimplifyingEvolver", "[", " ", 
      RowBox[{
       RowBox[{"\[Omega]$I", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", "Ix"}], " ", "+", " ", 
          RowBox[{
           RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", "Iy"}]}], ")"}]}], ",", 
       "t", ",", " ", "#"}], "]"}], "&"}], " ", "/.", " ", 
    RowBox[{"{", 
     RowBox[{"t", "\[Rule]", " ", 
      RowBox[{"\[Theta]", "/", "\[Omega]$I"}]}], "}"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.671838890598955*^9, 3.6718389878430643`*^9}, {
  3.671839497724379*^9, 3.671839500153345*^9}, {3.671880204028532*^9, 
  3.67188023570371*^9}, {3.671924626484288*^9, 3.671924627404508*^9}, {
  3.671924798937351*^9, 3.6719248037729053`*^9}, {3.671925889925756*^9, 
  3.671925893072789*^9}},
 FontSize->16,
 CellLabel->"In[74]:=",ExpressionUUID->"c29e1896-856a-4962-8b08-74fd2124aaed"],

Cell["\<\
The pulse operator distrubutes over Plus, Times, and NoncommutativeMultiply.  \
Scalars in front of operators can be pulled out front.\
\>", "Text",
 CellChangeTimes->{{3.671924646481277*^9, 3.6719246493459263`*^9}, {
  3.671925665329852*^9, 3.6719256681754436`*^9}},
 FontSize->18,ExpressionUUID->"0d2775d1-0c06-497c-b972-32fa6857f990"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PulseI", "[", 
   RowBox[{"\[Rho]$0_Plus", ",", "\[Phi]_", ",", "\[Theta]_"}], "]"}], " ", ":=", 
  RowBox[{"Plus", " ", "@@", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"PulseI", "[", 
       RowBox[{"#", ",", "\[Phi]", ",", "\[Theta]"}], "]"}], "&"}], ")"}], 
    " ", "/@", " ", 
    RowBox[{"List", " ", "@@", " ", "\[Rho]$0"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PulseI", "[", 
   RowBox[{"\[Rho]$0_Times", ",", "\[Phi]_", ",", "\[Theta]_"}], "]"}], " ", ":=", 
  RowBox[{"Times", "@@", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"PulseI", "[", 
       RowBox[{"#", ",", "\[Phi]", ",", "\[Theta]"}], "]"}], "&"}], ")"}], 
    " ", "/@", " ", 
    RowBox[{"List", " ", "@@", " ", "\[Rho]$0"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PulseI", "[", 
   RowBox[{"\[Rho]$0_Mult", ",", "\[Phi]_", ",", "\[Theta]_"}], "]"}], " ", ":=", 
  RowBox[{"Mult", " ", "@@", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"PulseI", "[", 
       RowBox[{"#", ",", "\[Phi]", ",", "\[Theta]"}], "]"}], "&"}], ")"}], 
    " ", "/@", " ", 
    RowBox[{"List", " ", "@@", " ", "\[Rho]$0"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PulseI", "[", 
   RowBox[{
    RowBox[{"Times", "[", 
     RowBox[{
      RowBox[{"a_", "?", "CommutativeQ"}], ",", "\[Rho]$0_"}], "]"}], ",", 
    "\[Phi]_", ",", "\[Theta]_"}], "]"}], " ", ":=", " ", 
  RowBox[{"a", " ", 
   RowBox[{"PulseI", "[", 
    RowBox[{"\[Rho]$0", ",", "\[Phi]", ",", "\[Theta]"}], "]"}]}]}]}], "Input",\

 CellChangeTimes->{{3.671892024789138*^9, 3.671892098917617*^9}, {
   3.67189228083952*^9, 3.671892286693618*^9}, 3.67189235529066*^9, {
   3.671892670413329*^9, 3.671892682613155*^9}, {3.67189278127796*^9, 
   3.671892795726034*^9}, {3.671892825837974*^9, 3.67189284981843*^9}, {
   3.671924625292719*^9, 3.6719246386801853`*^9}, {3.9401821009804077`*^9, 
   3.940182106359898*^9}},
 FontSize->16,
 CellLabel->"In[76]:=",ExpressionUUID->"f79ad30e-1df7-4cee-8ed4-6b920a69c207"]
}, Open  ]],

Cell[CellGroupData[{

Cell["S spins", "Subsection",
 CellChangeTimes->{{3.6719248293571033`*^9, 
  3.671924837283074*^9}},ExpressionUUID->"3e2a96dd-c046-4df5-9760-\
c14f681fd832"],

Cell["Define an analogous pulse operator for the S spins ... ", "Text",
 CellChangeTimes->{{3.6719245927817087`*^9, 3.671924618122842*^9}, {
  3.671924864330348*^9, 3.671924865216565*^9}},
 FontSize->18,ExpressionUUID->"4c67dfd8-f719-4c38-9f6e-7678233b71b0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "PulseS", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PulseS", "[", 
   RowBox[{"\[Rho]$0_", ",", "\[Phi]_", ",", "\[Theta]_"}], "]"}], " ", ":=", 
  " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"\[Rho]$0", " ", "=", " ", 
    RowBox[{"initial", " ", "density", " ", "operator"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "   ", 
   RowBox[{"\[Phi]", " ", "=", " ", 
    RowBox[{"pulse", " ", "phase", " ", "in", " ", "radians"}]}], " ", "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{"(*", "   ", 
   RowBox[{"\[Theta]", " ", "=", " ", 
    RowBox[{"pulse", " ", "angle", " ", "in", " ", "radians"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"\[Rho]$0", " ", "//", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"SimplifyingEvolver", "[", " ", 
      RowBox[{
       RowBox[{"\[Omega]$S", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", "Sx"}], " ", "+", " ", 
          RowBox[{
           RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", "Sy"}]}], ")"}]}], ",", 
       "t", ",", " ", "#"}], "]"}], "&"}], " ", "/.", " ", 
    RowBox[{"{", 
     RowBox[{"t", "\[Rule]", " ", 
      RowBox[{"\[Theta]", "/", "\[Omega]$S"}]}], "}"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.671838890598955*^9, 3.6718389878430643`*^9}, {
  3.6718390431124573`*^9, 3.67183905277701*^9}, {3.6718802416768703`*^9, 
  3.671880244871852*^9}, {3.671924807702702*^9, 3.671924813313757*^9}, {
  3.6719248517968397`*^9, 3.671924852470512*^9}, {3.6719258831960077`*^9, 
  3.671925886536357*^9}},
 FontSize->16,
 CellLabel->"In[82]:=",ExpressionUUID->"370baff8-5d40-4ad1-9627-957cc37805d1"],

Cell["... with nice distributive and scalar-factoring properties.", "Text",
 CellChangeTimes->{{3.671924875863431*^9, 3.6719248966102333`*^9}, {
  3.671925673027916*^9, 3.67192567415032*^9}},
 FontSize->18,ExpressionUUID->"94032b52-6c28-43ed-a902-a17ca4eab9fd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PulseS", "[", 
   RowBox[{"\[Rho]$0_Plus", ",", "\[Phi]_", ",", "\[Theta]_"}], "]"}], " ", ":=", 
  RowBox[{"Plus", " ", "@@", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"PulseS", "[", 
       RowBox[{"#", ",", "\[Phi]", ",", "\[Theta]"}], "]"}], "&"}], ")"}], 
    " ", "/@", " ", 
    RowBox[{"List", " ", "@@", " ", "\[Rho]$0"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PulseS", "[", 
   RowBox[{"\[Rho]$0_Times", ",", "\[Phi]_", ",", "\[Theta]_"}], "]"}], " ", ":=", 
  RowBox[{"Times", "@@", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"PulseS", "[", 
       RowBox[{"#", ",", "\[Phi]", ",", "\[Theta]"}], "]"}], "&"}], ")"}], 
    " ", "/@", " ", 
    RowBox[{"List", " ", "@@", " ", "\[Rho]$0"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PulseS", "[", 
   RowBox[{"\[Rho]$0_Mult", ",", "\[Phi]_", ",", "\[Theta]_"}], "]"}], " ", ":=", 
  RowBox[{"Mult", " ", "@@", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"PulseS", "[", 
       RowBox[{"#", ",", "\[Phi]", ",", "\[Theta]"}], "]"}], "&"}], ")"}], 
    " ", "/@", " ", 
    RowBox[{"List", " ", "@@", " ", "\[Rho]$0"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PulseS", "[", 
   RowBox[{
    RowBox[{"Times", "[", 
     RowBox[{
      RowBox[{"a_", "?", "CommutativeQ"}], ",", "\[Rho]$0_"}], "]"}], ",", 
    "\[Phi]_", ",", "\[Theta]_"}], "]"}], " ", ":=", " ", 
  RowBox[{"a", " ", 
   RowBox[{"PulseS", "[", 
    RowBox[{"\[Rho]$0", ",", "\[Phi]", ",", "\[Theta]"}], "]"}]}]}]}], "Input",\

 CellChangeTimes->{{3.671892024789138*^9, 3.671892098917617*^9}, {
  3.67189228083952*^9, 3.671892286693618*^9}, {3.67189235529066*^9, 
  3.6718923759734573`*^9}, {3.671892691703903*^9, 3.671892696427689*^9}, {
  3.6718928815671167`*^9, 3.6718928930037537`*^9}, {3.6719248490978622`*^9, 
  3.6719248751433973`*^9}, {3.940182127970888*^9, 3.940182133236318*^9}},
 FontSize->16,
 CellLabel->"In[84]:=",ExpressionUUID->"d230d9a8-d32d-40e9-9898-2b23d747290b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Two spins", "Subsection",
 CellChangeTimes->{{3.661433931683024*^9, 3.661433953976736*^9}, {
   3.6714222121324053`*^9, 3.671422215219035*^9}, 3.6719257350922203`*^9},
 FontSize->24,ExpressionUUID->"270c4cc7-6158-4857-aa31-b34fb6060eab"],

Cell[TextData[{
 "The assumptions define below are required for ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " to recognize ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SqrtBox[
     RowBox[{"\[Dash]", 
      RowBox[{
       SuperscriptBox["\[CapitalDelta]", "2"], "-", 
       SuperscriptBox["\[Omega]", "2"]}]}]], "=", " ", 
    RowBox[{"I", 
     SqrtBox[
      RowBox[{
       SuperscriptBox["\[CapitalDelta]", "2"], "+", 
       SuperscriptBox["\[Omega]", "2"]}]]}]}], TraditionalForm]],
  FontSize->14,ExpressionUUID->"8c874ba2-26ec-40b3-8960-f76d7168b787"],
 " inside an exponential.   One of the variables has to be defined to be > 0 \
and not just \[GreaterSlantEqual] 0.   For ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " and the Evolve[] function to recognize unitary rotations, it is crucially \
important to define all the non-operator variables in your expressions to be \
scalars."
}], "Text",
 CellChangeTimes->{{3.661454934610312*^9, 3.661455077339642*^9}, {
   3.661455120999338*^9, 3.6614551250107203`*^9}, {3.66145516298409*^9, 
   3.661455238939184*^9}, {3.6614552751916943`*^9, 3.6614553005499*^9}, 
   3.66169791700492*^9, {3.6719249140285597`*^9, 3.6719249776881247`*^9}},
 FontSize->18,ExpressionUUID->"cc4987db-ba8e-4d8f-bd41-e4391245db04"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"\[CapitalDelta]$I", ",", "                 ", 
    RowBox[{"(*", " ", 
     RowBox[{"resonance", " ", "offset", " ", "frequency"}], " ", "*)"}], 
    "\[IndentingNewLine]", "\[CapitalDelta]$S", ",", "                 ", 
    RowBox[{"(*", " ", 
     RowBox[{"resonance", " ", "offset", " ", "frequency"}], " ", "*)"}], 
    "\[IndentingNewLine]", "J", ",", "                      ", 
    RowBox[{"(*", " ", 
     RowBox[{"spin", "-", 
      RowBox[{"spin", " ", "coupling"}]}], " ", "*)"}], "\[IndentingNewLine]",
     "Ix", ",", " ", "Iy", ",", " ", "Iz", ",", " ", 
    RowBox[{"(*", " ", 
     RowBox[{"spin", " ", "angular", " ", "momentum", " ", "operators"}], " ",
      "*)"}], "\[IndentingNewLine]", "Sx", ",", " ", "Sy", ",", " ", "Sz", 
    ",", " ", 
    RowBox[{"(*", " ", 
     RowBox[{"spin", " ", "angular", " ", "momentum", " ", "operators"}], " ",
      "*)"}], "\[IndentingNewLine]", "\[Rho]", ",", "                      ", 
    
    RowBox[{"(*", " ", 
     RowBox[{"spin", " ", "density", " ", "operator"}], " ", "*)"}], " ", 
    "\[IndentingNewLine]", "t", ",", "                       ", 
    RowBox[{"(*", " ", "time", " ", "*)"}], "\[IndentingNewLine]", "t1", ",", 
    "                     ", 
    RowBox[{"(*", " ", "time", " ", "*)"}], "\[IndentingNewLine]", "t2", ",", 
    "                     ", 
    RowBox[{"(*", " ", "time", " ", "*)"}], "\[IndentingNewLine]", "a", ",", 
    "                        ", 
    RowBox[{"(*", " ", 
     RowBox[{"Curie", " ", "Law", " ", "factor"}], " ", "*)"}], 
    "\[IndentingNewLine]", "b", ",", "                       ", 
    RowBox[{"(*", " ", 
     RowBox[{"Curie", " ", "Law", " ", "factor"}], " ", "*)"}], 
    "\[IndentingNewLine]", "\[Rho]$0", ",", "                  ", 
    RowBox[{"(*", " ", 
     RowBox[{"initial", " ", "spin", " ", "density", " ", "operator"}], " ", 
     "*)"}], "\[IndentingNewLine]", "H"}], "                          ", 
   RowBox[{"(*", " ", 
    RowBox[{"spin", " ", "Hamiltonian"}], " ", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CreateScalar", "[", 
    RowBox[{
    "\[CapitalDelta]$I", ",", "\[CapitalDelta]$S", ",", "J", ",", "t", ",", 
     "t1", ",", "t2", ",", "a", ",", "b"}], " ", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$Assumptions", "  ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Element", "[", 
       RowBox[{"\[CapitalDelta]$I", ",", " ", "Reals"}], "]"}], ",", " ", 
      RowBox[{"\[CapitalDelta]$I", " ", "\[GreaterSlantEqual]", " ", "0"}], 
      ",", " ", 
      RowBox[{"Element", "[", 
       RowBox[{"\[CapitalDelta]$S", ",", " ", "Reals"}], "]"}], ",", " ", 
      RowBox[{"\[CapitalDelta]$S", " ", "\[GreaterSlantEqual]", " ", "0"}], 
      ",", " ", 
      RowBox[{"Element", "[", 
       RowBox[{"J", ",", " ", "Reals"}], "]"}], ",", " ", 
      RowBox[{"J", "  ", ">", " ", "0"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CreateOperator", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Ix", ",", " ", "Iy", ",", " ", "Iz"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Sx", ",", " ", "Sy", ",", " ", "Sz"}], "}"}]}], "}"}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"SpinSingle$CreateOperators", "[", 
   RowBox[{"Ix", ",", " ", "Iy", ",", " ", "Iz", ",", " ", 
    RowBox[{"L", "=", 
     RowBox[{"1", "/", "2"}]}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SpinSingle$CreateOperators", "[", 
   RowBox[{"Sx", ",", " ", "Sy", ",", " ", "Sz", ",", " ", 
    RowBox[{"L", "=", 
     RowBox[{"1", "/", "2"}]}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6614339585492563`*^9, 3.661434010703532*^9}, {
   3.661434214867899*^9, 3.661434222437502*^9}, {3.661434384868638*^9, 
   3.6614346039604807`*^9}, {3.6614346490398808`*^9, 3.661434789890903*^9}, {
   3.661435094092959*^9, 3.661435125986967*^9}, {3.6614352184576807`*^9, 
   3.661435260920999*^9}, 3.661454979504386*^9, {3.6614550830373096`*^9, 
   3.6614550896485147`*^9}, {3.661455140167131*^9, 3.66145514338946*^9}, {
   3.6614552141564493`*^9, 3.661455268214559*^9}, {3.671422223446307*^9, 
   3.671422276457761*^9}, {3.6714223930390167`*^9, 3.671422478451767*^9}, {
   3.6714445143764687`*^9, 3.671444514801667*^9}, {3.6714447631748466`*^9, 
   3.671444772352507*^9}, {3.671445003838581*^9, 3.6714450185403843`*^9}, {
   3.671890416297718*^9, 3.6718904324881573`*^9}, {3.671894623601046*^9, 
   3.671894649558962*^9}, {3.6719249838130283`*^9, 3.671925018230544*^9}, {
   3.859917152814012*^9, 3.859917174928298*^9}},
 FontSize->16,
 CellLabel->"In[94]:=",ExpressionUUID->"783a6fc4-0f73-4f2b-9c15-831d6664f413"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Free evolution operator for two coupled spins", "Section",
 CellChangeTimes->{{3.661433931683024*^9, 3.661433953976736*^9}, {
   3.6714222121324053`*^9, 3.671422215219035*^9}, {3.671877622369337*^9, 
   3.671877625383318*^9}, {3.671925029741441*^9, 3.6719250354872713`*^9}, 
   3.671925681781056*^9, {3.67192573986287*^9, 
   3.6719257433138*^9}},ExpressionUUID->"5e3deb4e-66b1-43f3-a021-\
062bc67867c5"],

Cell[TextData[{
 "Evolve the density operator under the Hamiltonian\n\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"H", " ", "=", "  ", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[CapitalDelta]", "I"], " ", 
      SubscriptBox["I", "z"]}], "+", " ", 
     RowBox[{
      SubscriptBox["\[CapitalDelta]", "S"], " ", 
      SubscriptBox["S", "z"]}], " ", "+", " ", 
     RowBox[{"J", " ", 
      SubscriptBox["I", "z"], 
      SubscriptBox["S", "z"]}]}]}], TraditionalForm]],ExpressionUUID->
  "326b2510-2797-4729-aa5d-bdbc4a7a220c"],
 "\n\nwhere ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[CapitalDelta]", "I"], TraditionalForm]],ExpressionUUID->
  "7486b28e-dfdb-4c83-afc4-659f64e229f7"],
 " is the I-spin chemical shift, ",
 Cell[BoxData[
  RowBox[{" ", 
   SubscriptBox["\[CapitalDelta]", "S"]}]],ExpressionUUID->
  "bb643f20-ec31-4ef2-909c-2bb360a196ea"],
 " is the S-spin chemical shift, and ",
 StyleBox["J",
  FontSlant->"Italic"],
 " is the through-bond coupling between the I spin and the S spin.  The \
Evolve[] operator cannnot evolve the density operator all in one step, so we \
use the fact that all three terms in the above Hamiltonian commute with each \
other.  This commutation relationship allows us to evolve the density \
stepwise, by one of the operators at a time."
}], "Text",
 CellChangeTimes->{{3.671894041395768*^9, 3.671894173775732*^9}, {
  3.671894283373335*^9, 3.6718942839054127`*^9}, {3.6719250421219273`*^9, 
  3.671925057894815*^9}, {3.671925099182922*^9, 3.67192538710074*^9}, {
  3.671925533370783*^9, 3.671925541202483*^9}, {3.671925624419444*^9, 
  3.6719256267364264`*^9}, {3.671925684593628*^9, 3.671925688237563*^9}},
 FontSize->18,ExpressionUUID->"8b57c6fd-8f6f-4013-82e4-4543add8fa87"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "FreeEvolution", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FreeEvolution", "[", 
   RowBox[{"\[Rho]_", ",", "t_"}], "]"}], " ", ":=", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"\[Rho]", " ", "=", " ", 
    RowBox[{"density", " ", "operator"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"t", " ", "=", " ", 
    RowBox[{"time", " ", "[", "s", "]"}]}], " ", "*)"}], " ", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Rho]", " ", "//", " ", 
        RowBox[{
         RowBox[{"SimplifyingEvolver", "[", 
          RowBox[{
           RowBox[{"\[CapitalDelta]$I", " ", "Iz"}], ",", "t", ",", " ", 
           "#"}], "]"}], "&"}]}], " ", "//", " ", 
       RowBox[{
        RowBox[{"SimplifyingEvolver", "[", " ", 
         RowBox[{
          RowBox[{"\[CapitalDelta]$S", " ", "Sz"}], ",", "t", ",", " ", "#"}],
          "]"}], "&"}]}], " ", "//", " ", 
      RowBox[{
       RowBox[{"SimplifyingEvolver", "[", " ", 
        RowBox[{
         RowBox[{"J", " ", 
          RowBox[{"Mult", "[", 
           RowBox[{"Iz", ",", "Sz"}], "]"}]}], ",", "t", ",", " ", "#"}], 
        "]"}], "&"}]}], ")"}], "//", " ", "MultSort"}], ")"}], 
  " "}]}], "Input",
 CellChangeTimes->{{3.671877735591198*^9, 3.671877777960278*^9}, {
  3.67187818424365*^9, 3.671878184625901*^9}, {3.671889683947451*^9, 
  3.671889723854686*^9}, {3.671925059162591*^9, 3.671925096156954*^9}, {
  3.6719630336215677`*^9, 3.6719630425023947`*^9}, {3.6719631554075117`*^9, 
  3.6719631561733017`*^9}, {3.671963240022921*^9, 3.6719632503153048`*^9}, {
  3.8599171852895527`*^9, 3.859917186471232*^9}, {3.940182145443535*^9, 
  3.94018215988614*^9}},
 FontSize->16,
 CellLabel->
  "In[100]:=",ExpressionUUID->"3581c660-0670-48d2-80f5-bfdf64503dfb"],

Cell["\<\
The FreeEvolution operator distributes over Plus, Times, and \
NoncommutativeMultiply.  Scalars in front of operators can be pulled out \
front.\
\>", "Text",
 CellChangeTimes->{{3.671924646481277*^9, 3.6719246493459263`*^9}, {
   3.671925651143633*^9, 3.671925658983102*^9}, 3.859917193418729*^9},
 FontSize->18,ExpressionUUID->"ed808b88-6677-4519-8546-6c73c259a5fc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FreeEvolution", "[", 
   RowBox[{"\[Rho]_Plus", ",", "t_"}], "]"}], " ", ":=", 
  RowBox[{"Plus", " ", "@@", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"FreeEvolution", "[", 
       RowBox[{"#", ",", "t"}], "]"}], "&"}], ")"}], " ", "/@", " ", 
    RowBox[{"List", " ", "@@", " ", "\[Rho]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FreeEvolution", "[", 
   RowBox[{"\[Rho]_Times", ",", "t_"}], "]"}], " ", ":=", 
  RowBox[{"Times", "@@", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"FreeEvolution", "[", 
       RowBox[{"#", ",", "t"}], "]"}], "&"}], ")"}], " ", "/@", " ", 
    RowBox[{"List", " ", "@@", " ", "\[Rho]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FreeEvolution", "[", 
   RowBox[{"\[Rho]_Mult", ",", "t_"}], "]"}], " ", ":=", 
  RowBox[{"Mult", " ", "@@", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"FreeEvolution", "[", 
       RowBox[{"#", ",", "t"}], "]"}], "&"}], ")"}], " ", "/@", " ", 
    RowBox[{"List", " ", "@@", " ", "\[Rho]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FreeEvolution", "[", 
   RowBox[{
    RowBox[{"Times", "[", 
     RowBox[{
      RowBox[{"a_", "?", "CommutativeQ"}], ",", "\[Rho]_"}], "]"}], ",", 
    "t_"}], "]"}], " ", ":=", " ", 
  RowBox[{"a", " ", 
   RowBox[{"FreeEvolution", "[", 
    RowBox[{"\[Rho]", ",", "t"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.940182164121093*^9, 3.9401821699663773`*^9}},
 FontSize->16,
 CellLabel->
  "In[102]:=",ExpressionUUID->"2e7f29a4-fbf9-40ab-8170-3e9fed11f2f7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Load Spin 1/2 matrices", "Section",
 CellChangeTimes->{{3.6718779522899103`*^9, 
  3.671877960425688*^9}},ExpressionUUID->"05cb1599-f7a5-49d8-bea3-\
9a7bfaf8564e"],

Cell[BoxData[
 RowBox[{"<<", "Matrices--two-spin-half.m"}]], "Input",
 CellChangeTimes->{{3.671445490424717*^9, 3.6714454909529467`*^9}},
 FontSize->16,
 CellLabel->
  "In[106]:=",ExpressionUUID->"bf6bc250-f027-4d13-aae7-c6b4f4cccda4"],

Cell["\<\
This set of rules will substitute appropriate 4 x 4 matrices for the symbolic \
spin operators above. \
\>", "Text",
 CellChangeTimes->{{3.6718780024276733`*^9, 3.671878004427381*^9}},
 FontSize->18,ExpressionUUID->"f50922a1-80bf-49ee-8c8a-44da10a94ed9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SubstituteSpinMatrices", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Ix", "\[Rule]", " ", "mIx"}], ",", 
     RowBox[{"Iy", "\[Rule]", " ", "mIy"}], ",", 
     RowBox[{"Iz", "\[Rule]", " ", "mIz"}], ",", 
     RowBox[{"Sx", "\[Rule]", " ", "mSx"}], ",", 
     RowBox[{"Sy", "\[Rule]", " ", "mSy"}], ",", 
     RowBox[{"Sz", "\[Rule]", " ", "mSz"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{3.8599183975113993`*^9},
 FontSize->16,
 CellLabel->
  "In[107]:=",ExpressionUUID->"bb33eed5-d991-496f-a29b-f88eb937179e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Utility functions for one-dimensional data", "Section",
 CellChangeTimes->{{3.6718794064359694`*^9, 3.671879415291848*^9}, {
  3.671880018523059*^9, 3.6718800471106577`*^9}, {3.671925764434554*^9, 
  3.6719257748967113`*^9}},ExpressionUUID->"88873bb6-533c-42db-813d-\
c3a61f692c66"],

Cell["Make an array of time data", "Text",
 CellChangeTimes->{{3.671878645734527*^9, 3.671878678346408*^9}, {
  3.671925781469522*^9, 3.67192578386439*^9}},
 FontSize->18,ExpressionUUID->"ffe91360-6632-4f13-9965-1c91b72fb80a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TimeArray", "[", 
   RowBox[{"NN_", ",", "T_"}], "]"}], " ", ":=", " ", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"NN", " ", "=", " ", 
    RowBox[{"number", " ", "of", " ", "points"}]}], "      ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"T", " ", "=", " ", 
    RowBox[{"total", " ", "acquisition", " ", "time"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dt", ",", "t"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dt", " ", "=", " ", 
      RowBox[{"T", "/", 
       RowBox[{"(", 
        RowBox[{"NN", "-", "1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"t", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"ii", "*", "dt"}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", "0", ",", 
          RowBox[{"NN", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "t", "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.671878683068866*^9, 3.671878800245549*^9}, {
  3.671878903403461*^9, 3.671878903841281*^9}, {3.671879226918907*^9, 
  3.671879260333274*^9}, {3.671879772710465*^9, 3.671879773045829*^9}, {
  3.8599172214352903`*^9, 3.859917223742859*^9}},
 FontSize->18,
 CellLabel->
  "In[108]:=",ExpressionUUID->"f15baf2a-9de8-4c32-848d-e0a22075485c"],

Cell["Print out the time step and the Nyquist frequency", "Text",
 CellChangeTimes->{{3.671878645734527*^9, 3.671878678346408*^9}, {
  3.671879180165639*^9, 3.671879204321514*^9}, {3.671925793925869*^9, 
  3.671925799312703*^9}},
 FontSize->18,ExpressionUUID->"f628e189-d9fb-42fc-a2ff-e8eebdfd379c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TimeArrayReport", "[", "t_", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"t", " ", "=", " ", 
    RowBox[{"List", " ", "of", " ", "time", " ", "points"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "dt", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dt", " ", "=", " ", 
      RowBox[{
       RowBox[{"t", "[", 
        RowBox[{"[", "2", "]"}], "]"}], " ", "-", " ", 
       RowBox[{"t", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<The time step is \>\"", ",", "dt", ",", "\"\< s\>\""}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<The Nyquist frequency is \>\"", ",", 
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{"2", "*", "dt"}], ")"}]}], ",", "\"\< Hz\>\""}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6718790750566072`*^9, 3.671879152792118*^9}, {
  3.671879265062523*^9, 3.671879274937353*^9}, {3.8599172171378593`*^9, 
  3.859917218804387*^9}},
 FontSize->18,
 CellLabel->
  "In[109]:=",ExpressionUUID->"51e5d797-28ac-484f-ab10-9879aa3e9b2d"],

Cell["\<\
Calculate the digital Fourier transform of a one-dimensional time-domain \
signal and plot it.\
\>", "Text",
 CellChangeTimes->{{3.67145051013356*^9, 3.671450534424446*^9}, {
  3.671925803906604*^9, 3.671925826665345*^9}},
 FontSize->18,ExpressionUUID->"c73d1ddc-ed88-4cb2-80bf-7e15b91c6479"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DFFT", "[", 
   RowBox[{"signal_", ",", "t_", ",", " ", 
    RowBox[{"query_", ":", "True"}]}], "]"}], " ", ":=", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"signal", " ", "=", " ", 
    RowBox[{"a", " ", 
     StyleBox["function",
      FontSlant->"Italic"], " ", "that", " ", "computes", " ", "the", " ", 
     "signal"}]}], " ", "*)"}], "\[IndentingNewLine]", " ", 
  RowBox[{"(*", "      ", 
   RowBox[{"t", " ", "=", " ", 
    RowBox[{"a", " ", "list", " ", "of", " ", "time", " ", "points"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", " ", 
  RowBox[{"(*", "  ", 
   RowBox[{"query", " ", "=", " ", 
    RowBox[{"True", " ", "or", " ", "False"}]}], " ", "*)"}], "    ", 
  "\[IndentingNewLine]", " ", 
  RowBox[{"(*", "          ", 
   RowBox[{
    RowBox[{
    "True", " ", "to", " ", "plot", " ", "the", " ", "real", " ", "part"}], 
    ",", " ", 
    RowBox[{"imaginary", " ", "part"}], ",", " ", 
    RowBox[{"and", " ", "magnitude", " ", "of", " ", "the", " ", "FT"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", " ", 
  RowBox[{"(*", "          ", 
   RowBox[{
   "False", " ", "to", " ", "plot", " ", "only", " ", "the", " ", "eal", " ", 
    "part", " ", "of", " ", "the", " ", "FT"}], " ", "*)"}], 
  StyleBox["\[IndentingNewLine]",
   FontSize->16], "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"NN", ",", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"number", " ", "of", " ", "data", " ", "points"}], " ", "*)"}],
       "\[IndentingNewLine]", "               ", "T", ",", "  ", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"total", " ", "acquisition", " ", "time"}], ";", " ", 
        RowBox[{
        "assumes", " ", "data", " ", "starts", " ", "at", " ", "zero"}]}], 
       " ", "*)"}], "\[IndentingNewLine]", "               ", "f"}], "      ", 
     RowBox[{"(*", " ", 
      RowBox[{"array", " ", "of", " ", "frequency", " ", "points"}], " ", 
      "*)"}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"NN", " ", "=", " ", 
      RowBox[{
       RowBox[{"Dimensions", "[", 
        RowBox[{"signal", " ", "/@", " ", "t"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"FFTS", " ", "=", " ", 
      RowBox[{"RotateRight", "[", 
       RowBox[{
        RowBox[{"Fourier", "[", 
         RowBox[{"signal", "/@", " ", "t"}], "]"}], ",", 
        RowBox[{"NN", "/", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"T", " ", "=", " ", 
      RowBox[{"t", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"f", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"jj", "/", "T"}], ",", 
        RowBox[{"{", 
         RowBox[{"jj", ",", 
          RowBox[{
           RowBox[{"-", "NN"}], "/", "2"}], ",", 
          RowBox[{
           RowBox[{"NN", "/", "2"}], "-", "1"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"p1", "=", " ", 
      RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"t", ",", 
             RowBox[{"Re", "[", 
              RowBox[{"signal", " ", "/@", " ", "t"}], "]"}]}], "}"}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"t", ",", 
             RowBox[{"Im", "[", 
              RowBox[{"signal", "/@", " ", "t"}], "]"}]}], "}"}], "]"}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"AxesLabel", "\[Rule]", " ", 
         RowBox[{"{", 
          RowBox[{"\"\<time [s]\>\"", ",", "\"\<signal\>\""}], "}"}]}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"query", " ", "\[Equal]", " ", "True"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"p2", "=", 
        RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{"f", ",", 
               RowBox[{"Re", "[", "FFTS", "]"}]}], "}"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{"f", ",", 
               RowBox[{"Im", "[", "FFTS", "]"}]}], "}"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{"f", ",", 
               RowBox[{"Abs", "[", "FFTS", "]"}]}], "}"}], "]"}]}], " ", 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"PlotRange", "\[Rule]", " ", "All"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<freq [Hz]\>\"", ",", "\"\<DFT{signal}\>\""}], 
            "}"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"p2", "=", 
        RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"f", ",", 
             RowBox[{"Re", "[", "FFTS", "]"}]}], "}"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"PlotRange", "\[Rule]", " ", "All"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<freq [Hz]\>\"", ",", "\"\<DFT{signal}\>\""}], 
            "}"}]}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{"GraphicsGrid", "[", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"p1", ",", "p2"}], "}"}], "}"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.594944534421811*^9, 3.5949447042651577`*^9}, {
   3.594944761549816*^9, 3.5949447856729527`*^9}, {3.5949457080553913`*^9, 
   3.594945725580372*^9}, 3.594957008065167*^9, {3.5949599090104303`*^9, 
   3.594959943126217*^9}, {3.671420918194263*^9, 3.671420985060692*^9}, {
   3.6714500698553047`*^9, 3.6714501975055017`*^9}, {3.671450354497389*^9, 
   3.671450368115725*^9}, {3.6714504102572317`*^9, 3.671450429646456*^9}, {
   3.6714507085616426`*^9, 3.671450719913899*^9}, {3.671450779304175*^9, 
   3.671450820615818*^9}, {3.6714508637422657`*^9, 3.671450868872673*^9}, {
   3.6714509162185383`*^9, 3.671450949134245*^9}, {3.6714510544854803`*^9, 
   3.671451069853394*^9}, {3.6718792844380093`*^9, 3.671879368113778*^9}, {
   3.671925835717597*^9, 3.6719258742851*^9}, {3.671925936992208*^9, 
   3.671926034878324*^9}, {3.671968479061063*^9, 3.6719685186359243`*^9}, {
   3.671970633853286*^9, 3.6719706378576927`*^9}, {3.671970687142659*^9, 
   3.6719706935478477`*^9}, {3.6719707976287947`*^9, 3.671970817673162*^9}, {
   3.8599172421229267`*^9, 3.8599172628743258`*^9}},
 FontSize->16,
 CellLabel->
  "In[110]:=",ExpressionUUID->"97acd604-a5cd-428d-b93e-cd9c0bef4898"],

Cell["\<\
Calculate the digital Fourier transform of a one-dimensional time-domain \
signal and plot it.\
\>", "Text",
 CellChangeTimes->{{3.67145051013356*^9, 3.671450534424446*^9}, {
  3.671925803906604*^9, 3.671925826665345*^9}},
 FontSize->18,ExpressionUUID->"2cb67f03-2f5f-4d77-a556-6479f77dbbcd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DFFT$all", "[", 
   RowBox[{"signal_", ",", "t_"}], "]"}], " ", ":=", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"signal", " ", "=", " ", 
    RowBox[{"A", " ", 
     StyleBox["function",
      FontSlant->"Italic"], " ", "that", " ", "computes", " ", "the", " ", 
     "signal"}]}], " ", "*)"}], "\[IndentingNewLine]", " ", 
  RowBox[{"(*", "      ", 
   RowBox[{"t", " ", "=", " ", 
    RowBox[{"A", " ", "list", " ", "of", " ", "time", " ", "points"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", " ", 
  RowBox[{"(*", "  ", 
   RowBox[{"query", " ", "=", " ", 
    RowBox[{"True", " ", "or", " ", "False"}]}], " ", "*)"}], "    ", 
  "\[IndentingNewLine]", " ", 
  RowBox[{"(*", "          ", 
   RowBox[{
    RowBox[{
    "True", " ", "to", " ", "plot", " ", "the", " ", "real", " ", "part"}], 
    ",", " ", 
    RowBox[{"imaginary", " ", "part"}], ",", " ", 
    RowBox[{"and", " ", "magnitude", " ", "of", " ", "the", " ", "FT"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", " ", 
  RowBox[{"(*", "          ", 
   RowBox[{
   "False", " ", "to", " ", "plot", " ", "only", " ", "the", " ", "real", " ",
     "part", " ", "of", " ", "the", " ", "FT"}], " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"NN", ",", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"number", " ", "of", " ", "data", " ", "points"}], " ", "*)"}],
       "\[IndentingNewLine]", "               ", "T", ",", "  ", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"total", " ", "acquisition", " ", "time"}], ";", " ", 
        RowBox[{
        "assumes", " ", "data", " ", "starts", " ", "at", " ", "zero"}]}], 
       " ", "*)"}], "\[IndentingNewLine]", "               ", "f"}], "      ", 
     RowBox[{"(*", " ", 
      RowBox[{"array", " ", "of", " ", "frequency", " ", "points"}], " ", 
      "*)"}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"NN", " ", "=", " ", 
      RowBox[{
       RowBox[{"Dimensions", "[", 
        RowBox[{"signal", " ", "/@", " ", "t"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"FFTS", " ", "=", " ", 
      RowBox[{"RotateRight", "[", 
       RowBox[{
        RowBox[{"Fourier", "[", 
         RowBox[{"signal", "/@", " ", "t"}], "]"}], ",", 
        RowBox[{"NN", "/", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"T", " ", "=", " ", 
      RowBox[{"t", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"f", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"jj", "/", "T"}], ",", 
        RowBox[{"{", 
         RowBox[{"jj", ",", 
          RowBox[{
           RowBox[{"-", "NN"}], "/", "2"}], ",", 
          RowBox[{
           RowBox[{"NN", "/", "2"}], "-", "1"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"p1", "=", 
      RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{"f", ",", 
           RowBox[{"Re", "[", "FFTS", "]"}]}], "}"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"PlotRange", "\[Rule]", " ", "All"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"AxesLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<freq [Hz]\>\"", ",", "\"\<Re[DFT{signal}]\>\""}], 
          "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"p2", "=", 
      RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{"f", ",", 
           RowBox[{"Im", "[", "FFTS", "]"}]}], "}"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"PlotRange", "\[Rule]", " ", "All"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"AxesLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<freq [Hz]\>\"", ",", "\"\<Im[DFT{signal}]\>\""}], 
          "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"p3", "=", 
      RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{"f", ",", 
           RowBox[{"Abs", "[", "FFTS", "]"}]}], "}"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"PlotRange", "\[Rule]", " ", "All"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"AxesLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<freq [Hz]\>\"", ",", "\"\<Abs[DFT{signal}]\>\""}], 
          "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{"GraphicsGrid", "[", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"p1", ",", "p2", ",", "p3"}], "}"}], "}"}], "]"}], "]"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.594944534421811*^9, 3.5949447042651577`*^9}, {
   3.594944761549816*^9, 3.5949447856729527`*^9}, {3.5949457080553913`*^9, 
   3.594945725580372*^9}, 3.594957008065167*^9, {3.5949599090104303`*^9, 
   3.594959943126217*^9}, {3.671420918194263*^9, 3.671420985060692*^9}, {
   3.6714500698553047`*^9, 3.6714501975055017`*^9}, {3.671450354497389*^9, 
   3.671450368115725*^9}, {3.6714504102572317`*^9, 3.671450429646456*^9}, {
   3.6714507085616426`*^9, 3.671450719913899*^9}, {3.671450779304175*^9, 
   3.671450820615818*^9}, {3.6714508637422657`*^9, 3.671450868872673*^9}, {
   3.6714509162185383`*^9, 3.671450949134245*^9}, {3.6714510544854803`*^9, 
   3.671451069853394*^9}, {3.6718792844380093`*^9, 3.671879368113778*^9}, {
   3.671925835717597*^9, 3.6719258742851*^9}, {3.671925936992208*^9, 
   3.671926034878324*^9}, {3.671968479061063*^9, 3.6719685186359243`*^9}, {
   3.671970633853286*^9, 3.6719706378576927`*^9}, {3.671970687142659*^9, 
   3.6719706935478477`*^9}, {3.6719707976287947`*^9, 3.671970817673162*^9}, {
   3.67213616116146*^9, 3.6721362437379303`*^9}, {3.6721362836034946`*^9, 
   3.6721362872414103`*^9}, {3.6721364527386017`*^9, 3.672136468932028*^9}, {
   3.859917278736855*^9, 3.8599172805479317`*^9}},
 FontSize->16,
 CellLabel->
  "In[112]:=",ExpressionUUID->"2c24caa5-d9c8-4768-942c-338cbb2870c2"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Utility function to reduce density operator to a matrix", "Section",
 CellChangeTimes->{{3.671877788364067*^9, 3.671877801891901*^9}, {
   3.67193091232129*^9, 3.671930920025263*^9}, 3.671931208844771*^9, {
   3.8599184512738857`*^9, 
   3.859918475821826*^9}},ExpressionUUID->"289dc7e7-5318-4734-b9ec-\
9bd92e0d4fbf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeNumerical", "[", "expression_", "]"}], " ", ":=", " ", 
  "\[IndentingNewLine]", 
  RowBox[{"ReplaceAll", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ReplaceAll", "[", 
     RowBox[{"expression", ",", 
      RowBox[{"NonCommutativeMultiply", " ", "->", " ", "Dot"}]}], "]"}], ",",
     "\[IndentingNewLine]", "SubstituteSpinMatrices"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.859918478843483*^9, 3.8599185707292013`*^9}},
 FontSize->16,
 CellLabel->
  "In[113]:=",ExpressionUUID->"45870b17-3f73-4104-969e-1303b058835f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Free-evolution signal", "Section",
 CellChangeTimes->{{3.671877788364067*^9, 3.671877801891901*^9}, {
   3.67193091232129*^9, 3.671930920025263*^9}, 
   3.671931208844771*^9},ExpressionUUID->"0c130c8d-f981-468b-b1cc-\
abc6daf95179"],

Cell["Edit the chemical shifts and the J-couplings here", "Text",
 FontSize->18,
 Background->RGBColor[
  1, 1, 0],ExpressionUUID->"61b6a67f-221d-42e6-aa9d-8b191b39263f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "HamiltonianParameters$coupled", " ", "=", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[CapitalDelta]$I", "\[Rule]", " ", 
      RowBox[{"2", "\[Pi]", " ", "*", " ", "100"}]}], ",", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"I", "-", 
       RowBox[{"spin", " ", "chemical", " ", 
        RowBox[{"shift", " ", "[", "radians", "]"}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"\[CapitalDelta]$S", " ", "\[Rule]", " ", 
      RowBox[{"2", "\[Pi]", " ", "*", "300"}]}], ",", "  ", 
     RowBox[{"(*", " ", 
      RowBox[{"S", "-", 
       RowBox[{"spin", " ", "chemical", " ", 
        RowBox[{"shift", " ", "[", "radians", "]"}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"J", " ", "\[Rule]", 
      RowBox[{"2", "\[Pi]", " ", "*", " ", "50"}]}], ",", "        ", 
     RowBox[{"(*", " ", 
      RowBox[{"scalar", " ", 
       RowBox[{"coupling", " ", "[", "radians", "]"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"T2", " ", "->", " ", "0.3"}]}], "                 ", 
    RowBox[{"(*", " ", 
     RowBox[{"spin", " ", "dephasing", " ", 
      RowBox[{"time", " ", "[", "s", "]"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", " ", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6718784052135963`*^9, 3.671878411230259*^9}, {
   3.6718899865391703`*^9, 3.6718899879822617`*^9}, {3.671893345336955*^9, 
   3.671893358339196*^9}, {3.671893432270978*^9, 3.671893433199575*^9}, {
   3.671893502024897*^9, 3.671893516017412*^9}, {3.671926065314743*^9, 
   3.6719260897642317`*^9}, {3.671926204655142*^9, 3.6719262049565563`*^9}, {
   3.6719263239631643`*^9, 3.671926440113193*^9}, 3.8599184345131283`*^9},
 FontSize->16,
 Background->GrayLevel[0.900008],
 CellLabel->
  "In[114]:=",ExpressionUUID->"70d01c13-0b5c-45e9-93bd-7a35b4dcc9a2"],

Cell["\<\
Make a copy of the parameters with the scalar coupling set to zero, e.g., \
with the two spins uncoupled.  Useful for testing.\
\>", "Text",
 CellChangeTimes->{{3.671926459357728*^9, 3.671926507429882*^9}},
 FontSize->18,ExpressionUUID->"93ece18b-65c6-40ac-ae39-9e4bb8f8498c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "HamiltonianParameters$uncoupled", " ", "=", " ", 
   "HamiltonianParameters$coupled"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HamiltonianParameters$uncoupled", "[", 
    RowBox[{"[", "3", "]"}], "]"}], "  ", "=", " ", 
   RowBox[{"J", "\[Rule]", " ", "0"}]}], ";"}]}], "Input",
 FontSize->18,
 CellLabel->
  "In[115]:=",ExpressionUUID->"a058680f-ed54-4782-ad08-3d45339d28b3"],

Cell[TextData[{
 "Evolve the initial density operator ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["I", "x"], "+", 
    SubscriptBox["S", "x"]}], TraditionalForm]],ExpressionUUID->
  "03634782-c2e7-4a43-a9fb-87c8fdfba20e"],
 " under the coupled-spin Hamiltonian.  Add an exponential decay so we get a \
reasonable looking signal.  Calculate the signal corresponding to observation \
of the complex signal (",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["I", "x"], "+", 
    SubscriptBox["S", "x"]}], TraditionalForm]],ExpressionUUID->
  "e9482f9e-e703-4f1b-8fb6-761ef8aaca2d"],
 ") + I (",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["I", "y"], "+", 
    SubscriptBox["S", "xy"]}], TraditionalForm]],ExpressionUUID->
  "02d142e6-a554-472f-a65a-ca796595e3ad"],
 ") using the matrix form of the operators."
}], "Text",
 CellChangeTimes->{{3.671926609871134*^9, 3.6719267717859077`*^9}, {
   3.671926805754479*^9, 3.671926826367587*^9}, 3.859917299913456*^9},
 FontSize->18,ExpressionUUID->"97d8cfd2-75a0-4330-b083-fb6aedd1f5e1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Rho]", " ", "=", " ", 
   RowBox[{
    RowBox[{"FreeEvolution", "[", 
     RowBox[{
      RowBox[{"Ix", " ", "+", " ", "Sx"}], ",", "t"}], "]"}], " ", 
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", "t"}], "/", "T2"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Signal", "[", "t_", "]"}], " ", "=", " ", 
   RowBox[{
    RowBox[{"MakeNumerical", "[", 
     RowBox[{"Tr", "[", 
      RowBox[{"Mult", "[", 
       RowBox[{"\[Rho]", ",", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Ix", " ", "+", " ", "Sx"}], ")"}], " ", "+", " ", 
          RowBox[{"I", " ", 
           RowBox[{"(", 
            RowBox[{"Iy", " ", "+", " ", "Sy"}], ")"}]}]}], ")"}]}], "]"}], 
      "]"}], "]"}], "/.", " ", "HamiltonianParameters$coupled"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.6718778062706413`*^9, 3.671877871978508*^9}, {
  3.671878060162859*^9, 3.671878069913027*^9}, {3.6718783287908993`*^9, 
  3.671878354545123*^9}, {3.671926521847446*^9, 3.67192659098673*^9}, {
  3.859917392125042*^9, 3.8599174258736477`*^9}, {3.859918581398905*^9, 
  3.85991859012287*^9}, {3.940182276971735*^9, 3.94018229271887*^9}},
 FontSize->18,
 CellLabel->
  "In[117]:=",ExpressionUUID->"30b846b9-a52f-4dea-b902-edc91d57b187"],

Cell["Check that the signal is a scalar.", "Text",
 CellChangeTimes->{{3.8599174502469473`*^9, 3.859917470762348*^9}},
 FontSize->16,ExpressionUUID->"9946b5aa-cae5-44ee-a404-e667f254eff6"],

Cell[BoxData[
 RowBox[{"Signal", "[", "t", "]"}]], "Input",
 CellChangeTimes->{{3.859917325918008*^9, 3.859917326330727*^9}},
 FontSize->16,
 CellLabel->
  "In[119]:=",ExpressionUUID->"4ba27410-fc87-4a31-8ea7-320eafcb8bed"],

Cell["Create an array of 1024 time points.", "Text",
 CellChangeTimes->{{3.6719267775702467`*^9, 3.671926789124267*^9}, {
  3.671926831972439*^9, 3.671926853607119*^9}},
 FontSize->18,ExpressionUUID->"eba1ae10-ae29-4de8-8efa-d5b3e0c2c42b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"t$List", " ", "=", " ", 
   RowBox[{"TimeArray", "[", 
    RowBox[{
     RowBox[{"2", "^", "10"}], ",", "1.0"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"t$List", "  ", "//", " ", "TimeArrayReport"}]}], "Input",
 CellChangeTimes->{{3.671878809659215*^9, 3.671878851393158*^9}, {
  3.6718789144656487`*^9, 3.671878914874456*^9}, {3.671878946684762*^9, 
  3.6718789474033823`*^9}, {3.671879016941156*^9, 3.6718790191336823`*^9}, {
  3.671879463966322*^9, 3.671879520402073*^9}},
 FontSize->18,
 CellLabel->
  "In[120]:=",ExpressionUUID->"bd2b4d1b-1c36-45e7-98c3-ad4853b1b0e3"],

Cell["\<\
Calculate the time-domain signal.  Fourier transform it to reveal the \
spectrum of the two coupled spins.\
\>", "Text",
 CellChangeTimes->{{3.6719268568921213`*^9, 3.6719269042170486`*^9}},
 FontSize->18,ExpressionUUID->"6c0fe435-0a3d-4318-9bf2-47328f5c914a"],

Cell[BoxData[
 RowBox[{"DFFT", "[", 
  RowBox[{"Signal", ",", "t$List", ",", "True"}], "]"}]], "Input",
 CellChangeTimes->{{3.671878923786921*^9, 3.671878955234336*^9}, {
  3.67187903156674*^9, 3.6718790328034353`*^9}, {3.671879480142063*^9, 
  3.671879482371788*^9}, {3.671968450735117*^9, 3.6719684606398087`*^9}, {
  3.672135778917077*^9, 3.672135779491321*^9}},
 FontSize->18,
 CellLabel->
  "In[122]:=",ExpressionUUID->"8cd2e1cb-eeb3-4ead-b34b-76a59f80cd0b"],

Cell["\<\
Let's plot the real, imaginary, and absolute value signals separately.  \
Notice how broad the imaginary-channel and absolute-value channel signals are.\
\>", "Text",
 CellChangeTimes->{{3.672138184827166*^9, 3.672138231470685*^9}, {
  3.859917493890821*^9, 3.859917514514173*^9}},
 FontSize->18,ExpressionUUID->"7c675140-137c-482b-aef1-4e6db7945eaa"],

Cell[BoxData[
 RowBox[{"DFFT$all", "[", 
  RowBox[{"Signal", ",", "t$List"}], "]"}]], "Input",
 CellChangeTimes->{{3.672136259603026*^9, 3.672136261997446*^9}},
 FontSize->18,
 CellLabel->
  "In[123]:=",ExpressionUUID->"d4fb6e84-56b5-4fc5-b7ae-3ec30f1ad9cc"],

Cell["\<\
Recalculate the signal with the spin-spin coupling dialed to zero.  Note how \
the doublet pattern in the spectrum vanishes.\
\>", "Text",
 CellChangeTimes->{{3.6719269354635553`*^9, 3.6719269775769243`*^9}},
 FontSize->18,ExpressionUUID->"e5a90fb6-20e8-4ed3-989a-39bf763b6051"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Rho]", " ", "=", " ", 
   RowBox[{
    RowBox[{"FreeEvolution", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Ix", "+", "Sx"}], ")"}], " ", ",", "t"}], "]"}], " ", 
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", "t"}], "/", "T2"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Signal", "[", "t_", "]"}], " ", "=", " ", 
   RowBox[{
    RowBox[{"MakeNumerical", "[", 
     RowBox[{"Tr", "[", 
      RowBox[{"\[Rho]", "**", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Ix", " ", "+", " ", "Sx"}], ")"}], " ", "+", " ", 
         RowBox[{"I", " ", 
          RowBox[{"(", 
           RowBox[{"Iy", " ", "+", " ", "Sy"}], ")"}]}]}], ")"}]}], "]"}], 
     "]"}], " ", "/.", " ", "HamiltonianParameters$uncoupled"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"DFFT", "[", 
  RowBox[{"Signal", ",", "t$List", ",", "False"}], "]"}]}], "Input",
 CellChangeTimes->{{3.671890058520727*^9, 3.671890093220854*^9}, {
   3.859917585569725*^9, 3.859917590880361*^9}, 3.859917943703884*^9, {
   3.8599186303349047`*^9, 3.8599186548347893`*^9}, {3.85991869783672*^9, 
   3.859918702412146*^9}},
 FontSize->18,
 CellLabel->
  "In[124]:=",ExpressionUUID->"2b307d00-e435-4648-aada-4e0404b66d18"],

Cell[TextData[{
 "Evolve just ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["I", "x"], TraditionalForm]],ExpressionUUID->
  "a9d6b80f-21f3-4739-98ea-df50c2ec10a4"],
 ".  We see just one of the doublets."
}], "Text",
 CellChangeTimes->{{3.671926991546083*^9, 3.671927063528008*^9}},
 FontSize->18,ExpressionUUID->"7ce4a0fc-b1c4-453f-bce3-19cd8a36a0e8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Rho]", " ", "=", " ", 
   RowBox[{
    RowBox[{"FreeEvolution", "[", 
     RowBox[{"Ix", " ", ",", "t"}], "]"}], " ", 
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", "t"}], "/", "T2"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Signal", "[", "t_", "]"}], " ", "=", " ", 
   RowBox[{
    RowBox[{"MakeNumerical", "[", 
     RowBox[{"Tr", "[", 
      RowBox[{"\[Rho]", "**", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Ix", " ", "+", " ", "Sx"}], ")"}], " ", "+", " ", 
         RowBox[{"I", " ", 
          RowBox[{"(", 
           RowBox[{"Iy", " ", "+", " ", "Sy"}], ")"}]}]}], ")"}]}], "]"}], 
     "]"}], "/.", " ", "HamiltonianParameters$coupled"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"DFFT", "[", 
  RowBox[{"Signal", ",", "t$List", ",", "False"}], "]"}]}], "Input",
 CellChangeTimes->{{3.671879552920395*^9, 3.6718796083732033`*^9}, {
   3.6718798308195457`*^9, 3.671879835009947*^9}, {3.67189010920415*^9, 
   3.6718901116128597`*^9}, 3.671927043032271*^9, {3.8599176009494123`*^9, 
   3.85991760586744*^9}, 3.859917947721401*^9, {3.859918669279318*^9, 
   3.859918693941895*^9}},
 FontSize->18,
 CellLabel->
  "In[127]:=",ExpressionUUID->"a06b8099-3a24-4b24-ae73-ff4d23972b4f"],

Cell[TextData[{
 "Evolve just ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["S", "x"], TraditionalForm]],ExpressionUUID->
  "c5d51d67-c5af-4f60-aa15-7647af8c62b4"],
 ".  See see just the other doublet."
}], "Text",
 CellChangeTimes->{{3.671926991546083*^9, 3.67192707818895*^9}},
 FontSize->18,ExpressionUUID->"52bceea9-6404-4f64-840d-0533f89635f7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Rho]", " ", "=", " ", 
   RowBox[{
    RowBox[{"FreeEvolution", "[", 
     RowBox[{"Sx", " ", ",", "t"}], "]"}], " ", 
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", "t"}], "/", "T2"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Signal", "[", "t_", "]"}], " ", "=", " ", 
   RowBox[{
    RowBox[{"MakeNumerical", "[", 
     RowBox[{"Tr", "[", 
      RowBox[{"\[Rho]", "**", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Ix", " ", "+", " ", "Sx"}], ")"}], "+", " ", 
         RowBox[{"I", " ", 
          RowBox[{"(", 
           RowBox[{"Iy", " ", "+", " ", "Sy"}], ")"}]}]}], ")"}]}], "]"}], 
     "]"}], " ", "/.", " ", "HamiltonianParameters$coupled"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"DFFT", "[", 
  RowBox[{"Signal", ",", "t$List", ",", "False"}], "]"}]}], "Input",
 CellChangeTimes->{{3.671879828325494*^9, 3.671879870169961*^9}, {
   3.6718901173386097`*^9, 3.6718901188849373`*^9}, 3.671927093031798*^9, {
   3.671970717176458*^9, 3.671970717712057*^9}, {3.671970751675149*^9, 
   3.671970752300644*^9}, {3.8599176230686293`*^9, 3.859917627410981*^9}, 
   3.859917952725379*^9, {3.8599187154719973`*^9, 3.859918738705493*^9}},
 FontSize->18,
 CellLabel->
  "In[130]:=",ExpressionUUID->"16f27b54-a6e2-4e7a-92ca-bd69922b47dd"]
}, Open  ]],

Cell[CellGroupData[{

Cell["INEPT polarization transfer", "Section",
 CellChangeTimes->{{3.671894558571884*^9, 3.671894571280798*^9}, {
  3.671931193845932*^9, 
  3.6719311957679033`*^9}},ExpressionUUID->"b9d63c19-5106-4c29-9497-\
3d33588dc59e"],

Cell[TextData[{
 "Here INEPT is an acronym that stands for ",
 StyleBox["insensitive nuclei enhanced by polarization transfer",
  FontSlant->"Italic"],
 ".  Thinking through the INEPT experiment helps you understand how \
two-dimensional spectroscopy works.  \n\nThe INEPT experiment shows how a J \
coupling can be harnessed to transfer spin polarization from a nucleus with a \
large magnetic moment -- ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["\[InvisiblePrefixScriptBase]", "1"], 
    StyleBox["H",
     FontSlant->"Plain"]}], TraditionalForm]],ExpressionUUID->
  "2a178139-5662-40ce-b44e-c5d511d42947"],
 ", the I-spin here -- to a nucleus with a small magnetic moment -- ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["\[InvisiblePrefixScriptBase]", "13"], 
    StyleBox["C",
     FontSlant->"Plain"]}], TraditionalForm]],ExpressionUUID->
  "b720ae9f-0d12-41f7-a29f-32e68c13a7b7"],
 ", the S-spin here.  At thermal equilibrium the initial density operator is\n\
\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Rho]", "equil"], "=", " ", 
    RowBox[{
     RowBox[{"a", " ", 
      SubscriptBox["I", "z"]}], "+", " ", 
     RowBox[{"b", " ", 
      SubscriptBox["S", "z"]}]}]}], TraditionalForm]],ExpressionUUID->
  "76e036bd-4c7e-4705-9eb6-ff5453af0862"],
 "\n\t\nwith ",
 StyleBox["a",
  FontSlant->"Italic"],
 " and ",
 StyleBox["b",
  FontSlant->"Italic"],
 " the Curie factors for each of the spins.  We worked through these \
Curie-law factors in detail on a homework.  To discuss the INEPT experiment \
it is enough to know that the factor b is about 1/16 the size of the a factor:"
}], "Text",
 CellChangeTimes->{{3.67192713595021*^9, 3.671927213545163*^9}, {
  3.671927255053945*^9, 3.671927305940894*^9}, {3.671928174600897*^9, 
  3.671928577836887*^9}, {3.671928610351489*^9, 3.671928617136512*^9}},
 FontSize->18,ExpressionUUID->"89625a23-8035-420c-bbfa-f0f4620d2ddd"],

Cell[BoxData[
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"SubstitutePrefactors", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a", " ", "\[Rule]", " ", "1"}], ",", "  ", 
      RowBox[{"b", "\[Rule]", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox["1", "4"], ")"}], "2"]}]}], "}"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.671927856381318*^9, 3.6719278888428907`*^9}, 
   3.671928613109912*^9},
 FontSize->16,
 CellLabel->
  "In[133]:=",ExpressionUUID->"4ffa88fd-68b0-4963-ae3d-7bd8699fc63d"],

Cell[TextData[{
 "In other words, the thermal-equilibrium ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["\[InvisiblePrefixScriptBase]", "13"], 
    StyleBox["C",
     FontSlant->"Plain"]}], TraditionalForm]],ExpressionUUID->
  "46a9a333-50f0-4d31-9212-2df04c100c90"],
 " signal is about 1/16 as large as the thermal-equilibrium ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["\[InvisiblePrefixScriptBase]", "1"], 
    StyleBox["H",
     FontSlant->"Plain"]}], TraditionalForm]],ExpressionUUID->
  "37c85922-f1e1-405d-a82f-00194156d13b"],
 " signal in a magnetic resonance experiment.  "
}], "Text",
 CellChangeTimes->{{3.671928591928565*^9, 3.671928597076543*^9}, {
  3.6719287486694593`*^9, 3.6719289996695843`*^9}},
 FontSize->18,ExpressionUUID->"379e5f3f-d4d5-4761-a939-99add483084a"],

Cell[CellGroupData[{

Cell[TextData[{
 "The usual ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["\[InvisiblePrefixScriptBase]", "13"], 
    StyleBox["C",
     FontSlant->"Plain"]}], TraditionalForm]],ExpressionUUID->
  "c082b622-776c-434a-b375-b125fcf914aa"],
 " spectrum"
}], "Subsection",
 CellChangeTimes->{{3.6719290067686377`*^9, 
  3.671929046666102*^9}},ExpressionUUID->"7d90d886-6d2b-40f7-8b6d-\
d0a48a2190de"],

Cell[TextData[{
 "Let\[CloseCurlyQuote]s calculate the usual ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["\[InvisiblePrefixScriptBase]", "13"], 
    StyleBox["C",
     FontSlant->"Plain"]}], TraditionalForm]],ExpressionUUID->
  "85286824-a4f0-4691-af72-17728cc14a9b"],
 " signal.  Deliver a \[Pi]/2 pulse to the ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["\[InvisiblePrefixScriptBase]", "13"], 
    StyleBox["C",
     FontSlant->"Plain"]}], TraditionalForm]],ExpressionUUID->
  "8c3ab558-e481-4a20-831b-f398f49322c6"],
 " spins and then evolve the spins under the Hamiltonian\n\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"H", " ", "=", "  ", 
    RowBox[{
     RowBox[{
      FormBox[
       SubscriptBox["\[CapitalDelta]", "I"],
       TraditionalForm], " ", 
      SubscriptBox["I", "z"]}], "+", " ", 
     RowBox[{
      SubscriptBox["\[CapitalDelta]", "S"], " ", 
      SubscriptBox["S", "z"]}], " ", "+", " ", 
     RowBox[{"J", " ", 
      SubscriptBox["I", "z"], 
      SubscriptBox["S", "z"]}]}]}], TraditionalForm]],ExpressionUUID->
  "553f98ad-ffb0-4d7b-9bd7-6a94863a0711"],
 "\n\t\nFor simplicity we will work on resonance where ",
 Cell[BoxData[
  RowBox[{
   FormBox[
    RowBox[{
     SubscriptBox["\[CapitalDelta]", "I"], "\[RightArrow]", "0"}],
    TraditionalForm], " "}]],ExpressionUUID->
  "81b950a1-ef8f-4c2d-851f-d8d34c0b1a6f"],
 "and  ",
 Cell[BoxData[
  RowBox[{
   FormBox[
    SubscriptBox["\[CapitalDelta]", "S"],
    TraditionalForm], "\[RightArrow]", "0."}]],ExpressionUUID->
  "f291d63a-0b8d-4412-898b-99274a7087cd"]
}], "Text",
 CellChangeTimes->{{3.671928591928565*^9, 3.671928597076543*^9}, {
  3.6719287486694593`*^9, 3.671929005834066*^9}, {3.671929053396553*^9, 
  3.671929057388837*^9}, {3.671929101341604*^9, 3.6719291013416443`*^9}},
 FontSize->18,ExpressionUUID->"b455085f-aadc-4f23-8443-c98a2c69e993"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Rho]$0", "  ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"a", " ", "Iz"}], " ", "+", " ", 
     RowBox[{"b", " ", "Sz"}]}], "//", "  ", 
    RowBox[{
     RowBox[{"PulseS", "[", 
      RowBox[{"#", ",", 
       RowBox[{"\[Pi]", "/", "2"}], ",", 
       RowBox[{"\[Pi]", "/", "2"}]}], "]"}], "&"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"\[Rho]$1", " ", "=", " ", 
  RowBox[{
   RowBox[{"FreeEvolution", "[", 
    RowBox[{"\[Rho]$0", ",", "t"}], "]"}], "/.", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[CapitalDelta]$I", "\[Rule]", " ", "0"}], ",", 
     RowBox[{"\[CapitalDelta]$S", "\[Rule]", " ", "0"}]}], "}"}], 
   " "}]}]}], "Input",
 CellChangeTimes->{
  3.671894887871954*^9, {3.6718956707762423`*^9, 3.671895671663657*^9}, {
   3.671896898653215*^9, 3.671896899382049*^9}, {3.671897521305914*^9, 
   3.671897543198839*^9}, {3.67189776888809*^9, 3.671897769086577*^9}, {
   3.671897893950562*^9, 3.6718978993615923`*^9}, 3.6719273142720547`*^9, {
   3.671927352447545*^9, 3.6719273568931513`*^9}, {3.671927404413039*^9, 
   3.671927408445538*^9}, 3.671927442572917*^9, {3.67192759422403*^9, 
   3.671927659964732*^9}, {3.6719276908032627`*^9, 3.6719276955998983`*^9}, {
   3.671927829301469*^9, 3.67192784071618*^9}, {3.940182354941749*^9, 
   3.9401823562347193`*^9}, {3.940182450987216*^9, 3.940182457421838*^9}, {
   3.940182499901444*^9, 3.940182507731143*^9}},
 FontSize->16,
 CellLabel->
  "In[150]:=",ExpressionUUID->"119343a8-910f-4abe-bc82-dc48c75f0878"],

Cell[TextData[{
 "We detect the complex magnetization and Fourier transform it to obtain the ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["\[InvisiblePrefixScriptBase]", "13"], 
    StyleBox["C",
     FontSlant->"Plain"]}], TraditionalForm]],ExpressionUUID->
  "6df21bb2-49ce-4e7d-91e4-67172e843314"],
 " spectrum."
}], "Text",
 CellChangeTimes->{{3.671929074833055*^9, 3.671929108684803*^9}},
 FontSize->18,ExpressionUUID->"763a6242-2f70-4ce7-a795-f60ba0c2acc7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Signal", "[", "t_", "]"}], " ", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"MakeNumerical", "[", 
      RowBox[{
       RowBox[{"Tr", "[", 
        RowBox[{"Mult", "[", 
         RowBox[{"\[Rho]$1", ",", 
          RowBox[{"(", 
           RowBox[{"Sx", " ", "+", " ", 
            RowBox[{"I", " ", "Sy"}]}], ")"}]}], "]"}], "]"}], " ", 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", "t"}], "/", "T2"}], "]"}]}], "]"}], " ", "/.", " ", 
     "HamiltonianParameters$coupled"}], " ", ")"}], "/.", 
   "SubstitutePrefactors"}]}]], "Input",
 CellChangeTimes->{{3.671927850116914*^9, 3.6719278701482983`*^9}, 
   3.67192790017627*^9, {3.8599176780994787`*^9, 3.859917683176882*^9}, {
   3.859918752611991*^9, 3.8599187935398893`*^9}, {3.940182574849976*^9, 
   3.9401825797322617`*^9}},
 FontSize->16,
 CellLabel->
  "In[154]:=",ExpressionUUID->"761bafdc-31f5-4fa7-965e-16b0f4b9e897"],

Cell[BoxData[
 RowBox[{"DFFT", "[", 
  RowBox[{"Signal", ",", "t$List", ",", "False"}], "]"}]], "Input",
 FontSize->16,
 CellLabel->
  "In[155]:=",ExpressionUUID->"aa381f51-c179-42aa-adcd-522e702719fb"],

Cell["\<\
The spectrum shows a symmetric doublet, due the J-coupling, that is centered \
near zero frequency.  The height of each peak in the spectrum is \
approximately ~0.28.\
\>", "Text",
 CellChangeTimes->{{3.671929136026559*^9, 3.671929219557954*^9}, {
  3.859917701616226*^9, 3.859917706264279*^9}},
 FontSize->18,ExpressionUUID->"42391065-3d6b-4ff1-86be-1726eea35740"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "The ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["\[InvisiblePrefixScriptBase]", "13"], 
    StyleBox["C",
     FontSlant->"Plain"]}], TraditionalForm]],ExpressionUUID->
  "6c08a4e8-da4b-41f7-b87c-f0a7366abe57"],
 " spectrum following polarization transfer from ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["\[InvisiblePrefixScriptBase]", "1"], 
    StyleBox["H",
     FontSlant->"Plain"]}], TraditionalForm]],ExpressionUUID->
  "088a96ae-5ef3-4ae6-89ff-90cda72f5d63"],
 " "
}], "Subsection",
 CellChangeTimes->{{3.6719290067686377`*^9, 3.671929046666102*^9}, {
  3.671929248802558*^9, 
  3.671929278764144*^9}},ExpressionUUID->"103705a5-71ba-4d27-8c37-\
c19f82bc09af"],

Cell[TextData[{
 "The INEPT experiment consists of a string of pulses applied to the I-spins \
and the S-spins.  \n\n\t I spins: ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      RowBox[{"\[Pi]", "/", "2"}], ")"}], "y"], "-", "\[Tau]", "-", 
    SubscriptBox[
     RowBox[{"(", "\[Pi]", ")"}], "x"], "-", "\[Tau]", "-", 
    SubscriptBox[
     RowBox[{"(", 
      RowBox[{"\[Pi]", "/", "2"}], ")"}], "x"]}], TraditionalForm]],
  ExpressionUUID->"ca4e458a-f606-4610-b3a5-e4a2697eac65"],
 "\n\tS spins: ",
 Cell[BoxData[
  FormBox[
   RowBox[{"                            ", 
    RowBox[{
     SubscriptBox[
      RowBox[{"(", "\[Pi]", ")"}], "x"], "-", "\[Tau]", "-", 
     SubscriptBox[
      RowBox[{"(", 
       RowBox[{"\[Pi]", "/", "2"}], ")"}], "y"], "-", "detect"}]}], 
   TraditionalForm]],ExpressionUUID->"6c196fb8-c421-4363-8196-30c236a79d96"],
 "\n\nwith the time delay set to \[Tau] = 2\[Pi] / (4 ",
 StyleBox["J",
  FontSlant->"Italic"],
 "), with ",
 StyleBox["J",
  FontSlant->"Italic"],
 " the scalar coupling.  Now let\[CloseCurlyQuote]s calculate the usual ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["\[InvisiblePrefixScriptBase]", "13"], 
    StyleBox["C",
     FontSlant->"Plain"]}], TraditionalForm]],ExpressionUUID->
  "08664569-d6b9-45e1-b4af-5d4ee523e204"],
 " signal following the INEPT polarization-transfer sequence.  For simplicity \
we will again work on resonance where ",
 Cell[BoxData[
  RowBox[{
   FormBox[
    RowBox[{
     SubscriptBox["\[CapitalDelta]", "I"], "\[RightArrow]", "0"}],
    TraditionalForm], " "}]],ExpressionUUID->
  "6c3f2077-c763-4395-a529-73586ff1a95c"],
 "and  ",
 Cell[BoxData[
  RowBox[{
   FormBox[
    SubscriptBox["\[CapitalDelta]", "S"],
    TraditionalForm], "\[RightArrow]", "0."}]],ExpressionUUID->
  "7bf836ce-f1ac-45c5-ae7d-82ff92c3b8b3"],
 "  in the calculation below I print out the density operator at each step in \
the evolution."
}], "Text",
 CellChangeTimes->{{3.671928591928565*^9, 3.671928597076543*^9}, {
  3.6719287486694593`*^9, 3.671929005834066*^9}, {3.671929053396553*^9, 
  3.671929057388837*^9}, {3.671929101341604*^9, 3.6719291013416443`*^9}, {
  3.671929303002233*^9, 3.671929613724959*^9}},
 FontSize->18,ExpressionUUID->"77f410cd-6457-479d-a89d-945a7f887188"],

Cell[BoxData[{
 RowBox[{"\[Rho]$0", "  ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"a", " ", "Iz"}], " ", "+", " ", 
    RowBox[{"b", " ", "Sz"}]}], "//", "  ", 
   RowBox[{
    RowBox[{"PulseI", "[", 
     RowBox[{"#", ",", 
      RowBox[{"\[Pi]", "/", "2"}], ",", 
      RowBox[{"\[Pi]", "/", "2"}]}], "]"}], 
    "&"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"\[Rho]$1", " ", "=", "  ", 
  RowBox[{
   RowBox[{"FreeEvolution", "[", 
    RowBox[{"\[Rho]$0", ",", "t"}], "]"}], " ", "/.", " ", 
   RowBox[{"{", 
    RowBox[{"\[CapitalDelta]$I", "\[Rule]", " ", "0"}], 
    "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"\[Rho]$2", " ", "=", " ", 
  RowBox[{
   RowBox[{"\[Rho]$1", " ", "//", "  ", 
    RowBox[{
     RowBox[{"PulseI", "[", 
      RowBox[{"#", ",", "0", ",", "\[Pi]"}], "]"}], "&"}]}], " ", "//", "  ", 
   
   RowBox[{
    RowBox[{"PulseS", "[", 
     RowBox[{"#", ",", "0", ",", "\[Pi]"}], "]"}], " ", 
    "&"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]$3", " ", "=", " ", 
   RowBox[{
    RowBox[{"FreeEvolution", "[", 
     RowBox[{"\[Rho]$2", ",", "t"}], "]"}], " ", "/.", " ", 
    RowBox[{"{", 
     RowBox[{"\[CapitalDelta]$I", "\[Rule]", " ", "0"}], "}"}]}]}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{"\[Rho]$4", " ", "=", " ", 
  RowBox[{
   RowBox[{"\[Rho]$3", " ", "//", "  ", 
    RowBox[{
     RowBox[{"PulseI", "[", 
      RowBox[{"#", ",", "0", ",", 
       RowBox[{"\[Pi]", "/", "2"}]}], "]"}], "&"}]}], " ", "//", "  ", 
   RowBox[{
    RowBox[{"PulseS", "[", 
     RowBox[{"#", ",", 
      RowBox[{"\[Pi]", "/", "2"}], ",", 
      RowBox[{"\[Pi]", "/", "2"}]}], "]"}], " ", "&"}]}]}]}], "Input",
 CellChangeTimes->{{3.6718968880439243`*^9, 3.6718969524440727`*^9}, {
  3.671897032206025*^9, 3.671897046650464*^9}, {3.671897204722954*^9, 
  3.6718973152312098`*^9}, {3.671897447305798*^9, 3.671897494886711*^9}, {
  3.940182602521744*^9, 3.9401826349371758`*^9}},
 FontSize->16,
 CellLabel->
  "In[156]:=",ExpressionUUID->"828652eb-da86-4f80-ac2a-073b776ed52f"],

Cell[TextData[{
 "The signal in the \[OpenCurlyDoubleQuote]regular\[CloseCurlyDoubleQuote] \
experiment arose from the term \n\n\t",
 Cell[BoxData[
  RowBox[{"b", " ", "Sx", " ", 
   RowBox[{"Cos", "[", 
    FractionBox[
     RowBox[{"J", " ", "t"}], "2"], "]"}]}]],
  CellChangeTimes->{3.671927906329776*^9},
  FontSize->16,ExpressionUUID->"19b5ffe6-1d24-4b6e-90bc-2724b01efaef"],
 " \n\t\nin the density operator.  After the series of pulses in the INEPT \
experiment we now have a term in the density operator given by \n\n\t",
 Cell[BoxData[
  RowBox[{
   RowBox[{"4", " ", "a", " ", 
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{"J", " ", "t"}], "2"], "]"}], " ", "Iz", " ", "Sx", " ", 
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"J", " ", "t"}], "2"], "]"}]}], "\[RightArrow]", 
   RowBox[{"2", " ", "a", " ", "Iz", " ", "Sx"}]}]],
  CellChangeTimes->{{3.671897290448884*^9, 3.671897318647407*^9}, 
    3.6718974957149878`*^9, 3.671926274808988*^9, 3.6719263064016457`*^9, 
    3.671927462557098*^9},
  FontSize->16,ExpressionUUID->"b025d8d9-71db-4144-8a29-e2bb2abede98"]
}], "Text",
 CellChangeTimes->{{3.671929983682289*^9, 3.671930025398354*^9}, {
  3.6719300670315847`*^9, 3.671930136013072*^9}, {3.671930214310153*^9, 
  3.671930238234023*^9}, {3.9401826592942266`*^9, 3.9401826652824707`*^9}},
 FontSize->18,ExpressionUUID->"be76d91c-57c5-4c4a-87bc-ac56674d86d5"],

Cell[TextData[{
 "where the term following the arrow is what we get by setting the delay time \
to 2 \[Pi]/(4 ",
 StyleBox["J",
  FontSlant->"Italic"],
 ").    This term arose from the ",
 StyleBox["initial I-spin signal",
  FontSlant->"Italic"],
 " evolving under the spin-spin coupling to give a ",
 StyleBox["mixed I-spin & S-spin signal",
  FontSlant->"Italic"],
 ".  Further evolution under the ",
 StyleBox["J",
  FontSlant->"Italic"],
 " coupling Hamiltonian will give rise a a ",
 StyleBox["pure S-spin signal",
  FontSlant->"Italic"],
 ".    "
}], "Text",
 CellChangeTimes->{{3.671929679776863*^9, 3.671929734673861*^9}, {
  3.6719300283127527`*^9, 3.671930035311207*^9}, {3.671930125234267*^9, 
  3.671930144046606*^9}, {3.671930192463664*^9, 3.6719302063730507`*^9}, {
  3.671930242543427*^9, 3.6719304284876223`*^9}, {3.671930459396369*^9, 
  3.671930460318253*^9}},
 FontSize->18,ExpressionUUID->"ba727c88-eefd-4b17-8c70-950fabbacd4f"],

Cell[BoxData[
 RowBox[{"\[Rho]$5", " ", "=", " ", 
  RowBox[{
   RowBox[{"\[Rho]$4", "  ", "/.", " ", 
    RowBox[{"{", 
     RowBox[{"t", "\[Rule]", " ", 
      RowBox[{"2", " ", 
       RowBox[{"\[Pi]", "/", 
        RowBox[{"(", 
         RowBox[{"4", " ", "J"}], ")"}]}]}]}], "}"}]}], " ", "//", " ", 
   RowBox[{
    RowBox[{"FreeEvolution", "[", 
     RowBox[{"#", ",", "t"}], "]"}], "&"}], " "}]}]], "Input",
 CellChangeTimes->{{3.671897328718656*^9, 3.671897341318771*^9}, {
   3.671897503862351*^9, 3.671897504112216*^9}, {3.6718975870222588`*^9, 
   3.671897595144972*^9}, {3.671897800030439*^9, 3.671897802751381*^9}, 
   3.671963095423436*^9, {3.671963134468152*^9, 3.6719631376188498`*^9}, {
   3.671963209374254*^9, 3.671963226473454*^9}, {3.671963276848936*^9, 
   3.671963375084201*^9}, {3.940182677992921*^9, 3.94018267974547*^9}},
 FontSize->16,
 CellLabel->
  "In[161]:=",ExpressionUUID->"0c821184-7865-42a3-8cc4-f151e4b848f0"],

Cell[TextData[{
 "Remarkably,",
 StyleBox[" ",
  FontColor->RGBColor[1, 0.5, 0]],
 StyleBox["the ",
  FontWeight->"Bold",
  FontColor->RGBColor[1, 0.5, 0]],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["\[InvisiblePrefixScriptBase]", "13"], 
    StyleBox["C",
     FontSlant->"Plain"]}], TraditionalForm]],
  FontWeight->"Bold",
  FontColor->RGBColor[1, 0.5, 0],ExpressionUUID->
  "783309a2-1572-4cfe-b5bb-28d645c0296d"],
 StyleBox[" signal is now approximately 16x larger",
  FontWeight->"Bold",
  FontColor->RGBColor[1, 0.5, 0]],
 ".  This signal increase corresponds to a ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["16", "2"], "="}], TraditionalForm]],ExpressionUUID->
  "3577b7fa-610d-4f16-9cc7-7e3ae29584b5"],
 " 256-fold savings in signal averaging time."
}], "Text",
 CellChangeTimes->{{3.6719297393833017`*^9, 3.6719299051187763`*^9}, {
   3.6719633616707907`*^9, 3.671963362378067*^9}, 3.8599177945313463`*^9},
 FontSize->18,ExpressionUUID->"a3472138-9171-4259-ae76-c36ae6897997"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Signal", "[", "t_", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"MakeNumerical", "[", 
       RowBox[{
        RowBox[{"Tr", "[", 
         RowBox[{"\[Rho]$5", ".", 
          RowBox[{"(", 
           RowBox[{"Sx", " ", "+", " ", 
            RowBox[{"I", " ", "Sy"}]}], ")"}]}], "]"}], " ", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "t"}], "/", "T2"}], "]"}]}], "]"}], "/.", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[CapitalDelta]$I", "\[Rule]", " ", "0"}], ",", 
        RowBox[{"\[CapitalDelta]$S", "\[Rule]", " ", "0"}]}], "}"}]}], ")"}], 
    " ", "/.", " ", "HamiltonianParameters$coupled"}], " ", "/.", " ", 
   "SubstitutePrefactors"}]}]], "Input",
 CellChangeTimes->{{3.6719277375221233`*^9, 3.671927764941704*^9}, {
  3.671927937526128*^9, 3.671927942191386*^9}, {3.859917801400792*^9, 
  3.85991780886558*^9}, {3.8599188126351337`*^9, 3.859918850575992*^9}},
 FontSize->16,
 CellLabel->
  "In[162]:=",ExpressionUUID->"6e551a39-f8b9-4e9c-a42b-03dd6800cbbc"],

Cell[BoxData[
 RowBox[{"DFFT", "[", 
  RowBox[{"Signal", ",", "t$List", ",", "False"}], "]"}]], "Input",
 CellChangeTimes->{{3.671928661319326*^9, 3.671928673340681*^9}},
 FontSize->16,
 CellLabel->
  "In[163]:=",ExpressionUUID->"3a7223a5-db02-495b-98c1-04e319e043d9"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Utility functions for two-dimensional data", "Section",
 CellChangeTimes->{{3.6718794064359694`*^9, 3.671879415291848*^9}, {
  3.671880018523059*^9, 3.6718800471106577`*^9}, {3.671925764434554*^9, 
  3.6719257748967113`*^9}, {3.671930943790674*^9, 
  3.67193094526243*^9}},ExpressionUUID->"49499c2d-9b65-43cc-ac6d-\
05f50d0e2673"],

Cell[CellGroupData[{

Cell["Function to take the 2D Fourier Transform", "Subsection",
 CellChangeTimes->{{3.6719639282030687`*^9, 
  3.671963944704712*^9}},ExpressionUUID->"b83516ed-649d-425d-9238-\
52329feb88a9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DFFT2", "[", 
   RowBox[{"signal_", ",", "t1_", ",", " ", "t2_", ",", " ", 
    RowBox[{"query_", ":", "False"}]}], "]"}], " ", ":=", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"signal", " ", "=", " ", 
    RowBox[{"A", " ", 
     StyleBox["function",
      FontSlant->"Italic"], " ", "that", " ", "computes", " ", "the", " ", 
     "signal"}]}], " ", "*)"}], "\[IndentingNewLine]", " ", 
  RowBox[{"(*", "     ", 
   RowBox[{"t1", " ", "=", " ", 
    RowBox[{"A", " ", "list", " ", "of", " ", "time", " ", "points"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", " ", 
  RowBox[{"(*", "     ", 
   RowBox[{"t2", " ", "=", " ", 
    RowBox[{"A", " ", "list", " ", "of", " ", "time", " ", "points"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", " ", 
  RowBox[{"(*", "  ", 
   RowBox[{
    RowBox[{"query", " ", "=", " ", 
     RowBox[{"True", " ", "or", " ", "False"}]}], ",", " ", 
    RowBox[{
    "whether", " ", "to", " ", "print", " ", "out", " ", "diagnostic", " ", 
     "messages"}]}], " ", "*)"}], " ", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"t1$NN", ",", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "number", " ", "of", " ", "time", " ", "points", " ", "in", " ", 
         "the", " ", "indirect"}], ",", " ", 
        RowBox[{"t1", " ", "dimension"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "             ", "t2$NN", ",", "  ", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "number", " ", "of", " ", "time", " ", "points", " ", "in", " ", 
         "the", " ", "direct"}], ",", " ", 
        RowBox[{"t2", " ", "dimension"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "             ", "f1", ",", "         ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "the", " ", "frequency", " ", "axis", " ", "in", " ", "the", " ", 
        "indirect", " ", "dimension"}], " ", "*)"}], "\[IndentingNewLine]", 
      "             ", "f2"}], "             ", 
     RowBox[{"(*", " ", 
      RowBox[{
      "the", " ", "frequency", " ", "axis", " ", "in", " ", "the", " ", 
       "indirect", " ", "dimension"}], " ", "*)"}], "\[IndentingNewLine]", 
     "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"Too", " ", 
        RowBox[{"fancy", ":", " ", "signal$List"}]}], " ", "=", " ", 
       RowBox[{"Outer", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"N", "[", 
           RowBox[{"signal", "[", 
            RowBox[{"#1", ",", "#2"}], "]"}], "]"}], "&"}], ",", "t1", ",", 
         "t2"}], "]"}]}], ";"}], " ", "*)"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"t1$NN", " ", "=", " ", 
      RowBox[{
       RowBox[{"Dimensions", "[", "t1", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"t2$NN", " ", "=", " ", 
      RowBox[{
       RowBox[{"Dimensions", "[", "t2", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"signal$List", "  ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"signal", "[", 
          RowBox[{
           RowBox[{"t1", "[", 
            RowBox[{"[", "i$1", "]"}], "]"}], ",", 
           RowBox[{"t2", "[", 
            RowBox[{"[", "i$2", "]"}], "]"}]}], "]"}], " ", "//", " ", "N"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i$2", ",", "1", ",", "t2$NN"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i$1", ",", "1", ",", "t1$NN"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"query", " ", "\[Equal]", " ", "True"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Number of t1 points = \>\"", ",", "t1$NN"}], "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Number of t2 points = \>\"", ",", "t2$NN"}], "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Dimensions of signal$List = \>\"", ",", 
          RowBox[{"Dimensions", "[", "signal$List", " ", "]"}]}], "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"signal$List$FT", " ", "=", " ", 
      RowBox[{"RotateLeft", "[", 
       RowBox[{
        RowBox[{"Fourier", "[", "signal$List", " ", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"t2$NN", "/", "2"}], ",", 
          RowBox[{"t1$NN", "/", "2"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"f1", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"jj", "/", 
         RowBox[{"t1", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"jj", ",", 
          RowBox[{
           RowBox[{"-", "t1$NN"}], "/", "2"}], ",", 
          RowBox[{
           RowBox[{"t1$NN", "/", "2"}], "-", "1"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"f2", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"jj", "/", 
         RowBox[{"t2", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"jj", ",", 
          RowBox[{
           RowBox[{"-", "t2$NN"}], "/", "2"}], ",", 
          RowBox[{
           RowBox[{"t2$NN", "/", "2"}], "-", "1"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"SetOptions", "[", 
      RowBox[{"ListPlot3D", ",", "\[IndentingNewLine]", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", "\[IndentingNewLine]", 
       RowBox[{"DataRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"f1", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"f1", "[", 
             RowBox[{"[", "t1$NN", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"f2", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"f2", "[", 
             RowBox[{"[", "t2$NN", "]"}], "]"}]}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PlotLabel", "\[Rule]", "\"\<2D spectrum\\n\\n\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Mesh", "\[Rule]", "False"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"p1", "=", 
      RowBox[{"ListPlot3D", "[", 
       RowBox[{
        RowBox[{"Re", "[", "signal$List$FT", " ", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"AxesLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<f1 [Hz]\>\"", ",", "\"\<f2 [Hz]\>\"", ",", 
           "\"\<Re[FT[signal(\!\(\*SubscriptBox[\(t\), \
\(1\)]\),\!\(\*SubscriptBox[\(t\), \(2\)]\))]]\>\""}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ViewPoint", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"1.561`", ",", 
           RowBox[{"-", "2.881`"}], ",", "0.845`"}], "}"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"p2", "=", 
      RowBox[{"ListPlot3D", "[", 
       RowBox[{
        RowBox[{"Im", "[", "signal$List$FT", " ", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"AxesLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<f1 [Hz]\>\"", ",", "\"\<f2 [Hz]\>\"", ",", 
           
           "\"\<Im[FT[signal(\!\(\*SubscriptBox[\(t\), \
\(1\)]\),\!\(\*SubscriptBox[\(t\), \(2\)]\))]]\>\""}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ViewPoint", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"1.561`", ",", 
           RowBox[{"-", "2.881`"}], ",", "0.845`"}], "}"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"p3", "=", 
      RowBox[{"ListPlot3D", "[", 
       RowBox[{
        RowBox[{"Abs", "[", "signal$List$FT", " ", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"AxesLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<f1 [Hz]\>\"", ",", "\"\<f2 [Hz]\>\"", ",", 
           "\"\<Abs[FT[signal(\!\(\*SubscriptBox[\(t\), \
\(1\)]\),\!\(\*SubscriptBox[\(t\), \(2\)]\))]]\>\""}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ViewPoint", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"1.561`", ",", 
           RowBox[{"-", "2.881`"}], ",", "0.845`"}], "}"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{"p1", ",", "p2", ",", "p3"}], "}"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.67193290920819*^9, 3.6719330377265368`*^9}, {
   3.671933142753436*^9, 3.671933162376494*^9}, {3.6719333041758547`*^9, 
   3.6719333080361967`*^9}, {3.6719333479495993`*^9, 3.671933365500202*^9}, {
   3.671933400528564*^9, 3.6719335352625093`*^9}, {3.671933581091715*^9, 
   3.671933602951006*^9}, {3.671933731987199*^9, 3.671933788458231*^9}, {
   3.6719338474435177`*^9, 3.671933864022208*^9}, {3.671934014299584*^9, 
   3.671934200366333*^9}, {3.671934265028734*^9, 3.671934270339427*^9}, {
   3.6719343010252123`*^9, 3.67193430320455*^9}, {3.671959590875065*^9, 
   3.671959598587652*^9}, {3.671959804931814*^9, 3.6719599764517*^9}, {
   3.671960018737183*^9, 3.67196008004738*^9}, 3.671960273199786*^9, {
   3.671960321213346*^9, 3.6719603709863653`*^9}, 3.67196042847437*^9, {
   3.6719604955694523`*^9, 3.671960498458959*^9}, {3.671960536231584*^9, 
   3.671960539830352*^9}, {3.671961011715127*^9, 3.6719610159290247`*^9}, {
   3.671962015017626*^9, 3.671962023511508*^9}, {3.6719627029769278`*^9, 
   3.671962742127977*^9}, {3.671964563929368*^9, 3.6719645721762667`*^9}, {
   3.6719646033103333`*^9, 3.671964611915827*^9}, {3.67196470667852*^9, 
   3.671964728583891*^9}, {3.671964767280039*^9, 3.671964795968655*^9}, {
   3.671964850957272*^9, 3.671965099947947*^9}},
 FontSize->16,
 CellLabel->
  "In[164]:=",ExpressionUUID->"61e2fa25-0a40-480f-b751-e2ccf7a044ba"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Test case #1", "Subsection",
 CellChangeTimes->{{3.671963950365428*^9, 3.6719639568018723`*^9}, {
  3.671965345676228*^9, 
  3.671965351356316*^9}},ExpressionUUID->"27c7108b-75ae-4c50-8079-\
a64b058e4efc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"t1$List", "=", " ", 
   RowBox[{"TimeArray", "[", 
    RowBox[{
     RowBox[{"2", "^", "6"}], ",", "0.25"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t2$List", "=", " ", 
   RowBox[{"TimeArray", "[", 
    RowBox[{
     RowBox[{"2", "^", "7"}], ",", "0.50"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.671964302001038*^9, 3.67196431130612*^9}, {
  3.671964388838485*^9, 3.671964389310945*^9}, {3.671965118720688*^9, 
  3.671965120125567*^9}, {3.671965246291473*^9, 3.671965246683483*^9}},
 FontSize->16,
 CellLabel->
  "In[165]:=",ExpressionUUID->"78617ef5-836d-45a7-ae6f-cbaeb96a4783"],

Cell[BoxData[{
 RowBox[{"t1$List", "  ", "//", " ", 
  "TimeArrayReport"}], "\[IndentingNewLine]", 
 RowBox[{"t2$List", "  ", "//", " ", "TimeArrayReport"}]}], "Input",
 FontSize->16,
 CellLabel->
  "In[167]:=",ExpressionUUID->"033eca70-ca05-437e-a9c9-39f84175c6c4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Signal2D", "[", 
    RowBox[{"t1_", ",", "t2_"}], "]"}], " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", "2", " ", "\[Pi]", " ", "100", " ", "t1"}], 
      "]"}], "  ", 
     RowBox[{"Exp", "[", 
      RowBox[{"I", " ", "2", " ", "\[Pi]", " ", "50", " ", "t2"}], "]"}], " ", 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", "t1"}], "/", "0.08"}], " ", "]"}], " ", 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", "t2"}], "/", "0.15"}], "]"}]}], " ", "+", " ", "0.05"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"p1", ",", "p2", ",", "p3"}], "}"}], " ", "=", " ", 
    RowBox[{"DFFT2", "[", 
     RowBox[{"Signal2D", ",", "t1$List", ",", "t2$List", ",", " ", "True"}], 
     "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", "p3"}], "Input",
 CellChangeTimes->{{3.671963999366246*^9, 3.6719640344474707`*^9}, {
   3.6719640677091312`*^9, 3.671964185961536*^9}, {3.6719642177147837`*^9, 
   3.671964247057164*^9}, {3.671964400643404*^9, 3.671964404849866*^9}, 
   3.6719644407232723`*^9, {3.671964635376355*^9, 3.671964639130764*^9}, {
   3.6719651603045177`*^9, 3.671965236765723*^9}, {3.67196528052987*^9, 
   3.6719652895975027`*^9}, 3.6719653341987143`*^9, {3.671965380029688*^9, 
   3.671965455271617*^9}, {3.671965593957251*^9, 3.6719655946398697`*^9}},
 FontSize->16,
 CellLabel->
  "In[169]:=",ExpressionUUID->"0c2741f3-2e8a-4b0c-8fc5-dec9c038414c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Test Case #2", "Subsection",
 CellChangeTimes->{{3.671965356378434*^9, 
  3.6719653613619003`*^9}},ExpressionUUID->"7ae16528-256b-4b43-96e5-\
e6f875601c5f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"t1$List", "=", " ", 
   RowBox[{"TimeArray", "[", 
    RowBox[{
     RowBox[{"2", "^", "9"}], ",", "0.25"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t2$List", "=", " ", 
    RowBox[{"TimeArray", "[", 
     RowBox[{
      RowBox[{"2", "^", "6"}], ",", "0.50"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"t1$List", "  ", "//", " ", 
  "TimeArrayReport"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t2$List", "  ", "//", " ", "TimeArrayReport"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Signal2D", "[", 
    RowBox[{"t1_", ",", "t2_"}], "]"}], " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", "2", " ", "\[Pi]", "  ", "300", " ", "t1"}], 
      "]"}], "  ", 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", "2", " ", "\[Pi]", "  ", "30", " ", "t2"}], 
      "]"}], " ", 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", "t1"}], "/", "0.05"}], " ", "]"}], " ", 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", "t2"}], "/", "0.10"}], "]"}]}], " ", "+", " ", "0.05"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"p1", ",", "p2", ",", "p3"}], "}"}], " ", "=", " ", 
    RowBox[{"DFFT2", "[", 
     RowBox[{"Signal2D", ",", "t1$List", ",", "t2$List", ",", " ", "True"}], 
     "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", "p3"}], "Input",
 CellChangeTimes->{{3.671963999366246*^9, 3.6719640344474707`*^9}, {
   3.6719640677091312`*^9, 3.671964185961536*^9}, {3.6719642177147837`*^9, 
   3.671964247057164*^9}, {3.671964400643404*^9, 3.671964404849866*^9}, 
   3.6719644407232723`*^9, {3.671964635376355*^9, 3.671964639130764*^9}, {
   3.6719651603045177`*^9, 3.671965236765723*^9}, {3.67196528052987*^9, 
   3.671965331690147*^9}, {3.671965498611329*^9, 3.671965537537755*^9}, {
   3.671965569428731*^9, 3.6719655820492573`*^9}, {3.67196563709977*^9, 
   3.6719656758534822`*^9}},
 FontSize->16,
 CellLabel->
  "In[172]:=",ExpressionUUID->"e9f8d583-b0dd-4897-968e-51d1bd850a37"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Heteronuclear COSY signal", "Section",
 CellChangeTimes->{{3.6718800638033447`*^9, 3.671880072138873*^9}, {
   3.671930934282226*^9, 3.671930938702942*^9}, 3.671968604647366*^9},
 FontSize->24,ExpressionUUID->"c255b162-baca-4759-8769-535797648e03"],

Cell["This is the signal that we worked out in class", "Text",
 CellChangeTimes->{{3.671968609825365*^9, 3.671968618588675*^9}},
 FontSize->18,ExpressionUUID->"6e2d5704-ea21-4959-9168-82465d6b34f5"],

Cell[CellGroupData[{

Cell["Set the couplings and number of points", "Subsection",
 CellChangeTimes->{{3.671961125575214*^9, 
  3.671961141177919*^9}},ExpressionUUID->"150f014b-bca7-4cfd-8b7f-\
5f78818f70b7"],

Cell["Edit the chemical shifts and the J-couplings here", "Text",
 FontSize->18,
 Background->RGBColor[
  1, 1, 0],ExpressionUUID->"ce7eef04-b03d-44b3-be4a-a5fa1dd68fd9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "HamiltonianParameters$coupled", " ", "=", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[CapitalDelta]$I", "\[Rule]", " ", 
      RowBox[{"2", "\[Pi]", " ", "*", " ", "100"}]}], ",", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"I", "-", 
       RowBox[{"spin", " ", "chemical", " ", 
        RowBox[{"shift", " ", "[", "radians", "]"}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"\[CapitalDelta]$S", " ", "\[Rule]", " ", 
      RowBox[{"2", "\[Pi]", " ", "*", "150"}]}], ",", "  ", 
     RowBox[{"(*", " ", 
      RowBox[{"S", "-", 
       RowBox[{"spin", " ", "chemical", " ", 
        RowBox[{"shift", " ", "[", "radians", "]"}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"J", " ", "\[Rule]", 
      RowBox[{"2", "\[Pi]", " ", "*", " ", "40"}]}], ",", "        ", 
     RowBox[{"(*", " ", 
      RowBox[{"scalar", " ", 
       RowBox[{"coupling", " ", "[", "radians", "]"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"T2", " ", "->", " ", "0.10"}]}], "             ", 
    RowBox[{"(*", " ", 
     RowBox[{"spin", " ", "dephasing", " ", 
      RowBox[{"time", " ", "[", "s", "]"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", " ", "}"}]}], ";"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQA2IQfeLqsoTe6NeOHnHpiSD6kUMgx2QgvSGvHkyHndBa
MwVIb7p1ai2IvrWaYzuIfp2kBqa/nj6wH0Qv6Ws4CKIThLSWLQHS00osVoLo
N9+mbAfRMnPmgWm7S3XHQLT7fOarIJpnabjESiA960yQFIj+UfN1z1Yg7amn
vBdEb3offQVEf7vaA6aTt528B6KFDp8H06saj38E0aFZep9A9DP35VbbgPSO
IlZbEL0ntakaRGvfFasB0aunHOfcAaSjl10F09t2SfmC6Oaq3f4g+oSDTjiI
1uKuiQHRz15OTATzdRaBaWWhl247gfSVeeLuIPq39zRfEP3PeReY3rDw8FMQ
rRD6HkwDAEi/vzU=
  "],
 FontSize->16,
 Background->GrayLevel[0.900008],
 CellLabel->
  "In[179]:=",ExpressionUUID->"29d2219a-d833-4de5-8ad3-16c4d8b5927d"],

Cell["Edit the number of points at the total acquisition time here", "Text",
 CellChangeTimes->{{3.671935003456821*^9, 3.671935014639059*^9}},
 FontSize->18,
 Background->RGBColor[
  1, 1, 0],ExpressionUUID->"c017c2c8-71ae-4b36-9e95-b100b4dbf118"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"t1$List", "=", " ", 
   RowBox[{"TimeArray", "[", 
    RowBox[{
     RowBox[{"2", "^", "7"}], ",", "0.25"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t2$List", "=", " ", 
   RowBox[{"TimeArray", "[", 
    RowBox[{
     RowBox[{"2", "^", "7"}], ",", "0.25"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.671932531775362*^9, 3.671932558418375*^9}, {
   3.671932615125964*^9, 3.671932624373652*^9}, 3.671933087559319*^9, {
   3.6719335444862022`*^9, 3.6719335494129143`*^9}, {3.6719336086423903`*^9, 
   3.671933610588026*^9}, {3.6719336478538837`*^9, 3.671933650406972*^9}, {
   3.6719336917141457`*^9, 3.671933693399531*^9}, {3.6719338845339003`*^9, 
   3.671933885891416*^9}, {3.6719343541751137`*^9, 3.671934355746716*^9}, {
   3.671934409104306*^9, 3.671934415234016*^9}, {3.671934459376684*^9, 
   3.671934491924694*^9}, {3.671934532996088*^9, 3.671934543210248*^9}, {
   3.671934774264757*^9, 3.6719347827671223`*^9}, {3.671960216255967*^9, 
   3.671960234716063*^9}, {3.671960441836606*^9, 3.671960442409441*^9}, {
   3.67196127955404*^9, 3.67196131850441*^9}, {3.67196642584122*^9, 
   3.671966426356633*^9}, {3.671969585303156*^9, 3.6719695911194887`*^9}},
 FontSize->16,
 Background->GrayLevel[0.85],
 CellLabel->
  "In[180]:=",ExpressionUUID->"347b339f-b04d-45fa-a698-f9fd046246b1"],

Cell["\<\
Make a copy of the parameters with the scalar coupling set to zero, e.g., \
with the two spins uncoupled.  Useful for testing.\
\>", "Text",
 CellChangeTimes->{{3.671926459357728*^9, 3.671926507429882*^9}},
 FontSize->18,ExpressionUUID->"66f87942-ff8e-4199-bba3-648c6e97eddf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "HamiltonianParameters$uncoupled", " ", "=", " ", 
   "HamiltonianParameters$coupled"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HamiltonianParameters$uncoupled", "[", 
    RowBox[{"[", "3", "]"}], "]"}], "  ", "=", " ", 
   RowBox[{"J", "\[Rule]", " ", "0"}]}], ";"}]}], "Input",
 FontSize->18,
 CellLabel->
  "In[182]:=",ExpressionUUID->"7390ff1f-80b1-4565-b7c6-ce8740310e8f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Some checks", "Subsection",
 CellChangeTimes->{{3.671961163155218*^9, 
  3.671961173753989*^9}},ExpressionUUID->"23ba2ddb-5424-40d4-a824-\
d03e90c4fca1"],

Cell["Check out the Nyquist frequencies", "Text",
 CellChangeTimes->{{3.671959676120822*^9, 3.671959692378523*^9}},
 FontSize->16,ExpressionUUID->"5c82b619-1fee-4519-a476-445a871dd7ec"],

Cell[BoxData[{
 RowBox[{"t1$List", "  ", "//", " ", 
  "TimeArrayReport"}], "\[IndentingNewLine]", 
 RowBox[{"t2$List", "  ", "//", " ", "TimeArrayReport"}]}], "Input",
 CellChangeTimes->{{3.671959650984557*^9, 3.671959663832185*^9}},
 FontSize->16,
 CellLabel->
  "In[184]:=",ExpressionUUID->"9dfbee51-a5c1-46d7-a564-c28e135c2ee1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Evolve the density operator", "Subsection",
 CellChangeTimes->{{3.671961177397146*^9, 
  3.671961192586527*^9}},ExpressionUUID->"eebd7438-fc40-491f-adf4-\
948216c79c4d"],

Cell["Compute evolution.  This computation takes many seconds.", "Text",
 CellChangeTimes->{{3.671935019629524*^9, 3.671935034174068*^9}, {
  3.6719605645133953`*^9, 3.6719605705526447`*^9}, {3.8599190255181913`*^9, 
  3.859919026720477*^9}},
 FontSize->18,ExpressionUUID->"401dfce8-b573-4072-8ae7-49861d43c5a6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]$0", " ", "=", " ", 
    RowBox[{"Iz", "+", " ", "Sz"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Initial", " ", 
    RowBox[{"(", 
     RowBox[{"\[Pi]", "/", "2"}], ")"}], "y", " ", "pulse"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"\[Rho]$1$A", " ", "=", " ", 
  RowBox[{
   RowBox[{"\[Rho]$0", " ", "//", " ", 
    RowBox[{
     RowBox[{"PulseS", "[", 
      RowBox[{"#", ",", 
       RowBox[{"\[Pi]", "/", "2"}], ",", 
       RowBox[{"\[Pi]", "/", "2"}]}], "]"}], "&"}]}], "  ", "//", " ", 
   "Expand"}]}], "\[IndentingNewLine]", 
 RowBox[{"\[Rho]$2$A", " ", "=", " ", 
  RowBox[{
   RowBox[{"FreeEvolution", "[", 
    RowBox[{"\[Rho]$1$A", ",", "t1"}], "]"}], " ", "//", " ", 
   "Expand"}]}], "\[IndentingNewLine]", 
 RowBox[{"\[Rho]$3$A", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Rho]$2$A", "  ", "//", " ", 
     RowBox[{
      RowBox[{"PulseS", "[", 
       RowBox[{"#", ",", 
        RowBox[{"\[Pi]", "/", "2"}], ",", 
        RowBox[{"\[Pi]", "/", "2"}]}], "]"}], "&"}]}], " ", "//", " ", 
    RowBox[{
     RowBox[{"PulseI", "[", 
      RowBox[{"#", ",", 
       RowBox[{"\[Pi]", "/", "2"}], ",", 
       RowBox[{"\[Pi]", "/", "2"}]}], "]"}], "&"}]}], "  ", "//", " ", 
   "Expand"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]$4$A", " ", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"FreeEvolution", "[", " ", 
      RowBox[{"\[Rho]$3$A", " ", ",", "t2"}], "]"}], " ", "/.", " ", 
     RowBox[{"Mult", "->", " ", "SortedMult"}]}], " ", "//", " ", 
    "Expand"}]}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"/.", " ", 
    RowBox[{"Mult", " ", "->", " ", "MultSort"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Initial", " ", 
    RowBox[{"(", 
     RowBox[{"\[Pi]", "/", "2"}], ")"}], "x", " ", "pulse"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"\[Rho]$1$B", " ", "=", " ", 
  RowBox[{"\[Rho]$0", " ", "//", " ", 
   RowBox[{
    RowBox[{"PulseS", "[", 
     RowBox[{"#", ",", "0", ",", 
      RowBox[{"\[Pi]", "/", "2"}]}], "]"}], 
    "&"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]$2$B", " ", "=", 
   RowBox[{"FreeEvolution", "[", 
    RowBox[{"\[Rho]$1$B", ",", "t1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"\[Rho]$3$B", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Rho]$2$B", "  ", "//", " ", 
     RowBox[{
      RowBox[{"PulseS", "[", 
       RowBox[{"#", ",", 
        RowBox[{"\[Pi]", "/", "2"}], ",", 
        RowBox[{"\[Pi]", "/", "2"}]}], "]"}], "&"}]}], " ", "//", " ", 
    RowBox[{
     RowBox[{"PulseI", "[", 
      RowBox[{"#", ",", 
       RowBox[{"\[Pi]", "/", "2"}], ",", 
       RowBox[{"\[Pi]", "/", "2"}]}], "]"}], "&"}]}], "//", " ", 
   "Expand"}]}], "\[IndentingNewLine]", 
 RowBox[{"\[Rho]$4$B", " ", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"FreeEvolution", "[", 
     RowBox[{"\[Rho]$3$B", ",", "t2"}], "]"}], " ", "/.", " ", 
    RowBox[{"Mult", "->", " ", "SortedMult"}]}], "//", " ", "Expand", " ", 
   RowBox[{"(*", " ", 
    RowBox[{"/.", " ", 
     RowBox[{"Mult", " ", "->", " ", "MultSort"}]}], " ", 
    "*)"}]}]}]}], "Input",
 CellChangeTimes->{{3.671880359452848*^9, 3.671880405654752*^9}, 
   3.6718805922056723`*^9, {3.671880654857966*^9, 3.671880658456214*^9}, {
   3.671890253281252*^9, 3.671890258732644*^9}, {3.671890514052863*^9, 
   3.671890531652615*^9}, {3.6718938201845903`*^9, 3.6718938368617887`*^9}, {
   3.671930954705418*^9, 3.671931017275107*^9}, 3.671931151058281*^9, {
   3.671934630648226*^9, 3.671934631703808*^9}, {3.671934668462163*^9, 
   3.671934668773761*^9}, {3.6719605559094963`*^9, 3.671960557480361*^9}, {
   3.671960621069422*^9, 3.671960621963992*^9}, {3.6719606859333878`*^9, 
   3.671960725034295*^9}, {3.671960833371766*^9, 3.671960835934683*^9}, {
   3.671960886232214*^9, 3.671960907062376*^9}, 3.6719609456733513`*^9, {
   3.671961074334423*^9, 3.671961080525428*^9}, {3.6719622809344807`*^9, 
   3.6719622908226767`*^9}, {3.6719624324839697`*^9, 3.671962441605382*^9}, {
   3.67196292873599*^9, 3.6719629321760273`*^9}, {3.67196299885725*^9, 
   3.671963002474958*^9}, {3.671963410249606*^9, 3.671963434808103*^9}, {
   3.67196348159336*^9, 3.6719634969874287`*^9}, {3.671963786339136*^9, 
   3.671963786485096*^9}, {3.6719659113954678`*^9, 3.671966018770185*^9}, {
   3.671966147940074*^9, 3.671966150638332*^9}, {3.671966243701359*^9, 
   3.6719662661919518`*^9}, {3.6719665328095007`*^9, 3.67196656405721*^9}, {
   3.6719670380983047`*^9, 3.67196704626505*^9}, {3.671967523270999*^9, 
   3.671967526955697*^9}, {3.671968168673579*^9, 3.671968191966599*^9}, 
   3.859919592884658*^9, {3.940182726114287*^9, 3.940182802554015*^9}, {
   3.9401832053998938`*^9, 3.940183211841436*^9}, {3.9401832544219093`*^9, 
   3.9401833374702187`*^9}, {3.94018339028294*^9, 3.940183393606812*^9}},
 FontSize->16,
 CellLabel->
  "In[224]:=",ExpressionUUID->"b746eae8-5060-4ae3-97e3-c890a9b3daa5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Examine the two signals and combine them", "Subsection",
 CellChangeTimes->{{3.671968201171743*^9, 
  3.67196821820794*^9}},ExpressionUUID->"dd42c2dd-c64d-4e94-82d3-\
710e7dc79676"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeNumerical", "[", 
   RowBox[{"Tr", "[", 
    RowBox[{"Mult", "[", 
     RowBox[{"\[Rho]$4$A", ",", 
      RowBox[{"(", 
       RowBox[{"Ix", " ", "+", " ", 
        RowBox[{"I", " ", "Iy"}]}], ")"}]}], "]"}], "]"}], "]"}], " ", "//", 
  " ", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.671966565437508*^9, 3.671966742743554*^9}, {
  3.671967437765218*^9, 3.67196743891486*^9}, {3.671967807199925*^9, 
  3.671967807702455*^9}, {3.671967845292038*^9, 3.6719678458043613`*^9}, {
  3.859917984536048*^9, 3.8599179852682867`*^9}, {3.859918020212603*^9, 
  3.859918025406423*^9}, {3.859918931028171*^9, 3.8599189478689737`*^9}, {
  3.859919131270381*^9, 3.859919131876505*^9}, {3.940182806795794*^9, 
  3.9401828130742207`*^9}},
 FontSize->16,
 CellLabel->
  "In[233]:=",ExpressionUUID->"692ba318-e1a3-4fad-aaec-bb8b5b70b8fd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeNumerical", "[", 
   RowBox[{"Tr", "[", 
    RowBox[{"Mult", "[", 
     RowBox[{"\[Rho]$4$B", ",", 
      RowBox[{"(", 
       RowBox[{"Ix", " ", "+", " ", 
        RowBox[{"I", " ", "Iy"}]}], ")"}]}], "]"}], "]"}], "]"}], "//", "  ", 
  "FullSimplify", "  "}]], "Input",
 CellChangeTimes->{{3.671966786581603*^9, 3.671966786801403*^9}, 
   3.6719674296774*^9, {3.6719678097780857`*^9, 3.671967809981552*^9}, {
   3.671967848651556*^9, 3.671967849761945*^9}, {3.8599179891029863`*^9, 
   3.859917989789515*^9}, {3.859918027863162*^9, 3.859918034935705*^9}, {
   3.859918961348736*^9, 3.859918977872395*^9}, {3.859919122180114*^9, 
   3.859919123699275*^9}, {3.940182815750094*^9, 3.940182821194612*^9}},
 FontSize->16,
 CellLabel->
  "In[234]:=",ExpressionUUID->"66364344-f365-48a9-aa85-4282de1ddccb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Rho]$4", " ", "=", " ", 
   RowBox[{"\[Rho]$4$A", " ", "+", " ", "\[Rho]$4$B"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeNumerical", "[", 
    RowBox[{"Tr", "[", 
     RowBox[{"Mult", "[", 
      RowBox[{"\[Rho]$4", ",", 
       RowBox[{"(", 
        RowBox[{"Ix", " ", "+", " ", 
         RowBox[{"I", " ", "Iy"}]}], ")"}]}], "]"}], "]"}], "]"}], "  ", "//",
    " ", "FullSimplify"}], " ", "//", " ", "Expand"}]}], "Input",
 CellChangeTimes->{{3.671966853423469*^9, 3.671966980704862*^9}, {
  3.671968224737483*^9, 3.6719682320550337`*^9}, {3.859918047681643*^9, 
  3.859918055368401*^9}, {3.859918999778221*^9, 3.859919013512907*^9}, {
  3.859919095031994*^9, 3.859919105566741*^9}, {3.8599195789741507`*^9, 
  3.859919602418497*^9}, {3.940182824493452*^9, 3.9401828291378803`*^9}},
 FontSize->16,
 CellLabel->
  "In[235]:=",ExpressionUUID->"75b77280-5765-4689-8f3e-6968bfdf2d98"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute the signal and apply the 2D FT", "Subsection",
 CellChangeTimes->{{3.671961195103389*^9, 
  3.671961211402051*^9}},ExpressionUUID->"d90484d5-80fb-4302-b1ac-\
6deca0852648"],

Cell["This computation should just take a few seconds.", "Text",
 CellChangeTimes->{{3.859919482441927*^9, 3.859919495184896*^9}, {
  3.85991964198284*^9, 3.85991964784437*^9}},
 FontSize->18,ExpressionUUID->"a41bd966-8e6e-4384-b628-c16a5cb93b29"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Signal2D", "[", 
    RowBox[{"t1_", ",", "t2_"}], "]"}], " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"MakeNumerical", "[", 
          RowBox[{"Tr", "[", 
           RowBox[{"Mult", "[", 
            RowBox[{"\[Rho]$4", ",", 
             RowBox[{"(", 
              RowBox[{"Ix", " ", "+", " ", 
               RowBox[{"I", " ", "Iy"}]}], ")"}]}], "]"}], "]"}], "]"}], " ", 
         
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "t1"}], "/", "T2"}], "]"}], " ", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "t2"}], "/", "T2"}], "]"}]}], " ", "+", "0.025"}], 
       ")"}], " ", "/.", " ", "\[IndentingNewLine]", 
      "HamiltonianParameters$coupled"}], " ", "//", " ", "Simplify"}], " ", "//",
     " ", "N"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6719618553997602`*^9, 3.671961858187746*^9}, {
  3.671961957632979*^9, 3.671961968850966*^9}, {3.671962139492156*^9, 
  3.6719621396800413`*^9}, {3.6719635232842913`*^9, 3.671963533673254*^9}, {
  3.671963790457479*^9, 3.671963799378996*^9}, {3.6719657459183607`*^9, 
  3.671965746041649*^9}, {3.671965813218071*^9, 3.671965834051178*^9}, {
  3.6719697122958813`*^9, 3.671969713353312*^9}, {3.671970916017273*^9, 
  3.67197092928715*^9}, {3.8599180644379683`*^9, 3.859918082674698*^9}, {
  3.859919146720435*^9, 3.859919164176816*^9}, {3.8599194481226387`*^9, 
  3.859919458459009*^9}, {3.940182834270021*^9, 3.940182842795121*^9}},
 FontSize->16,
 CellLabel->
  "In[237]:=",ExpressionUUID->"14b6f368-4a45-406d-9c77-917af8e7cebe"],

Cell["Fourier transform the signal.   This takes a minute or so.", "Text",
 CellChangeTimes->{{3.671935044258762*^9, 3.6719350524686747`*^9}, {
  3.671960577588045*^9, 3.6719605998631897`*^9}, {3.671960645960691*^9, 
  3.6719606557175407`*^9}, {3.671963564552681*^9, 3.671963573311535*^9}},
 FontSize->18,ExpressionUUID->"6e492b73-416d-48dc-8645-d1a1d9667ae0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"p1", ",", "p2", ",", "p3"}], "}"}], " ", "=", " ", 
   RowBox[{"DFFT2", "[", 
    RowBox[{"Signal2D", ",", "t1$List", ",", "t2$List"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.671881660314452*^9, 3.671881683505583*^9}, {
   3.671881715652314*^9, 3.671881723794434*^9}, {3.6718901308991117`*^9, 
   3.671890140126958*^9}, {3.67189019665511*^9, 3.671890196829525*^9}, {
   3.671892971354268*^9, 3.6718929714678288`*^9}, {3.671893026070917*^9, 
   3.6718930261749077`*^9}, 3.671932589687904*^9, 3.671934659488551*^9, {
   3.671934731891508*^9, 3.671934732059461*^9}, {3.671935155580461*^9, 
   3.671935158165567*^9}, {3.671960115925538*^9, 3.6719601445045347`*^9}, {
   3.671960183219754*^9, 3.671960207693185*^9}, {3.671960293139372*^9, 
   3.671960298605274*^9}, {3.671960405949394*^9, 3.671960409397332*^9}, {
   3.671960615957674*^9, 3.671960718647657*^9}, {3.671962184757069*^9, 
   3.671962225500497*^9}},
 FontSize->16,
 CellLabel->
  "In[238]:=",ExpressionUUID->"c7fb10e7-8ae9-4d99-9d35-2dc49f630ad8"],

Cell[BoxData[{"p1", "\[IndentingNewLine]", "p3"}], "Input",
 CellChangeTimes->{{3.671962500316848*^9, 3.6719625005187073`*^9}, {
  3.671965857173787*^9, 3.671965878944346*^9}, {3.671966185507186*^9, 
  3.6719661952099857`*^9}, {3.671966284602901*^9, 3.6719662849153223`*^9}, {
  3.6719680746628847`*^9, 3.6719680749207172`*^9}, {3.671968246334671*^9, 
  3.671968246554215*^9}, {3.671968287970796*^9, 3.6719682893213367`*^9}},
 FontSize->16,
 CellLabel->
  "In[239]:=",ExpressionUUID->"97549c28-c1a2-43f6-a33b-635548c74581"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Homonuclear COSY signal", "Section",
 CellChangeTimes->{{3.6718800638033447`*^9, 3.671880072138873*^9}, {
   3.671930934282226*^9, 3.671930938702942*^9}, 3.671968604647366*^9, {
   3.671968817454822*^9, 3.671968818712557*^9}},
 FontSize->24,ExpressionUUID->"eaf952ed-5ee4-4484-98d8-16a977e1c8bd"],

Cell[TextData[{
 "This is the signal you get if you pulse and detect ",
 StyleBox["both",
  FontSlant->"Italic"],
 " nuclei at the same time."
}], "Text",
 CellChangeTimes->{{3.671968609825365*^9, 3.671968618588675*^9}, {
  3.671968832325036*^9, 3.67196885962831*^9}, {3.671969388538517*^9, 
  3.671969390079811*^9}},
 FontSize->18,ExpressionUUID->"3f16a6a4-6ba6-4bab-8e6f-e71252eab1b7"],

Cell[CellGroupData[{

Cell["Set the couplings and number of points", "Subsection",
 CellChangeTimes->{{3.671961125575214*^9, 
  3.671961141177919*^9}},ExpressionUUID->"8d595bbb-b9d9-4391-ac8e-\
08b01e3aa90f"],

Cell["Edit the chemical shifts and the J-couplings here", "Text",
 FontSize->18,
 Background->RGBColor[
  1, 1, 0],ExpressionUUID->"359299cf-1469-4c2d-88b9-9f77ee372239"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "HamiltonianParameters$coupled", " ", "=", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[CapitalDelta]$I", "\[Rule]", " ", 
      RowBox[{"2", "\[Pi]", " ", "*", " ", "50"}]}], ",", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"I", "-", 
       RowBox[{"spin", " ", "chemical", " ", 
        RowBox[{"shift", " ", "[", "radians", "]"}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"\[CapitalDelta]$S", " ", "\[Rule]", " ", 
      RowBox[{"2", "\[Pi]", " ", "*", "150"}]}], ",", "  ", 
     RowBox[{"(*", " ", 
      RowBox[{"S", "-", 
       RowBox[{"spin", " ", "chemical", " ", 
        RowBox[{"shift", " ", "[", "radians", "]"}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"J", " ", "\[Rule]", 
      RowBox[{"2", "\[Pi]", " ", "*", " ", "23"}]}], ",", "        ", 
     RowBox[{"(*", " ", 
      RowBox[{"scalar", " ", 
       RowBox[{"coupling", " ", "[", "radians", "]"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"T2", " ", "->", " ", "0.10"}]}], "              ", 
    RowBox[{"(*", " ", 
     RowBox[{"spin", " ", "dephasing", " ", 
      RowBox[{"time", " ", "[", "s", "]"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", " ", "}"}]}], ";"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAGIQfeLqsoTe6NeOHnHpiSD6kUMgx2QgvSGvHkyHndBa
MwVIb7p1ai2IvrWaYzuIfp2kBqa/nj6wH0Qv6Ws4CKIThLSWLQHS00osVoLo
N9+mbAfRMnPmgWm7S3XHQLT7fOarIJpnabjESiA960yQFIj+UfN1z1Yg7amn
vBdEb3offQVEf7vaA6aTt528B6KFDp8H06saj38E0aFZep9A9DP35VbbgPSO
IlZbEL0ntakaRGvfFasB0aunHOfcAaSjl10F09t2SfmC6Oaq3f4g+oSDTjiI
1uKuiQHRz15OTATzdRaBaWWhl247gfSVeeLuIPq39zRfEP3PeReYTjfneQii
970RAtMBj/6L7ALSJTWnxUD04lu96iC6q+wdmAYAITnPfQ==
  "],
 FontSize->14,
 Background->GrayLevel[0.900008],
 CellLabel->
  "In[241]:=",ExpressionUUID->"a2cf4809-5418-419b-b3d5-bc1cb2d018da"],

Cell["Edit the number of points at the total acquisition time here", "Text",
 CellChangeTimes->{{3.671935003456821*^9, 3.671935014639059*^9}},
 FontSize->18,
 Background->RGBColor[
  1, 1, 0],ExpressionUUID->"3a549e4d-2582-406a-89cf-5a2387306610"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"t1$List", "=", " ", 
   RowBox[{"TimeArray", "[", 
    RowBox[{
     RowBox[{"2", "^", "7"}], ",", "0.25"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t2$List", "=", " ", 
   RowBox[{"TimeArray", "[", 
    RowBox[{
     RowBox[{"2", "^", "7"}], ",", "0.25"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.671932531775362*^9, 3.671932558418375*^9}, {
   3.671932615125964*^9, 3.671932624373652*^9}, 3.671933087559319*^9, {
   3.6719335444862022`*^9, 3.6719335494129143`*^9}, {3.6719336086423903`*^9, 
   3.671933610588026*^9}, {3.6719336478538837`*^9, 3.671933650406972*^9}, {
   3.6719336917141457`*^9, 3.671933693399531*^9}, {3.6719338845339003`*^9, 
   3.671933885891416*^9}, {3.6719343541751137`*^9, 3.671934355746716*^9}, {
   3.671934409104306*^9, 3.671934415234016*^9}, {3.671934459376684*^9, 
   3.671934491924694*^9}, {3.671934532996088*^9, 3.671934543210248*^9}, {
   3.671934774264757*^9, 3.6719347827671223`*^9}, {3.671960216255967*^9, 
   3.671960234716063*^9}, {3.671960441836606*^9, 3.671960442409441*^9}, {
   3.67196127955404*^9, 3.67196131850441*^9}, {3.67196642584122*^9, 
   3.671966426356633*^9}, {3.671969537559432*^9, 3.671969542240697*^9}},
 FontSize->14,
 Background->GrayLevel[0.85],
 CellLabel->
  "In[244]:=",ExpressionUUID->"1c643bbb-70d6-4488-b8fc-6e9778a73bf6"],

Cell["\<\
Make a copy of the parameters with the scalar coupling set to zero, e.g., \
with the two spins uncoupled.  Useful for testing.\
\>", "Text",
 CellChangeTimes->{{3.671926459357728*^9, 3.671926507429882*^9}},
 FontSize->18,ExpressionUUID->"f1bf3607-1fbe-46f1-8e92-70489bea5e42"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "HamiltonianParameters$uncoupled", " ", "=", " ", 
   "HamiltonianParameters$coupled"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HamiltonianParameters$uncoupled", "[", 
    RowBox[{"[", "3", "]"}], "]"}], "  ", "=", " ", 
   RowBox[{"J", "\[Rule]", " ", "0"}]}], ";"}]}], "Input",
 FontSize->16,
 CellLabel->
  "In[246]:=",ExpressionUUID->"f96d1db2-e523-4bd4-9b47-7ae6012ceed7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Some checks", "Subsection",
 CellChangeTimes->{{3.671961163155218*^9, 
  3.671961173753989*^9}},ExpressionUUID->"f338ac9d-9885-4c5f-858c-\
d1315ecd49b8"],

Cell["Check out the Nyquist frequencies", "Text",
 CellChangeTimes->{{3.671959676120822*^9, 3.671959692378523*^9}},
 FontSize->16,ExpressionUUID->"96dc8170-8273-4c3c-8eba-ec9e67c85ce8"],

Cell[BoxData[{
 RowBox[{"t1$List", "  ", "//", " ", 
  "TimeArrayReport"}], "\[IndentingNewLine]", 
 RowBox[{"t2$List", "  ", "//", " ", "TimeArrayReport"}]}], "Input",
 CellChangeTimes->{{3.671959650984557*^9, 3.671959663832185*^9}},
 FontSize->16,
 CellLabel->
  "In[248]:=",ExpressionUUID->"0ad43841-c3bc-44e5-9280-a8ce4e3c1bc6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Evolve the density operator", "Subsection",
 CellChangeTimes->{{3.671961177397146*^9, 
  3.671961192586527*^9}},ExpressionUUID->"155fe094-9f1a-49b5-9ed0-\
e5bc1a39ab18"],

Cell["\<\
Compute evolution.  This computation can take up to a minute.\
\>", "Text",
 CellChangeTimes->{{3.671935019629524*^9, 3.671935034174068*^9}, {
   3.6719605645133953`*^9, 3.6719605705526447`*^9}, {3.671969287167769*^9, 
   3.6719692919639597`*^9}, 3.8599181164103117`*^9},
 FontSize->18,ExpressionUUID->"7779501a-5a82-4c17-b571-2541349e6303"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]$0", " ", "=", " ", 
    RowBox[{"Iz", "+", " ", "Sz"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Initial", " ", 
    RowBox[{"(", 
     RowBox[{"\[Pi]", "/", "2"}], ")"}], "y", " ", "pulses"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]$1$A", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Rho]$0", " ", "//", " ", 
       RowBox[{
        RowBox[{"PulseS", "[", 
         RowBox[{"#", ",", 
          RowBox[{"\[Pi]", "/", "2"}], ",", 
          RowBox[{"\[Pi]", "/", "2"}]}], "]"}], "&"}]}], " ", "//", " ", 
      RowBox[{
       RowBox[{"PulseI", "[", 
        RowBox[{"#", ",", 
         RowBox[{"\[Pi]", "/", "2"}], ",", 
         RowBox[{"\[Pi]", "/", "2"}]}], "]"}], "&"}]}], ")"}], " ", "//", " ",
     "Expand"}]}], " "}], "\[IndentingNewLine]", 
 RowBox[{"\[Rho]$2$A", " ", "=", " ", 
  RowBox[{
   RowBox[{"FreeEvolution", "[", 
    RowBox[{"\[Rho]$1$A", ",", "t1"}], "]"}], "//", " ", 
   "Expand"}]}], "\[IndentingNewLine]", 
 RowBox[{"\[Rho]$3$A", " ", "=", 
  RowBox[{
   RowBox[{"(", " ", 
    RowBox[{
     RowBox[{"\[Rho]$2$A", "  ", "//", " ", 
      RowBox[{
       RowBox[{"PulseS", "[", 
        RowBox[{"#", ",", 
         RowBox[{"\[Pi]", "/", "2"}], ",", 
         RowBox[{"\[Pi]", "/", "2"}]}], "]"}], "&"}]}], " ", "//", " ", 
     RowBox[{
      RowBox[{"PulseI", "[", 
       RowBox[{"#", ",", 
        RowBox[{"\[Pi]", "/", "2"}], ",", 
        RowBox[{"\[Pi]", "/", "2"}]}], "]"}], "&"}]}], " ", ")"}], "//", " ", 
   "Expand"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]$4$A", " ", "=", " ", 
   RowBox[{
    RowBox[{"FreeEvolution", "[", 
     RowBox[{"\[Rho]$3$A", ",", "t2"}], "]"}], "//", " ", 
    RowBox[{"Expand", " ", "/.", " ", 
     RowBox[{"Mult", "->", " ", "SortedMult"}]}]}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Initial", " ", 
    RowBox[{"(", 
     RowBox[{"\[Pi]", "/", "2"}], ")"}], "x", " ", "pulses"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]$1$B", " ", "=", 
   RowBox[{
    RowBox[{"(", " ", 
     RowBox[{
      RowBox[{"\[Rho]$0", " ", "//", " ", 
       RowBox[{
        RowBox[{"PulseS", "[", 
         RowBox[{"#", ",", "0", ",", 
          RowBox[{"\[Pi]", "/", "2"}]}], "]"}], "&"}]}], " ", "//", "  ", 
      RowBox[{
       RowBox[{"PulseI", "[", 
        RowBox[{"#", ",", "0", ",", 
         RowBox[{"\[Pi]", "/", "2"}]}], "]"}], "&"}]}], " ", ")"}], " ", "//",
     " ", "Expand"}]}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]$2$B", " ", "=", " ", 
   RowBox[{
    RowBox[{"FreeEvolution", "[", 
     RowBox[{"\[Rho]$1$B", " ", ",", "t1"}], "]"}], "//", " ", "Expand"}]}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]$3$B", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Rho]$2$B", "  ", "//", " ", 
       RowBox[{
        RowBox[{"PulseS", "[", 
         RowBox[{"#", ",", 
          RowBox[{"\[Pi]", "/", "2"}], ",", 
          RowBox[{"\[Pi]", "/", "2"}]}], "]"}], "&"}]}], " ", "//", " ", 
      RowBox[{
       RowBox[{"PulseI", "[", 
        RowBox[{"#", ",", 
         RowBox[{"\[Pi]", "/", "2"}], ",", 
         RowBox[{"\[Pi]", "/", "2"}]}], "]"}], "&"}]}], " ", ")"}], "//", " ",
     "Expand"}]}], " "}], "\[IndentingNewLine]", 
 RowBox[{"\[Rho]$4$B", " ", "=", " ", 
  RowBox[{
   RowBox[{"FreeEvolution", "[", 
    RowBox[{"\[Rho]$3$B", ",", "t2"}], "]"}], "//", " ", 
   RowBox[{"Expand", " ", "/.", " ", 
    RowBox[{"Mult", "->", " ", "SortedMult"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.671880359452848*^9, 3.671880405654752*^9}, 
   3.6718805922056723`*^9, {3.671880654857966*^9, 3.671880658456214*^9}, {
   3.671890253281252*^9, 3.671890258732644*^9}, {3.671890514052863*^9, 
   3.671890531652615*^9}, {3.6718938201845903`*^9, 3.6718938368617887`*^9}, {
   3.671930954705418*^9, 3.671931017275107*^9}, 3.671931151058281*^9, {
   3.671934630648226*^9, 3.671934631703808*^9}, {3.671934668462163*^9, 
   3.671934668773761*^9}, {3.6719605559094963`*^9, 3.671960557480361*^9}, {
   3.671960621069422*^9, 3.671960621963992*^9}, {3.6719606859333878`*^9, 
   3.671960725034295*^9}, {3.671960833371766*^9, 3.671960835934683*^9}, {
   3.671960886232214*^9, 3.671960907062376*^9}, 3.6719609456733513`*^9, {
   3.671961074334423*^9, 3.671961080525428*^9}, {3.6719622809344807`*^9, 
   3.6719622908226767`*^9}, {3.6719624324839697`*^9, 3.671962441605382*^9}, {
   3.67196292873599*^9, 3.6719629321760273`*^9}, {3.67196299885725*^9, 
   3.671963002474958*^9}, {3.671963410249606*^9, 3.671963434808103*^9}, {
   3.67196348159336*^9, 3.6719634969874287`*^9}, {3.671963786339136*^9, 
   3.671963786485096*^9}, {3.6719659113954678`*^9, 3.671966018770185*^9}, {
   3.671966147940074*^9, 3.671966150638332*^9}, {3.671966243701359*^9, 
   3.6719662661919518`*^9}, {3.6719665328095007`*^9, 3.67196656405721*^9}, {
   3.6719670380983047`*^9, 3.67196704626505*^9}, {3.671967523270999*^9, 
   3.671967526955697*^9}, {3.671968168673579*^9, 3.671968191966599*^9}, {
   3.6719689148129387`*^9, 3.6719689635398207`*^9}, {3.671969093344201*^9, 
   3.671969105614452*^9}, {3.9401828581802597`*^9, 3.940182988172491*^9}, {
   3.940183504691101*^9, 3.940183538410215*^9}},
 FontSize->16,
 CellLabel->
  "In[259]:=",ExpressionUUID->"b45d5e10-1cf6-400b-8d64-8779cad497fe"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Examine the two signals and combine them", "Subsection",
 CellChangeTimes->{{3.671968201171743*^9, 
  3.67196821820794*^9}},ExpressionUUID->"6b145986-e0de-4937-a7e1-\
40a8232f0ac8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeNumerical", "[", 
   RowBox[{"Tr", "[", 
    RowBox[{"Mult", "[", 
     RowBox[{"\[Rho]$4$A", ",", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Ix", " ", "+", " ", "Sx"}], ")"}], " ", "+", " ", 
        RowBox[{"I", " ", 
         RowBox[{"(", 
          RowBox[{"Iy", " ", "+", " ", "Sy"}], ")"}]}]}], ")"}]}], "]"}], 
    "]"}], "]"}], "  ", "//", " ", "Simplify", " "}]], "Input",
 CellChangeTimes->{{3.671966565437508*^9, 3.671966742743554*^9}, {
  3.671967437765218*^9, 3.67196743891486*^9}, {3.671967807199925*^9, 
  3.671967807702455*^9}, {3.671967845292038*^9, 3.6719678458043613`*^9}, {
  3.671969338900051*^9, 3.671969352024382*^9}, {3.8599181218930597`*^9, 
  3.859918129574731*^9}, {3.859919339398814*^9, 3.859919351412393*^9}, {
  3.9401829915960827`*^9, 3.940182997936634*^9}},
 FontSize->16,ExpressionUUID->"626a2e5c-82d9-42c2-93d6-f526e2ee1719"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeNumerical", "[", 
   RowBox[{"Tr", "[", 
    RowBox[{"Mult", "[", 
     RowBox[{"\[Rho]$4$B", ",", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Ix", " ", "+", " ", "Sx"}], ")"}], " ", "+", " ", 
        RowBox[{"I", " ", 
         RowBox[{"(", 
          RowBox[{"Iy", " ", "+", " ", "Sy"}], ")"}]}]}], ")"}]}], "]"}], 
    "]"}], "]"}], "//", " ", "Simplify"}]], "Input",
 CellChangeTimes->{{3.671966786581603*^9, 3.671966786801403*^9}, 
   3.6719674296774*^9, {3.6719678097780857`*^9, 3.671967809981552*^9}, {
   3.671967848651556*^9, 3.671967849761945*^9}, {3.671969373554744*^9, 
   3.6719693750388412`*^9}, {3.859918132163199*^9, 3.859918137988377*^9}, {
   3.8599193549455957`*^9, 3.859919367737035*^9}, {3.940183000638851*^9, 
   3.940183007690308*^9}},
 FontSize->16,
 CellLabel->
  "In[268]:=",ExpressionUUID->"ec4af5a6-696f-4155-bd5b-c554fdbeb12c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Rho]$4", " ", "=", " ", 
   RowBox[{
    RowBox[{"-", "\[Rho]$4$A"}], " ", "+", " ", 
    RowBox[{"I", " ", "\[Rho]$4$B"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MakeNumerical", "[", 
   RowBox[{"Tr", "[", 
    RowBox[{"Mult", "[", 
     RowBox[{"\[Rho]$4", ",", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Ix", " ", "+", " ", "Sx"}], ")"}], " ", "+", " ", 
        RowBox[{"I", " ", 
         RowBox[{"(", 
          RowBox[{"Iy", " ", "+", " ", "Sy"}], ")"}]}]}], ")"}]}], "]"}], 
    "]"}], "]"}], "//", " ", "Simplify", " "}]}], "Input",
 CellChangeTimes->{{3.671966853423469*^9, 3.671966980704862*^9}, {
   3.671968224737483*^9, 3.6719682320550337`*^9}, 3.671969364729782*^9, {
   3.859918148203651*^9, 3.859918154953586*^9}, {3.859919372723805*^9, 
   3.859919386434927*^9}, {3.940183010326169*^9, 3.9401830164428596`*^9}},
 FontSize->16,
 CellLabel->
  "In[269]:=",ExpressionUUID->"945f5ce5-fb35-44a9-9f57-25d43d47a97a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute the signal and apply the 2D FT", "Subsection",
 CellChangeTimes->{{3.671961195103389*^9, 3.671961211402051*^9}, {
  3.8599200132411423`*^9, 
  3.859920014443495*^9}},ExpressionUUID->"604cf700-ce17-4d0a-93d4-\
823e680f5a2c"],

Cell["This computation takes a minute .", "Text",
 CellChangeTimes->{{3.859920122205473*^9, 3.859920133563258*^9}},
 FontSize->18,ExpressionUUID->"0073bd1e-0cbe-4b19-a74e-a09dc92e96d8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Signal2D", "[", 
    RowBox[{"t1_", ",", "t2_"}], "]"}], " ", "=", " ", "\[IndentingNewLine]", 
   
   RowBox[{"ReplaceAll", "[", 
    RowBox[{
     RowBox[{"Times", "[", 
      RowBox[{
       RowBox[{"MakeNumerical", "[", 
        RowBox[{"Tr", "[", 
         RowBox[{"Mult", "[", 
          RowBox[{"\[Rho]$4", " ", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Ix", " ", "+", " ", "Sx"}], ")"}], " ", "+", " ", 
             RowBox[{"I", " ", 
              RowBox[{"(", 
               RowBox[{"Iy", " ", "+", " ", "Sy"}], ")"}]}]}], ")"}]}], "]"}],
          "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "t1"}], "/", "T2"}], "]"}], " ", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "t2"}], "/", "T2"}], "]"}]}]}], "]"}], ",", 
     "HamiltonianParameters$coupled"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6719618553997602`*^9, 3.671961858187746*^9}, {
  3.671961957632979*^9, 3.671961968850966*^9}, {3.671962139492156*^9, 
  3.6719621396800413`*^9}, {3.6719635232842913`*^9, 3.671963533673254*^9}, {
  3.671963790457479*^9, 3.671963799378996*^9}, {3.6719657459183607`*^9, 
  3.671965746041649*^9}, {3.671965813218071*^9, 3.671965834051178*^9}, {
  3.671969419511218*^9, 3.671969430091721*^9}, {3.6719700879326067`*^9, 
  3.671970088681526*^9}, {3.8599181989647427`*^9, 3.8599182122285547`*^9}, {
  3.859919391972475*^9, 3.8599194118721724`*^9}, {3.859919950307776*^9, 
  3.8599199958731613`*^9}, {3.859920065435573*^9, 3.859920091769313*^9}, {
  3.859920250017049*^9, 3.859920327484049*^9}, {3.940183020925153*^9, 
  3.9401830279516487`*^9}},
 FontSize->16,
 CellLabel->
  "In[271]:=",ExpressionUUID->"074c8348-dfe6-4a13-9d12-9bc474f84c53"],

Cell["\<\
Fourier transform the signal.   This takes a couple of seconds.\
\>", "Text",
 CellChangeTimes->{{3.671935044258762*^9, 3.6719350524686747`*^9}, {
  3.671960577588045*^9, 3.6719605998631897`*^9}, {3.671960645960691*^9, 
  3.6719606557175407`*^9}, {3.671963564552681*^9, 3.671963573311535*^9}, {
  3.671970059300753*^9, 3.671970063023987*^9}},
 FontSize->18,ExpressionUUID->"3057bbd5-9d4b-4e4c-a9fb-a60d4d992a25"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"p1", ",", "p2", ",", "p3"}], "}"}], " ", "=", " ", 
   RowBox[{"DFFT2", "[", 
    RowBox[{"Signal2D", ",", "t1$List", ",", "t2$List"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.671881660314452*^9, 3.671881683505583*^9}, {
   3.671881715652314*^9, 3.671881723794434*^9}, {3.6718901308991117`*^9, 
   3.671890140126958*^9}, {3.67189019665511*^9, 3.671890196829525*^9}, {
   3.671892971354268*^9, 3.6718929714678288`*^9}, {3.671893026070917*^9, 
   3.6718930261749077`*^9}, 3.671932589687904*^9, 3.671934659488551*^9, {
   3.671934731891508*^9, 3.671934732059461*^9}, {3.671935155580461*^9, 
   3.671935158165567*^9}, {3.671960115925538*^9, 3.6719601445045347`*^9}, {
   3.671960183219754*^9, 3.671960207693185*^9}, {3.671960293139372*^9, 
   3.671960298605274*^9}, {3.671960405949394*^9, 3.671960409397332*^9}, {
   3.671960615957674*^9, 3.671960718647657*^9}, {3.671962184757069*^9, 
   3.671962225500497*^9}},
 FontSize->16,
 CellLabel->
  "In[272]:=",ExpressionUUID->"cdf4565a-56e7-4d22-a3e5-7107c73a1c8f"],

Cell[BoxData["p3"], "Input",
 CellChangeTimes->{{3.671962500316848*^9, 3.6719625005187073`*^9}, {
  3.671965857173787*^9, 3.671965878944346*^9}, {3.671966185507186*^9, 
  3.6719661952099857`*^9}, {3.671966284602901*^9, 3.6719662849153223`*^9}, {
  3.6719680746628847`*^9, 3.6719680749207172`*^9}, {3.671968246334671*^9, 
  3.671968246554215*^9}, {3.671968287970796*^9, 3.6719682893213367`*^9}, {
  3.6719700492346*^9, 3.6719700517908373`*^9}},
 FontSize->16,
 CellLabel->
  "In[273]:=",ExpressionUUID->"39b59cce-2adb-45bb-a815-c8fc8f27faf9"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1177, 839},
WindowMargins->{{273, Automatic}, {Automatic, 12}},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
FrontEndVersion->"13.0 for Mac OS X x86 (64-bit) (December 2, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"4b94a4d1-e48e-423c-a92a-3449b564a4f6"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 362, 6, 98, "Title",ExpressionUUID->"7be64f62-ccaa-4f0f-a03b-45500d5ee327"],
Cell[945, 30, 211, 6, 90, "Text",ExpressionUUID->"a39a3e0c-2de9-477d-b41b-054fd008c4d5"],
Cell[1159, 38, 892, 17, 64, "Text",ExpressionUUID->"5fa08270-95cf-4020-9639-dc0d59fa5688"],
Cell[CellGroupData[{
Cell[2076, 59, 101, 1, 62, "Section",ExpressionUUID->"972cccd7-cf27-472f-adb2-81c557c5fb8a"],
Cell[2180, 62, 1797, 43, 299, "Text",ExpressionUUID->"86ac4292-cc19-44f8-b8db-401f269b7e94"],
Cell[3980, 107, 688, 12, 142, "Text",ExpressionUUID->"6225042e-55b3-4027-aa9b-ba6d4e9ea444"],
Cell[4671, 121, 508, 11, 64, "Text",ExpressionUUID->"80981ff7-beca-4cac-b26c-3a6084bb8261"],
Cell[5182, 134, 728, 13, 142, "Text",ExpressionUUID->"d002cce0-1407-455c-bbb6-9c5f6df1c24e"],
Cell[5913, 149, 282, 5, 38, "Text",ExpressionUUID->"17636970-2f0a-4132-803d-e043a745f127"],
Cell[6198, 156, 1638, 36, 246, "Text",ExpressionUUID->"aaecd8b6-be0f-460f-bae2-73862d4525c9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7873, 197, 158, 3, 67, "Section",ExpressionUUID->"4ed0d17a-06c5-493e-9cc3-f294b201bc8c"],
Cell[CellGroupData[{
Cell[8056, 204, 174, 3, 54, "Subsection",ExpressionUUID->"d19429d6-b1f4-469f-811e-61c63e8e0603"],
Cell[8233, 209, 370, 9, 84, "Text",ExpressionUUID->"c7913457-435b-4ccd-91da-afcdf29a12fd"],
Cell[8606, 220, 739, 14, 34, "Input",ExpressionUUID->"cd5e990d-a1a7-4a0c-ab21-582ea8a73825"],
Cell[9348, 236, 207, 2, 36, "Text",ExpressionUUID->"9763b5fc-1af0-4271-8e50-7b036440db9d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9592, 243, 163, 3, 54, "Subsection",ExpressionUUID->"ed4f1380-ed80-4f76-b614-7a5f55da7198"],
Cell[9758, 248, 741, 15, 64, "Text",ExpressionUUID->"50410498-573d-4342-9171-efba2d7767fa"],
Cell[10502, 265, 619, 12, 61, "Input",ExpressionUUID->"eb48b2dd-65e6-4a37-adf8-696291a9f692"],
Cell[11124, 279, 356, 6, 64, "Text",ExpressionUUID->"8563de62-ca2d-4b11-a688-09c38ba1e536"],
Cell[11483, 287, 717, 14, 61, "Input",ExpressionUUID->"d5d749bc-001f-4cd3-a42b-96ca09dd3b1b"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[12249, 307, 283, 4, 67, "Section",ExpressionUUID->"89fc8b18-07bf-4b2f-88d9-d063d50ecd45"],
Cell[12535, 313, 285, 4, 38, "Text",ExpressionUUID->"e290d079-5037-49bd-8834-66ab0ccf5e1b"],
Cell[12823, 319, 1144, 27, 191, "Input",ExpressionUUID->"9f8e0b58-ae56-468c-9e4b-a8ed572df4ad"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14004, 351, 233, 4, 67, "Section",ExpressionUUID->"1004882e-54c4-4e38-8e89-142bca709a41"],
Cell[CellGroupData[{
Cell[14262, 359, 157, 3, 54, "Subsection",ExpressionUUID->"7456496e-e53b-477e-987a-e175d5adcb1d"],
Cell[14422, 364, 600, 10, 64, "Text",ExpressionUUID->"dd2e5afe-1933-4ffc-9fed-f4afbd615b8e"],
Cell[15025, 376, 1769, 41, 217, "Input",ExpressionUUID->"c29e1896-856a-4962-8b08-74fd2124aaed"],
Cell[16797, 419, 347, 6, 38, "Text",ExpressionUUID->"0d2775d1-0c06-497c-b972-32fa6857f990"],
Cell[17147, 427, 2058, 52, 113, "Input",ExpressionUUID->"f79ad30e-1df7-4cee-8ed4-6b920a69c207"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19242, 484, 157, 3, 54, "Subsection",ExpressionUUID->"3e2a96dd-c046-4df5-9760-c14f681fd832"],
Cell[19402, 489, 258, 3, 38, "Text",ExpressionUUID->"4c67dfd8-f719-4c38-9f6e-7678233b71b0"],
Cell[19663, 494, 1770, 41, 217, "Input",ExpressionUUID->"370baff8-5d40-4ad1-9627-957cc37805d1"],
Cell[21436, 537, 261, 3, 38, "Text",ExpressionUUID->"94032b52-6c28-43ed-a902-a17ca4eab9fd"],
Cell[21700, 542, 2036, 51, 113, "Input",ExpressionUUID->"d230d9a8-d32d-40e9-9898-2b23d747290b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23773, 598, 243, 3, 59, "Subsection",ExpressionUUID->"270c4cc7-6158-4857-aa31-b34fb6060eab"],
Cell[24019, 603, 1284, 31, 90, "Text",ExpressionUUID->"cc4987db-ba8e-4d8f-bd41-e4391245db04"],
Cell[25306, 636, 4899, 101, 659, "Input",ExpressionUUID->"783a6fc4-0f73-4f2b-9c15-831d6664f413"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[30254, 743, 410, 6, 67, "Section",ExpressionUUID->"5e3deb4e-66b1-43f3-a021-062bc67867c5"],
Cell[30667, 751, 1735, 40, 198, "Text",ExpressionUUID->"8b57c6fd-8f6f-4013-82e4-4543add8fa87"],
Cell[32405, 793, 1948, 49, 217, "Input",ExpressionUUID->"3581c660-0670-48d2-80f5-bfdf64503dfb"],
Cell[34356, 844, 378, 7, 38, "Text",ExpressionUUID->"ed808b88-6677-4519-8546-6c73c259a5fc"],
Cell[34737, 853, 1589, 44, 113, "Input",ExpressionUUID->"2e7f29a4-fbf9-40ab-8170-3e9fed11f2f7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36363, 902, 169, 3, 67, "Section",ExpressionUUID->"05cb1599-f7a5-49d8-bea3-9a7bfaf8564e"],
Cell[36535, 907, 235, 5, 34, "Input",ExpressionUUID->"bf6bc250-f027-4d13-aae7-c6b4f4cccda4"],
Cell[36773, 914, 264, 5, 38, "Text",ExpressionUUID->"f50922a1-80bf-49ee-8c8a-44da10a94ed9"],
Cell[37040, 921, 569, 14, 34, "Input",ExpressionUUID->"bb33eed5-d991-496f-a29b-f88eb937179e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37646, 940, 288, 4, 67, "Section",ExpressionUUID->"88873bb6-533c-42db-813d-c3a61f692c66"],
Cell[37937, 946, 226, 3, 38, "Text",ExpressionUUID->"ffe91360-6632-4f13-9965-1c91b72fb80a"],
Cell[38166, 951, 1419, 36, 212, "Input",ExpressionUUID->"f15baf2a-9de8-4c32-848d-e0a22075485c"],
Cell[39588, 989, 299, 4, 38, "Text",ExpressionUUID->"f628e189-d9fb-42fc-a2ff-e8eebdfd379c"],
Cell[39890, 995, 1243, 31, 183, "Input",ExpressionUUID->"51e5d797-28ac-484f-ab10-9879aa3e9b2d"],
Cell[41136, 1028, 302, 6, 38, "Text",ExpressionUUID->"c73d1ddc-ed88-4cb2-80bf-7e15b91c6479"],
Cell[41441, 1036, 7524, 174, 1101, "Input",ExpressionUUID->"97acd604-a5cd-428d-b93e-cd9c0bef4898"],
Cell[48968, 1212, 302, 6, 38, "Text",ExpressionUUID->"2cb67f03-2f5f-4d77-a556-6479f77dbbcd"],
Cell[49273, 1220, 6530, 148, 945, "Input",ExpressionUUID->"2c24caa5-d9c8-4768-942c-338cbb2870c2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[55840, 1373, 324, 5, 67, "Section",ExpressionUUID->"289dc7e7-5318-4734-b9ec-9bd92e0d4fbf"],
Cell[56167, 1380, 570, 13, 113, "Input",ExpressionUUID->"45870b17-3f73-4104-969e-1303b058835f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[56774, 1398, 238, 4, 67, "Section",ExpressionUUID->"0c130c8d-f981-468b-b1cc-abc6daf95179"],
Cell[57015, 1404, 170, 3, 54, "Text",ExpressionUUID->"61b6a67f-221d-42e6-aa9d-8b191b39263f"],
Cell[57188, 1409, 1877, 41, 207, "Input",ExpressionUUID->"70d01c13-0b5c-45e9-93bd-7a35b4dcc9a2"],
Cell[59068, 1452, 286, 5, 38, "Text",ExpressionUUID->"93ece18b-65c6-40ac-ae39-9e4bb8f8498c"],
Cell[59357, 1459, 440, 12, 67, "Input",ExpressionUUID->"a058680f-ed54-4782-ad08-3d45339d28b3"],
Cell[59800, 1473, 1061, 28, 69, "Text",ExpressionUUID->"97d8cfd2-75a0-4330-b083-fb6aedd1f5e1"],
Cell[60864, 1503, 1334, 35, 96, "Input",ExpressionUUID->"30b846b9-a52f-4dea-b902-edc91d57b187"],
Cell[62201, 1540, 188, 2, 36, "Text",ExpressionUUID->"9946b5aa-cae5-44ee-a404-e667f254eff6"],
Cell[62392, 1544, 223, 5, 34, "Input",ExpressionUUID->"4ba27410-fc87-4a31-8ea7-320eafcb8bed"],
Cell[62618, 1551, 239, 3, 38, "Text",ExpressionUUID->"eba1ae10-ae29-4de8-8efa-d5b3e0c2c42b"],
Cell[62860, 1556, 622, 14, 67, "Input",ExpressionUUID->"bd2b4d1b-1c36-45e7-98c3-ad4853b1b0e3"],
Cell[63485, 1572, 270, 5, 38, "Text",ExpressionUUID->"6c0fe435-0a3d-4318-9bf2-47328f5c914a"],
Cell[63758, 1579, 463, 9, 37, "Input",ExpressionUUID->"8cd2e1cb-eeb3-4ead-b34b-76a59f80cd0b"],
Cell[64224, 1590, 361, 6, 64, "Text",ExpressionUUID->"7c675140-137c-482b-aef1-4e6db7945eaa"],
Cell[64588, 1598, 258, 6, 37, "Input",ExpressionUUID->"d4fb6e84-56b5-4fc5-b7ae-3ec30f1ad9cc"],
Cell[64849, 1606, 288, 5, 38, "Text",ExpressionUUID->"e5a90fb6-20e8-4ed3-989a-39bf763b6051"],
Cell[65140, 1613, 1305, 36, 125, "Input",ExpressionUUID->"2b307d00-e435-4648-aada-4e0404b66d18"],
Cell[66448, 1651, 350, 9, 39, "Text",ExpressionUUID->"7ce4a0fc-b1c4-453f-bce3-19cd8a36a0e8"],
Cell[66801, 1662, 1317, 35, 96, "Input",ExpressionUUID->"a06b8099-3a24-4b24-ae73-ff4d23972b4f"],
Cell[68121, 1699, 348, 9, 39, "Text",ExpressionUUID->"52bceea9-6404-4f64-840d-0533f89635f7"],
Cell[68472, 1710, 1365, 35, 96, "Input",ExpressionUUID->"16f27b54-a6e2-4e7a-92ca-bd69922b47dd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[69874, 1750, 223, 4, 67, "Section",ExpressionUUID->"b9d63c19-5106-4c29-9497-3d33588dc59e"],
Cell[70100, 1756, 1934, 48, 277, "Text",ExpressionUUID->"89625a23-8035-420c-bbfa-f0f4620d2ddd"],
Cell[72037, 1806, 532, 15, 55, "Input",ExpressionUUID->"4ffa88fd-68b0-4963-ae3d-7bd8699fc63d"],
Cell[72572, 1823, 814, 21, 65, "Text",ExpressionUUID->"379e5f3f-d4d5-4761-a939-99add483084a"],
Cell[CellGroupData[{
Cell[73411, 1848, 410, 13, 54, "Subsection",ExpressionUUID->"7d90d886-6d2b-40f7-8b6d-d0a48a2190de"],
Cell[73824, 1863, 1874, 53, 147, "Text",ExpressionUUID->"b455085f-aadc-4f23-8443-c98a2c69e993"],
Cell[75701, 1918, 1532, 35, 61, "Input",ExpressionUUID->"119343a8-910f-4abe-bc82-dc48c75f0878"],
Cell[77236, 1955, 478, 12, 39, "Text",ExpressionUUID->"763a6242-2f70-4ce7-a795-f60ba0c2acc7"],
Cell[77717, 1969, 953, 25, 61, "Input",ExpressionUUID->"761bafdc-31f5-4fa7-965e-16b0f4b9e897"],
Cell[78673, 1996, 202, 5, 34, "Input",ExpressionUUID->"aa381f51-c179-42aa-adcd-522e702719fb"],
Cell[78878, 2003, 375, 7, 64, "Text",ExpressionUUID->"42391065-3d6b-4ff1-86be-1726eea35740"]
}, Open  ]],
Cell[CellGroupData[{
Cell[79290, 2015, 717, 22, 54, "Subsection",ExpressionUUID->"103705a5-71ba-4d27-8c37-c19f82bc09af"],
Cell[80010, 2039, 2297, 63, 231, "Text",ExpressionUUID->"77f410cd-6457-479d-a89d-945a7f887188"],
Cell[82310, 2104, 2016, 56, 139, "Input",ExpressionUUID->"828652eb-da86-4f80-ac2a-073b776ed52f"],
Cell[84329, 2162, 1401, 30, 204, "Text",ExpressionUUID->"be76d91c-57c5-4c4a-87bc-ac56674d86d5"],
Cell[85733, 2194, 948, 24, 90, "Text",ExpressionUUID->"ba727c88-eefd-4b17-8c70-950fabbacd4f"],
Cell[86684, 2220, 946, 21, 34, "Input",ExpressionUUID->"0c821184-7865-42a3-8cc4-f151e4b848f0"],
Cell[87633, 2243, 1018, 29, 65, "Text",ExpressionUUID->"a3472138-9171-4259-ae76-c36ae6897997"],
Cell[88654, 2274, 1098, 28, 87, "Input",ExpressionUUID->"6e551a39-f8b9-4e9c-a42b-03dd6800cbbc"],
Cell[89755, 2304, 268, 6, 34, "Input",ExpressionUUID->"3a7223a5-db02-495b-98c1-04e319e043d9"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[90072, 2316, 336, 5, 67, "Section",ExpressionUUID->"49499c2d-9b65-43cc-ac6d-05f50d0e2673"],
Cell[CellGroupData[{
Cell[90433, 2325, 191, 3, 54, "Subsection",ExpressionUUID->"b83516ed-649d-425d-9238-52329feb88a9"],
Cell[90627, 2330, 10424, 247, 1335, "Input",ExpressionUUID->"61e2fa25-0a40-480f-b751-e2ccf7a044ba"]
}, Open  ]],
Cell[CellGroupData[{
Cell[101088, 2582, 211, 4, 54, "Subsection",ExpressionUUID->"27c7108b-75ae-4c50-8079-a64b058e4efc"],
Cell[101302, 2588, 651, 17, 61, "Input",ExpressionUUID->"78617ef5-836d-45a7-ae6f-cbaeb96a4783"],
Cell[101956, 2607, 266, 6, 61, "Input",ExpressionUUID->"033eca70-ca05-437e-a9c9-39f84175c6c4"],
Cell[102225, 2615, 1571, 38, 113, "Input",ExpressionUUID->"0c2741f3-2e8a-4b0c-8fc5-dec9c038414c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[103833, 2658, 162, 3, 54, "Subsection",ExpressionUUID->"7ae16528-256b-4b43-96e5-e6f875601c5f"],
Cell[103998, 2663, 2220, 59, 269, "Input",ExpressionUUID->"e9f8d583-b0dd-4897-968e-51d1bd850a37"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[106267, 2728, 254, 3, 62, "Section",ExpressionUUID->"c255b162-baca-4759-8769-535797648e03"],
Cell[106524, 2733, 198, 2, 38, "Text",ExpressionUUID->"6e2d5704-ea21-4959-9168-82465d6b34f5"],
Cell[CellGroupData[{
Cell[106747, 2739, 186, 3, 54, "Subsection",ExpressionUUID->"150f014b-bca7-4cfd-8b7f-5f78818f70b7"],
Cell[106936, 2744, 170, 3, 54, "Text",ExpressionUUID->"ce7eef04-b03d-44b3-be4a-a5fa1dd68fd9"],
Cell[107109, 2749, 1856, 44, 207, "Input",ExpressionUUID->"29d2219a-d833-4de5-8ad3-16c4d8b5927d"],
Cell[108968, 2795, 247, 4, 54, "Text",ExpressionUUID->"c017c2c8-71ae-4b36-9e95-b100b4dbf118"],
Cell[109218, 2801, 1355, 27, 77, "Input",ExpressionUUID->"347b339f-b04d-45fa-a698-f9fd046246b1"],
Cell[110576, 2830, 286, 5, 38, "Text",ExpressionUUID->"66f87942-ff8e-4199-bba3-648c6e97eddf"],
Cell[110865, 2837, 440, 12, 67, "Input",ExpressionUUID->"7390ff1f-80b1-4565-b7c6-ce8740310e8f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[111342, 2854, 159, 3, 54, "Subsection",ExpressionUUID->"23ba2ddb-5424-40d4-a824-d03e90c4fca1"],
Cell[111504, 2859, 185, 2, 36, "Text",ExpressionUUID->"5c82b619-1fee-4519-a476-445a871dd7ec"],
Cell[111692, 2863, 332, 7, 61, "Input",ExpressionUUID->"9dfbee51-a5c1-46d7-a564-c28e135c2ee1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[112061, 2875, 175, 3, 54, "Subsection",ExpressionUUID->"eebd7438-fc40-491f-adf4-948216c79c4d"],
Cell[112239, 2880, 312, 4, 38, "Text",ExpressionUUID->"401dfce8-b573-4072-8ae7-49861d43c5a6"],
Cell[112554, 2886, 5059, 119, 399, "Input",ExpressionUUID->"b746eae8-5060-4ae3-97e3-c890a9b3daa5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[117650, 3010, 187, 3, 54, "Subsection",ExpressionUUID->"dd42c2dd-c64d-4e94-82d3-710e7dc79676"],
Cell[117840, 3015, 865, 19, 34, "Input",ExpressionUUID->"692ba318-e1a3-4fad-aaec-bb8b5b70b8fd"],
Cell[118708, 3036, 840, 18, 34, "Input",ExpressionUUID->"66364344-f365-48a9-aa85-4282de1ddccb"],
Cell[119551, 3056, 954, 22, 61, "Input",ExpressionUUID->"75b77280-5765-4689-8f3e-6968bfdf2d98"]
}, Open  ]],
Cell[CellGroupData[{
Cell[120542, 3083, 186, 3, 54, "Subsection",ExpressionUUID->"d90484d5-80fb-4302-b1ac-6deca0852648"],
Cell[120731, 3088, 247, 3, 38, "Text",ExpressionUUID->"a41bd966-8e6e-4384-b628-c16a5cb93b29"],
Cell[120981, 3093, 1669, 39, 61, "Input",ExpressionUUID->"14b6f368-4a45-406d-9c77-917af8e7cebe"],
Cell[122653, 3134, 360, 4, 38, "Text",ExpressionUUID->"6e492b73-416d-48dc-8645-d1a1d9667ae0"],
Cell[123016, 3140, 1082, 21, 34, "Input",ExpressionUUID->"c7fb10e7-8ae9-4d99-9d35-2dc49f630ad8"],
Cell[124101, 3163, 523, 8, 61, "Input",ExpressionUUID->"97549c28-c1a2-43f6-a33b-635548c74581"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[124673, 3177, 302, 4, 62, "Section",ExpressionUUID->"eaf952ed-5ee4-4484-98d8-16a977e1c8bd"],
Cell[124978, 3183, 387, 9, 38, "Text",ExpressionUUID->"3f16a6a4-6ba6-4bab-8e6f-e71252eab1b7"],
Cell[CellGroupData[{
Cell[125390, 3196, 186, 3, 54, "Subsection",ExpressionUUID->"8d595bbb-b9d9-4391-ac8e-08b01e3aa90f"],
Cell[125579, 3201, 170, 3, 54, "Text",ExpressionUUID->"359299cf-1469-4c2d-88b9-9f77ee372239"],
Cell[125752, 3206, 1888, 44, 181, "Input",ExpressionUUID->"a2cf4809-5418-419b-b3d5-bc1cb2d018da"],
Cell[127643, 3252, 247, 4, 54, "Text",ExpressionUUID->"3a549e4d-2582-406a-89cf-5a2387306610"],
Cell[127893, 3258, 1353, 27, 71, "Input",ExpressionUUID->"1c643bbb-70d6-4488-b8fc-6e9778a73bf6"],
Cell[129249, 3287, 286, 5, 38, "Text",ExpressionUUID->"f1bf3607-1fbe-46f1-8e92-70489bea5e42"],
Cell[129538, 3294, 440, 12, 61, "Input",ExpressionUUID->"f96d1db2-e523-4bd4-9b47-7ae6012ceed7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[130015, 3311, 159, 3, 54, "Subsection",ExpressionUUID->"f338ac9d-9885-4c5f-858c-d1315ecd49b8"],
Cell[130177, 3316, 185, 2, 36, "Text",ExpressionUUID->"96dc8170-8273-4c3c-8eba-ec9e67c85ce8"],
Cell[130365, 3320, 332, 7, 61, "Input",ExpressionUUID->"0ad43841-c3bc-44e5-9280-a8ce4e3c1bc6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[130734, 3332, 175, 3, 54, "Subsection",ExpressionUUID->"155fe094-9f1a-49b5-9ed0-e5bc1a39ab18"],
Cell[130912, 3337, 351, 6, 38, "Text",ExpressionUUID->"7779501a-5a82-4c17-b571-2541349e6303"],
Cell[131266, 3345, 5482, 131, 399, "Input",ExpressionUUID->"b45d5e10-1cf6-400b-8d64-8779cad497fe"]
}, Open  ]],
Cell[CellGroupData[{
Cell[136785, 3481, 187, 3, 54, "Subsection",ExpressionUUID->"6b145986-e0de-4937-a7e1-40a8232f0ac8"],
Cell[136975, 3486, 932, 20, 34, "Input",ExpressionUUID->"626a2e5c-82d9-42c2-93d6-f526e2ee1719"],
Cell[137910, 3508, 929, 22, 34, "Input",ExpressionUUID->"ec4af5a6-696f-4155-bd5b-c554fdbeb12c"],
Cell[138842, 3532, 1016, 25, 61, "Input",ExpressionUUID->"945f5ce5-fb35-44a9-9f57-25d43d47a97a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[139895, 3562, 237, 4, 54, "Subsection",ExpressionUUID->"604cf700-ce17-4d0a-93d4-823e680f5a2c"],
Cell[140135, 3568, 185, 2, 38, "Text",ExpressionUUID->"0073bd1e-0cbe-4b19-a74e-a09dc92e96d8"],
Cell[140323, 3572, 1846, 43, 87, "Input",ExpressionUUID->"074c8348-dfe6-4a13-9d12-9bc474f84c53"],
Cell[142172, 3617, 422, 7, 38, "Text",ExpressionUUID->"3057bbd5-9d4b-4e4c-a9fb-a60d4d992a25"],
Cell[142597, 3626, 1082, 21, 34, "Input",ExpressionUUID->"cdf4565a-56e7-4d22-a3e5-7107c73a1c8f"],
Cell[143682, 3649, 541, 9, 34, "Input",ExpressionUUID->"39b59cce-2adb-45bb-a815-c8fc8f27faf9"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

