(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    144312,       3923]
NotebookOptionsPosition[    135727,       3662]
NotebookOutlinePosition[    136139,       3680]
CellTagsIndexPosition[    136096,       3677]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["UniDyn--Demo-05.nb", "Title",
 CellChangeTimes->{{3.6352690845273046`*^9, 3.635269100847275*^9}, {
  3.6609180081345453`*^9, 3.660918013241088*^9}, {3.661433595181979*^9, 
  3.661433595493599*^9}, {3.671421633380262*^9, 3.6714216336468887`*^9}, {
  3.6718772443958178`*^9, 3.671877244528224*^9}}],

Cell["\<\
John A. Marohn
jam99@cornell.edu
Cornell University\
\>", "Text",
 CellChangeTimes->{{3.635269101985786*^9, 3.635269121580956*^9}},
 FontSize->18],

Cell[TextData[{
 StyleBox["Abstract:",
  FontWeight->"Bold"],
 "  Use the ",
 StyleBox["UniDyn",
  FontWeight->"Bold"],
 " Evolver function to calculate the evolution of the magnetization of a two \
coupled spin = 1/2 particles under free evolution, a heternuclear COSY pulse \
sequence, and a homonuclear pulse sequence."
}], "Text",
 CellChangeTimes->{{3.6352698622319117`*^9, 3.635269926908793*^9}, {
  3.6352701305950613`*^9, 3.635270138669529*^9}, {3.6614336154747458`*^9, 
  3.661433666560676*^9}, {3.661433776071369*^9, 3.6614337761699266`*^9}, {
  3.6614620415959*^9, 3.66146210493357*^9}, {3.67142163980396*^9, 
  3.671421654441256*^9}, {3.6714566972027082`*^9, 3.6714567047338247`*^9}, {
  3.67187725160753*^9, 3.671877263858714*^9}, {3.671970360631181*^9, 
  3.671970382703347*^9}},
 FontSize->18],

Cell[CellGroupData[{

Cell["Instructions", "Section",
 FontSize->24],

Cell[TextData[{
 "Once you edit the directory path below, you should be able to run the \
notebook.  This notebook will calculate, for two protons that are \"J\" \
coupled, the free induction decay and the two-dimensional COrrelation \
SpectroscopY (COSY) signal.  Both the heteronuclear (e.g., a coupled ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["\[InvisiblePrefixScriptBase]", "13"], 
    StyleBox["C",
     FontSlant->"Plain"]}], TraditionalForm]]],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["\[InvisiblePrefixScriptBase]", "1"], 
    StyleBox["H",
     FontSlant->"Plain"]}], TraditionalForm]]],
 ")  and homonuclear (e.g., two coupled ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["\[InvisiblePrefixScriptBase]", "1"], 
    StyleBox["H",
     FontSlant->"Plain"]}], TraditionalForm]]],
 "\[CloseCurlyQuote]s) experiments are written out below.  I have highlighted \
in yellow and grey the places in the file where you may want to change \
parameters. \n\nAnswer these questions after lab.\n\n1) ",
 StyleBox["Free evolution signal",
  FontWeight->"Bold",
  FontVariations->{"Underline"->True}],
 " \n\nI give some suggested values for the two proton chemical shifts, the J \
coupling, and the transverse relaxation time that will give nice looking \
spectra. "
}], "Text",
 CellMargins->{{54, Inherited}, {Inherited, Inherited}},
 CellChangeTimes->{{3.4180935248930798`*^9, 3.418093526765773*^9}, {
  3.671970431883233*^9, 3.671970570731018*^9}},
 TextAlignment->Left,
 TextJustification->0,
 FontSize->18],

Cell["\<\
a) Edit the J-coupling to zero and re-run the free-induction decay \
calculation. Does the spectrum look like you expect? (Reset the J-coupling \
back to something reasonble before continuing.)

b) Below I plot the real part of the Fourier transform.  Now plot the \
imaginary part and magnitude.  Is the resolution better for the real part of \
the signal or the magnitude part?  Can you explain the result qualitatively?\
\>", "Text",
 CellMargins->{{108, Inherited}, {Inherited, Inherited}},
 CellChangeTimes->{{3.67197058696099*^9, 3.671970595790347*^9}, {
  3.671970830769031*^9, 3.671970851708448*^9}},
 FontSize->18],

Cell[TextData[{
 "\n2) ",
 StyleBox["COSY",
  FontWeight->"Bold",
  FontVariations->{"Underline"->True}],
 ".  Each COSY signal takes a few seconds to calculate.   "
}], "Text",
 CellChangeTimes->{{3.639273270959442*^9, 3.639273273038609*^9}, {
  3.671970865106908*^9, 3.671970865310254*^9}, {3.671971066508307*^9, 
  3.6719711536549463`*^9}, {3.671971192346159*^9, 3.671971249510413*^9}, {
  3.671971282554853*^9, 3.671971292154003*^9}},
 FontSize->18],

Cell["\<\
a) Draw out the pulse sequence for the Heteronuclear COSY and the Homonuclear \
COSY experiments.  How are the experiments different?

b) In each spectum, there is a small signal blip at the center of the plot.  \
This is not due to the spins -- I added that fake signal.  How did I add it?  \
Why did I add it?\
\>", "Text",
 CellMargins->{{108, Inherited}, {Inherited, Inherited}},
 CellChangeTimes->{{3.639273136000342*^9, 3.639273145875243*^9}, {
  3.6719708766891603`*^9, 3.671970882920882*^9}, {3.6719709846987333`*^9, 
  3.6719710602761183`*^9}, {3.671971271233128*^9, 3.671971272411804*^9}, {
  3.671971345081327*^9, 3.671971493737226*^9}},
 FontSize->18],

Cell["\<\
For both the Heteronuclear COSY and the Homonuclear COSY experiments,\
\>", "Text",
 CellChangeTimes->{{3.671971279707144*^9, 3.671971286434424*^9}, {
  3.6719714979812403`*^9, 3.6719714991052113`*^9}},
 FontSize->18],

Cell[TextData[{
 "c) Edit the J-coupling to zero and recalculate the spectrum.  Does the COSY \
spectrum look any different?  (Reset the J-coupling back to something \
reasonble before continuing.)\n\nd) Below I plot the two-dimensional Fourier \
transform of the COSY signal.  The signal is not symmetic in \[Omega]1 and \
\[Omega]2. Can you explain this? Look at the terms in the ",
 StyleBox["\[Rho]$4$A",
  FontWeight->"Bold"],
 ", ",
 StyleBox["\[Rho]$4$B",
  FontWeight->"Bold"],
 ", and ",
 StyleBox["\[Rho]$4",
  FontWeight->"Bold"],
 " signals.  How was each of these signals created?s\n \ne) Like you did with \
the FID, plot the imaginary, real,and magnitude of the two-dimensional \
Fourier transform of the COSY(t1,t2) signal -- these are the plots ",
 StyleBox["p1",
  FontWeight->"Bold"],
 ", ",
 StyleBox["p2",
  FontWeight->"Bold"],
 ", and ",
 StyleBox["p3",
  FontWeight->"Bold"],
 " returned by the 2D Fourier transform function. Note the peak shapes.  For \
example, are all the peaks positive?  To see whether the peaks in the \
spectrum are positive or negative, you can rotate the plot around using the \
mouse."
}], "Text",
 CellMargins->{{108, Inherited}, {Inherited, Inherited}},
 CellChangeTimes->{{3.639273136000342*^9, 3.639273145875243*^9}, {
   3.6719708766891603`*^9, 3.671970882920882*^9}, {3.6719709846987333`*^9, 
   3.6719710602761183`*^9}, {3.671971296042631*^9, 3.671971342952244*^9}, {
   3.67197139969138*^9, 3.671971408746414*^9}, {3.671971504242578*^9, 
   3.671971508769294*^9}, 3.672140559768456*^9},
 FontSize->18]
}, Open  ]],

Cell[CellGroupData[{

Cell["Preliminaries", "Section",
 CellChangeTimes->{{3.671969802395784*^9, 3.671969809537006*^9}}],

Cell[CellGroupData[{

Cell["Set the path to the package", "Subsection",
 CellChangeTimes->{{3.635270036711257*^9, 3.63527004852262*^9}}],

Cell[TextData[{
 "Tell ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " the path to the directory containing the package.    \n\nEDIT THE \
FOLLOWING PATH STRING:"
}], "Text",
 CellChangeTimes->{{3.635270060901009*^9, 3.635270086988311*^9}, {
  3.6610825274488792`*^9, 3.6610825288209763`*^9}},
 FontSize->16],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
   "$PackagePath", " ", "=", 
    "\"\</Users/jam99/Dropbox/MarohnGroup__Software_Library/UniDyn/unidyn\>\"\
"}], ";"}], " "}]], "Input",
 CellChangeTimes->{{3.6349053527016897`*^9, 3.6349054064223843`*^9}, {
  3.634910931339162*^9, 3.634910931457775*^9}, {3.634914337947165*^9, 
  3.6349143671071568`*^9}, {3.634922597904743*^9, 3.634922606812076*^9}, {
  3.635268730835155*^9, 3.635268731125407*^9}, {3.635269951638358*^9, 
  3.635269958323474*^9}, {3.660918115324842*^9, 3.660918132325369*^9}, {
  3.660918590921587*^9, 3.660918600403768*^9}},
 FontSize->16],

Cell["YOU SHOULD NOT NEED TO EDIT ANYTHING FROM HERE ONWARDS.", "Text",
 CellChangeTimes->{{3.635270073196437*^9, 3.635270077357624*^9}},
 FontSize->16]
}, Open  ]],

Cell[CellGroupData[{

Cell["Load the package", "Subsection",
 CellChangeTimes->{{3.635269129230983*^9, 3.63526913095236*^9}}],

Cell[TextData[{
 "Append the package path to the system path.  Before trying to load the \
package, ask ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " to find it.  This is a test that we directed ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " to the correct directory.  The output of this command should be the full \
system path to the UniDyn.m file.   "
}], "Text",
 CellChangeTimes->{{3.635269223597199*^9, 3.635269340159473*^9}, {
   3.635269947982662*^9, 3.6352699492517843`*^9}, {3.635269985297124*^9, 
   3.63527000724584*^9}, 3.635270066996499*^9, {3.63527010818321*^9, 
   3.6352701131658497`*^9}, {3.660918102499856*^9, 3.6609181035465183`*^9}},
 FontSize->18],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$Path", " ", "=", " ", 
   RowBox[{"AppendTo", "[", 
    RowBox[{"$Path", ",", "$PackagePath"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"FindFile", "[", "\"\<UniDyn`\>\"", "]"}]}], "Input",
 CellChangeTimes->{{3.634906393354924*^9, 3.634906398308229*^9}, {
  3.634922599063291*^9, 3.634922599752222*^9}, {3.635268728673848*^9, 
  3.6352687402094*^9}, {3.635269954012105*^9, 3.6352699550474253`*^9}},
 FontSize->16],

Cell["\<\
Now that we are confident that the path is set correctlly, load the package.  \
Setting the global $VerboseLoad variable to True will print out the help \
strings for key commands in the package.  \
\>", "Text",
 CellChangeTimes->{{3.635269347360386*^9, 3.63526943190546*^9}},
 FontSize->18],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$VerboseLoad", " ", "=", "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Needs", "[", "\"\<UniDyn`\>\"", "]"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAGIQfYUjQpVD9LXjxxR+TRC9peyGEyeQ/lH0EExXTKuJ
BdGbVk8B0zYvFOpA9Ik35o0gmsEzcwKI3ruyF0yrn4ubDqITDHPAdMGBGUdA
9K1JG8G0V4+DGg+Q1vtwBUyLu5WcAtE8yv6nQfT861tdBUDm3NFxA9F2v/Ym
g+h4M4cUED09+VEGiC6rzcoH0RUNSUHSQHqfnVQoiP6uyGkiC6T5nmeCabdp
f25FAekIO8nbINqkKUQlBUiz/Z0DplNs3jwG0Q88GJ+A6Bf2PcZdQNqjYi6Y
XnQt//l3t9eOqzNZX4DoFiF11h9A+sM0WzCtqnCwYKH7a8c9B1ULQfQUn1WX
e6JfO17R07gGop8XdtwG0RfPLADTH4ynHVwCpA+I7gHTAHQ2q7E=
  "],
 FontSize->16]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Evolver function with simplification ", "Section",
 CellChangeTimes->{{3.6714440687071867`*^9, 3.671444088666716*^9}, {
  3.671880302829075*^9, 3.671880303781885*^9}, {3.6719244911101007`*^9, 
  3.6719244959724007`*^9}}],

Cell["Free evolution operator", "Text",
 CellChangeTimes->{{3.671880176378189*^9, 3.671880184855246*^9}, {
  3.671924537517173*^9, 3.671924541034936*^9}},
 FontSize->18],

Cell[BoxData[
 RowBox[{
  RowBox[{"SimplifyingEvolver", "[", 
   RowBox[{"H_", ",", "t_", ",", "\[Rho]$0_"}], "]"}], ":=", "  ", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", "   ", 
   RowBox[{"H", " ", "=", " ", 
    RowBox[{"Hamiltonian", " ", "operator"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "   ", 
   RowBox[{"t", " ", "=", " ", 
    RowBox[{"time", " ", "varaible"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"\[Rho]$0", " ", "=", " ", 
    RowBox[{"initial", " ", "density", " ", "operator"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Evolver", "[", 
      RowBox[{"H", ",", " ", "t", ",", " ", "\[Rho]$0"}], "]"}], "//", 
     "Simplify"}], "//", " ", "ExpToTrig"}], " ", "//", " ", "FullSimplify", 
   " "}]}]], "Input",
 CellChangeTimes->{{3.671444089823865*^9, 3.671444165795093*^9}, {
  3.671880250049287*^9, 3.6718802930947857`*^9}, {3.671925896699779*^9, 
  3.671925898519351*^9}},
 FontSize->18]
}, Open  ]],

Cell[CellGroupData[{

Cell["Impliment pulses with simplication", "Section",
 CellChangeTimes->{{3.671924509162469*^9, 3.67192453111033*^9}}],

Cell[CellGroupData[{

Cell["I spins", "Subsection",
 CellChangeTimes->{{3.6719248204181223`*^9, 3.671924825871171*^9}}],

Cell["\<\
Evolve the I spins under a short burst of applied on-resonance irradiation, \
in the delta-function pulse approximation.  Specify the total pulse angle and \
the pulse phase and the PulseI operator evolves the density operator \
accordingly.\
\>", "Text",
 CellChangeTimes->{{3.671880188061632*^9, 3.671880199649797*^9}, {
  3.671892307249003*^9, 3.671892352394723*^9}, {3.6718926596400623`*^9, 
  3.6718926618696127`*^9}, {3.671924555111989*^9, 3.6719246015464067`*^9}, {
  3.671924644090493*^9, 3.671924785894499*^9}},
 FontSize->18],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "PulseI", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PulseI", "[", 
   RowBox[{"\[Rho]$0_", ",", "\[Phi]_", ",", "\[Theta]_"}], "]"}], " ", ":=", 
  " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"\[Rho]$0", " ", "=", " ", 
    RowBox[{"initial", " ", "density", " ", "operator"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "   ", 
   RowBox[{"\[Phi]", " ", "=", " ", 
    RowBox[{"pulse", " ", "phase", " ", "in", " ", "radians"}]}], " ", "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{"(*", "   ", 
   RowBox[{"\[Theta]", " ", "=", " ", 
    RowBox[{"pulse", " ", "angle", " ", "in", " ", "radians"}]}], " ", "*)"}],
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"\[Rho]$0", " ", "//", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"SimplifyingEvolver", "[", " ", 
      RowBox[{
       RowBox[{"\[Omega]$I", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", "Ix"}], " ", "+", " ", 
          RowBox[{
           RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", "Iy"}]}], ")"}]}], ",", 
       "t", ",", " ", "#"}], "]"}], "&"}], " ", "/.", " ", 
    RowBox[{"{", 
     RowBox[{"t", "\[Rule]", " ", 
      RowBox[{"\[Theta]", "/", "\[Omega]$I"}]}], "}"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.671838890598955*^9, 3.6718389878430643`*^9}, {
  3.671839497724379*^9, 3.671839500153345*^9}, {3.671880204028532*^9, 
  3.67188023570371*^9}, {3.671924626484288*^9, 3.671924627404508*^9}, {
  3.671924798937351*^9, 3.6719248037729053`*^9}, {3.671925889925756*^9, 
  3.671925893072789*^9}},
 FontSize->18],

Cell["\<\
The pulse operator distrubutes over Plus, Times, and NoncommutativeMultiply.  \
Scalars in front of operators can be pulled out front.\
\>", "Text",
 CellChangeTimes->{{3.671924646481277*^9, 3.6719246493459263`*^9}, {
  3.671925665329852*^9, 3.6719256681754436`*^9}},
 FontSize->18],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PulseI", "[", 
   RowBox[{"\[Rho]$0_Plus", ",", "\[Phi]_", ",", "\[Theta]_"}], "]"}], " ", ":=", 
  RowBox[{"Plus", " ", "@@", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"PulseI", "[", 
       RowBox[{"#", ",", "\[Phi]", ",", "\[Theta]"}], "]"}], "&"}], ")"}], 
    " ", "/@", " ", 
    RowBox[{"List", " ", "@@", " ", "\[Rho]$0"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PulseI", "[", 
   RowBox[{"\[Rho]$0_Times", ",", "\[Phi]_", ",", "\[Theta]_"}], "]"}], " ", ":=", 
  RowBox[{"Times", "@@", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"PulseI", "[", 
       RowBox[{"#", ",", "\[Phi]", ",", "\[Theta]"}], "]"}], "&"}], ")"}], 
    " ", "/@", " ", 
    RowBox[{"List", " ", "@@", " ", "\[Rho]$0"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PulseI", "[", 
   RowBox[{
   "\[Rho]$0_NonCommutativeMultiply", ",", "\[Phi]_", ",", "\[Theta]_"}], 
   "]"}], " ", ":=", 
  RowBox[{"NonCommutativeMultiply", " ", "@@", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"PulseI", "[", 
       RowBox[{"#", ",", "\[Phi]", ",", "\[Theta]"}], "]"}], "&"}], ")"}], 
    " ", "/@", " ", 
    RowBox[{"List", " ", "@@", " ", "\[Rho]$0"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PulseI", "[", 
   RowBox[{
    RowBox[{"Times", "[", 
     RowBox[{
      RowBox[{"a_", "?", "CommutativeQ"}], ",", "\[Rho]$0_"}], "]"}], ",", 
    "\[Phi]_", ",", "\[Theta]_"}], "]"}], " ", ":=", " ", 
  RowBox[{"a", " ", 
   RowBox[{"PulseI", "[", 
    RowBox[{"\[Rho]$0", ",", "\[Phi]", ",", "\[Theta]"}], "]"}]}]}]}], "Input",\

 CellChangeTimes->{{3.671892024789138*^9, 3.671892098917617*^9}, {
   3.67189228083952*^9, 3.671892286693618*^9}, 3.67189235529066*^9, {
   3.671892670413329*^9, 3.671892682613155*^9}, {3.67189278127796*^9, 
   3.671892795726034*^9}, {3.671892825837974*^9, 3.67189284981843*^9}, {
   3.671924625292719*^9, 3.6719246386801853`*^9}},
 FontSize->18]
}, Open  ]],

Cell[CellGroupData[{

Cell["S spins", "Subsection",
 CellChangeTimes->{{3.6719248293571033`*^9, 3.671924837283074*^9}}],

Cell["Define an analogous pulse operator for the S spins ... ", "Text",
 CellChangeTimes->{{3.6719245927817087`*^9, 3.671924618122842*^9}, {
  3.671924864330348*^9, 3.671924865216565*^9}},
 FontSize->18],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "PulseS", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PulseS", "[", 
   RowBox[{"\[Rho]$0_", ",", "\[Phi]_", ",", "\[Theta]_"}], "]"}], " ", ":=", 
  " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"\[Rho]$0", " ", "=", " ", 
    RowBox[{"initial", " ", "density", " ", "operator"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "   ", 
   RowBox[{"\[Phi]", " ", "=", " ", 
    RowBox[{"pulse", " ", "phase", " ", "in", " ", "radians"}]}], " ", "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{"(*", "   ", 
   RowBox[{"\[Theta]", " ", "=", " ", 
    RowBox[{"pulse", " ", "angle", " ", "in", " ", "radians"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"\[Rho]$0", " ", "//", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"SimplifyingEvolver", "[", " ", 
      RowBox[{
       RowBox[{"\[Omega]$S", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", "Sx"}], " ", "+", " ", 
          RowBox[{
           RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", "Sy"}]}], ")"}]}], ",", 
       "t", ",", " ", "#"}], "]"}], "&"}], " ", "/.", " ", 
    RowBox[{"{", 
     RowBox[{"t", "\[Rule]", " ", 
      RowBox[{"\[Theta]", "/", "\[Omega]$S"}]}], "}"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.671838890598955*^9, 3.6718389878430643`*^9}, {
  3.6718390431124573`*^9, 3.67183905277701*^9}, {3.6718802416768703`*^9, 
  3.671880244871852*^9}, {3.671924807702702*^9, 3.671924813313757*^9}, {
  3.6719248517968397`*^9, 3.671924852470512*^9}, {3.6719258831960077`*^9, 
  3.671925886536357*^9}},
 FontSize->18],

Cell["... with nice distributive and scalar-factoring properties.", "Text",
 CellChangeTimes->{{3.671924875863431*^9, 3.6719248966102333`*^9}, {
  3.671925673027916*^9, 3.67192567415032*^9}},
 FontSize->18],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PulseS", "[", 
   RowBox[{"\[Rho]$0_Plus", ",", "\[Phi]_", ",", "\[Theta]_"}], "]"}], " ", ":=", 
  RowBox[{"Plus", " ", "@@", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"PulseS", "[", 
       RowBox[{"#", ",", "\[Phi]", ",", "\[Theta]"}], "]"}], "&"}], ")"}], 
    " ", "/@", " ", 
    RowBox[{"List", " ", "@@", " ", "\[Rho]$0"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PulseS", "[", 
   RowBox[{"\[Rho]$0_Times", ",", "\[Phi]_", ",", "\[Theta]_"}], "]"}], " ", ":=", 
  RowBox[{"Times", "@@", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"PulseS", "[", 
       RowBox[{"#", ",", "\[Phi]", ",", "\[Theta]"}], "]"}], "&"}], ")"}], 
    " ", "/@", " ", 
    RowBox[{"List", " ", "@@", " ", "\[Rho]$0"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PulseS", "[", 
   RowBox[{
   "\[Rho]$0_NonCommutativeMultiply", ",", "\[Phi]_", ",", "\[Theta]_"}], 
   "]"}], " ", ":=", 
  RowBox[{"NonCommutativeMultiply", " ", "@@", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"PulseS", "[", 
       RowBox[{"#", ",", "\[Phi]", ",", "\[Theta]"}], "]"}], "&"}], ")"}], 
    " ", "/@", " ", 
    RowBox[{"List", " ", "@@", " ", "\[Rho]$0"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PulseS", "[", 
   RowBox[{
    RowBox[{"Times", "[", 
     RowBox[{
      RowBox[{"a_", "?", "CommutativeQ"}], ",", "\[Rho]$0_"}], "]"}], ",", 
    "\[Phi]_", ",", "\[Theta]_"}], "]"}], " ", ":=", " ", 
  RowBox[{"a", " ", 
   RowBox[{"PulseS", "[", 
    RowBox[{"\[Rho]$0", ",", "\[Phi]", ",", "\[Theta]"}], "]"}]}]}]}], "Input",\

 CellChangeTimes->{{3.671892024789138*^9, 3.671892098917617*^9}, {
  3.67189228083952*^9, 3.671892286693618*^9}, {3.67189235529066*^9, 
  3.6718923759734573`*^9}, {3.671892691703903*^9, 3.671892696427689*^9}, {
  3.6718928815671167`*^9, 3.6718928930037537`*^9}, {3.6719248490978622`*^9, 
  3.6719248751433973`*^9}},
 FontSize->18]
}, Open  ]],

Cell[CellGroupData[{

Cell["Two spins", "Subsection",
 CellChangeTimes->{{3.661433931683024*^9, 3.661433953976736*^9}, {
   3.6714222121324053`*^9, 3.671422215219035*^9}, 3.6719257350922203`*^9},
 FontSize->24],

Cell[TextData[{
 "The assumptions define below are required for ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " to recognize ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SqrtBox[
     RowBox[{"\[Dash]", 
      RowBox[{
       SuperscriptBox["\[CapitalDelta]", "2"], "-", 
       SuperscriptBox["\[Omega]", "2"]}]}]], "=", " ", 
    RowBox[{"I", 
     SqrtBox[
      RowBox[{
       SuperscriptBox["\[CapitalDelta]", "2"], "+", 
       SuperscriptBox["\[Omega]", "2"]}]]}]}], TraditionalForm]],
  FontSize->14],
 " inside an exponential.   One of the variables has to be defined to be > 0 \
and not just \[GreaterSlantEqual] 0.   For ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " and the Evolve[] function to recognize unitary rotations, it is crucially \
important to define all the non-operator variables in your expressions to be \
scalars."
}], "Text",
 CellChangeTimes->{{3.661454934610312*^9, 3.661455077339642*^9}, {
   3.661455120999338*^9, 3.6614551250107203`*^9}, {3.66145516298409*^9, 
   3.661455238939184*^9}, {3.6614552751916943`*^9, 3.6614553005499*^9}, 
   3.66169791700492*^9, {3.6719249140285597`*^9, 3.6719249776881247`*^9}},
 FontSize->18],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"\[CapitalDelta]$I", ",", "                 ", 
    RowBox[{"(*", " ", 
     RowBox[{"Resonance", " ", "offset", " ", "frequency"}], " ", "*)"}], 
    "\[IndentingNewLine]", "\[CapitalDelta]$S", ",", "                 ", 
    RowBox[{"(*", " ", 
     RowBox[{"Resonance", " ", "offset", " ", "frequency"}], " ", "*)"}], 
    "\[IndentingNewLine]", "J", ",", "                      ", 
    RowBox[{"(*", " ", 
     RowBox[{"Spin", "-", 
      RowBox[{"spin", " ", "coupling"}]}], " ", "*)"}], "\[IndentingNewLine]",
     "Ix", ",", " ", "Iy", ",", " ", "Iz", ",", " ", 
    RowBox[{"(*", " ", 
     RowBox[{"Spin", " ", "angular", " ", "momentum", " ", "operators"}], " ",
      "*)"}], "\[IndentingNewLine]", "Sx", ",", " ", "Sy", ",", " ", "Sz", 
    ",", " ", 
    RowBox[{"(*", " ", 
     RowBox[{"Spin", " ", "angular", " ", "momentum", " ", "operators"}], " ",
      "*)"}], "\[IndentingNewLine]", "\[Rho]", ",", "                      ", 
    
    RowBox[{"(*", " ", 
     RowBox[{"Spin", " ", "density", " ", "operator"}], " ", "*)"}], " ", 
    "\[IndentingNewLine]", "t", ",", "                       ", 
    RowBox[{"(*", " ", "Time", " ", "*)"}], "\[IndentingNewLine]", "t1", ",", 
    "                     ", 
    RowBox[{"(*", " ", "Time", " ", "*)"}], "\[IndentingNewLine]", "t2", ",", 
    "                     ", 
    RowBox[{"(*", " ", "Time", " ", "*)"}], "\[IndentingNewLine]", "a", ",", 
    "                        ", 
    RowBox[{"(*", " ", 
     RowBox[{"Curie", " ", "Law", " ", "factor"}], " ", "*)"}], 
    "\[IndentingNewLine]", "b", ",", "                       ", 
    RowBox[{"(*", " ", 
     RowBox[{"Curie", " ", "Law", " ", "factor"}], " ", "*)"}], 
    "\[IndentingNewLine]", "\[Rho]$0", ",", "                  ", 
    RowBox[{"(*", " ", 
     RowBox[{"Initial", " ", "spin", " ", "density", " ", "operator"}], " ", 
     "*)"}], "\[IndentingNewLine]", "H"}], "                          ", 
   RowBox[{"(*", " ", 
    RowBox[{"Spin", " ", "Hamiltonian"}], " ", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CreateScalar", "[", 
    RowBox[{
    "\[CapitalDelta]$I", ",", "\[CapitalDelta]$S", ",", "J", ",", "t", ",", 
     "t1", ",", "t2", ",", "a", ",", "b"}], " ", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$Assumptions", "  ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Element", "[", 
       RowBox[{"\[CapitalDelta]$I", ",", " ", "Reals"}], "]"}], ",", " ", 
      RowBox[{"\[CapitalDelta]$I", " ", "\[GreaterSlantEqual]", " ", "0"}], 
      ",", " ", 
      RowBox[{"Element", "[", 
       RowBox[{"\[CapitalDelta]$S", ",", " ", "Reals"}], "]"}], ",", " ", 
      RowBox[{"\[CapitalDelta]$S", " ", "\[GreaterSlantEqual]", " ", "0"}], 
      ",", " ", 
      RowBox[{"Element", "[", 
       RowBox[{"J", ",", " ", "Reals"}], "]"}], ",", " ", 
      RowBox[{"J", "  ", ">", " ", "0"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CreateOperator", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Ix", ",", " ", "Iy", ",", " ", "Iz"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Sx", ",", " ", "Sy", ",", " ", "Sz"}], "}"}]}], "}"}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"SpinSingle$CreateOperators", "[", 
   RowBox[{"Ix", ",", " ", "Iy", ",", " ", "Iz", ",", " ", 
    RowBox[{"L", "=", 
     RowBox[{"1", "/", "2"}]}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SpinSingle$CreateOperators", "[", 
   RowBox[{"Sx", ",", " ", "Sy", ",", " ", "Sz", ",", " ", 
    RowBox[{"L", "=", 
     RowBox[{"1", "/", "2"}]}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6614339585492563`*^9, 3.661434010703532*^9}, {
   3.661434214867899*^9, 3.661434222437502*^9}, {3.661434384868638*^9, 
   3.6614346039604807`*^9}, {3.6614346490398808`*^9, 3.661434789890903*^9}, {
   3.661435094092959*^9, 3.661435125986967*^9}, {3.6614352184576807`*^9, 
   3.661435260920999*^9}, 3.661454979504386*^9, {3.6614550830373096`*^9, 
   3.6614550896485147`*^9}, {3.661455140167131*^9, 3.66145514338946*^9}, {
   3.6614552141564493`*^9, 3.661455268214559*^9}, {3.671422223446307*^9, 
   3.671422276457761*^9}, {3.6714223930390167`*^9, 3.671422478451767*^9}, {
   3.6714445143764687`*^9, 3.671444514801667*^9}, {3.6714447631748466`*^9, 
   3.671444772352507*^9}, {3.671445003838581*^9, 3.6714450185403843`*^9}, {
   3.671890416297718*^9, 3.6718904324881573`*^9}, {3.671894623601046*^9, 
   3.671894649558962*^9}, {3.6719249838130283`*^9, 3.671925018230544*^9}},
 FontSize->16]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Free evolution operator for two coupled spins", "Section",
 CellChangeTimes->{{3.661433931683024*^9, 3.661433953976736*^9}, {
   3.6714222121324053`*^9, 3.671422215219035*^9}, {3.671877622369337*^9, 
   3.671877625383318*^9}, {3.671925029741441*^9, 3.6719250354872713`*^9}, 
   3.671925681781056*^9, {3.67192573986287*^9, 3.6719257433138*^9}}],

Cell[TextData[{
 "Evolve the density operator under the Hamiltonian\n\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"H", " ", "=", "  ", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[CapitalDelta]", "I"], " ", 
      SubscriptBox["I", "z"]}], "+", " ", 
     RowBox[{
      SubscriptBox["\[CapitalDelta]", "S"], " ", 
      SubscriptBox["S", "z"]}], " ", "+", " ", 
     RowBox[{"J", " ", 
      SubscriptBox["I", "z"], 
      SubscriptBox["S", "z"]}]}]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "\n\nwhere ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[CapitalDelta]", "I"], TraditionalForm]]],
 " is the I-spin chemical shift, ",
 Cell[BoxData[
  RowBox[{" ", 
   SubscriptBox["\[CapitalDelta]", "S"]}]]],
 " is the S-spin chemical shift, and ",
 StyleBox["J",
  FontSlant->"Italic"],
 " is the through-bond coupling between the I spin and the S spin.  The \
Evolve[] operator cannnot evolve the density operator all in one step, so we \
use the fact that all three terms in the above Hamiltonian commute with each \
other.  This commutation relationship allows us to evolve the density \
stepwise, by one of the operators at a time."
}], "Text",
 CellChangeTimes->{{3.671894041395768*^9, 3.671894173775732*^9}, {
  3.671894283373335*^9, 3.6718942839054127`*^9}, {3.6719250421219273`*^9, 
  3.671925057894815*^9}, {3.671925099182922*^9, 3.67192538710074*^9}, {
  3.671925533370783*^9, 3.671925541202483*^9}, {3.671925624419444*^9, 
  3.6719256267364264`*^9}, {3.671925684593628*^9, 3.671925688237563*^9}},
 FontSize->18],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "FreeEvolution", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FreeEvolution", "[", 
   RowBox[{"\[Rho]_", ",", "t_"}], "]"}], " ", ":=", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"\[Rho]", " ", "=", " ", 
    RowBox[{"density", " ", "operator"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"t", " ", "=", " ", 
    RowBox[{"time", " ", "[", "s", "]"}]}], " ", "*)"}], " ", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Rho]", " ", "//", " ", 
          RowBox[{
           RowBox[{"SimplifyingEvolver", "[", 
            RowBox[{
             RowBox[{"\[CapitalDelta]$I", " ", "Iz"}], ",", "t", ",", " ", 
             "#"}], "]"}], "&"}]}], " ", "//", " ", 
         RowBox[{
          RowBox[{"SimplifyingEvolver", "[", " ", 
           RowBox[{
            RowBox[{"\[CapitalDelta]$S", " ", "Sz"}], ",", "t", ",", " ", 
            "#"}], "]"}], "&"}]}], " ", "//", " ", 
        RowBox[{
         RowBox[{"SimplifyingEvolver", "[", " ", 
          RowBox[{
           RowBox[{"J", " ", 
            RowBox[{"Iz", "**", "Sz"}]}], ",", "t", ",", " ", "#"}], "]"}], 
         "&"}]}], ")"}], " ", "//", " ", "NCExpand"}], " ", "//", " ", 
     "MultSort"}], ")"}], " ", "//", " ", "NCExpand"}]}]}], "Input",
 CellChangeTimes->{{3.671877735591198*^9, 3.671877777960278*^9}, {
  3.67187818424365*^9, 3.671878184625901*^9}, {3.671889683947451*^9, 
  3.671889723854686*^9}, {3.671925059162591*^9, 3.671925096156954*^9}, {
  3.6719630336215677`*^9, 3.6719630425023947`*^9}, {3.6719631554075117`*^9, 
  3.6719631561733017`*^9}, {3.671963240022921*^9, 3.6719632503153048`*^9}},
 FontSize->16],

Cell["\<\
The FreeEvolution operator distrubutes over Plus, Times, and \
NoncommutativeMultiply.  Scalars in front of operators can be pulled out \
front.\
\>", "Text",
 CellChangeTimes->{{3.671924646481277*^9, 3.6719246493459263`*^9}, {
  3.671925651143633*^9, 3.671925658983102*^9}},
 FontSize->18],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FreeEvolution", "[", 
   RowBox[{"\[Rho]_Plus", ",", "t_"}], "]"}], " ", ":=", 
  RowBox[{"Plus", " ", "@@", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"FreeEvolution", "[", 
       RowBox[{"#", ",", "t"}], "]"}], "&"}], ")"}], " ", "/@", " ", 
    RowBox[{"List", " ", "@@", " ", "\[Rho]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FreeEvolution", "[", 
   RowBox[{"\[Rho]_Times", ",", "t_"}], "]"}], " ", ":=", 
  RowBox[{"Times", "@@", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"FreeEvolution", "[", 
       RowBox[{"#", ",", "t"}], "]"}], "&"}], ")"}], " ", "/@", " ", 
    RowBox[{"List", " ", "@@", " ", "\[Rho]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FreeEvolution", "[", 
   RowBox[{"\[Rho]_NonCommutativeMultiply", ",", "t_"}], "]"}], " ", ":=", 
  RowBox[{"NonCommutativeMultiply", " ", "@@", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"FreeEvolution", "[", 
       RowBox[{"#", ",", "t"}], "]"}], "&"}], ")"}], " ", "/@", " ", 
    RowBox[{"List", " ", "@@", " ", "\[Rho]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FreeEvolution", "[", 
   RowBox[{
    RowBox[{"Times", "[", 
     RowBox[{
      RowBox[{"a_", "?", "CommutativeQ"}], ",", "\[Rho]_"}], "]"}], ",", 
    "t_"}], "]"}], " ", ":=", " ", 
  RowBox[{"a", " ", 
   RowBox[{"FreeEvolution", "[", 
    RowBox[{"\[Rho]", ",", "t"}], "]"}]}]}]}], "Input",
 FontSize->16]
}, Open  ]],

Cell[CellGroupData[{

Cell["Load Spin 1/2 matrices", "Section",
 CellChangeTimes->{{3.6718779522899103`*^9, 3.671877960425688*^9}}],

Cell[BoxData[
 RowBox[{"<<", "Matrices--two-spin-half.m"}]], "Input",
 CellChangeTimes->{{3.671445490424717*^9, 3.6714454909529467`*^9}},
 FontSize->16],

Cell["\<\
This set of rules will substitute appropriate 4 x 4 matrices for the symbolic \
spin operators above. \
\>", "Text",
 CellChangeTimes->{{3.6718780024276733`*^9, 3.671878004427381*^9}},
 FontSize->18],

Cell[BoxData[
 RowBox[{
  RowBox[{"SubstituteSpinMatrices", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Ix", "\[Rule]", " ", "mIx"}], ",", 
     RowBox[{"Iy", "\[Rule]", " ", "mIy"}], ",", 
     RowBox[{"Iz", "\[Rule]", " ", "mIz"}], ",", 
     RowBox[{"Sx", "\[Rule]", " ", "mSx"}], ",", 
     RowBox[{"Sy", "\[Rule]", " ", "mSy"}], ",", 
     RowBox[{"Sz", "\[Rule]", " ", "mSz"}]}], "}"}]}], " ", ";"}]], "Input",
 FontSize->18]
}, Open  ]],

Cell[CellGroupData[{

Cell["Utility functions for one-dimensional data", "Section",
 CellChangeTimes->{{3.6718794064359694`*^9, 3.671879415291848*^9}, {
  3.671880018523059*^9, 3.6718800471106577`*^9}, {3.671925764434554*^9, 
  3.6719257748967113`*^9}}],

Cell["Make an array of time data", "Text",
 CellChangeTimes->{{3.671878645734527*^9, 3.671878678346408*^9}, {
  3.671925781469522*^9, 3.67192578386439*^9}},
 FontSize->18],

Cell[BoxData[
 RowBox[{
  RowBox[{"TimeArray", "[", 
   RowBox[{"NN_", ",", "T_"}], "]"}], " ", ":=", " ", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"NN", " ", "=", " ", 
    RowBox[{"number", " ", "of", " ", "points"}]}], "      ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"T", " ", "=", " ", 
    RowBox[{"total", " ", "acquisition", " ", "time"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dt", ",", "t"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dt", " ", "=", " ", 
      RowBox[{"T", "/", 
       RowBox[{"(", 
        RowBox[{"NN", "-", "1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"t", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"ii", "*", "dt"}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", "0", ",", 
          RowBox[{"NN", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "t", "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.671878683068866*^9, 3.671878800245549*^9}, {
  3.671878903403461*^9, 3.671878903841281*^9}, {3.671879226918907*^9, 
  3.671879260333274*^9}, {3.671879772710465*^9, 3.671879773045829*^9}},
 FontSize->18],

Cell["Print out the time step and the Nyquist frequency", "Text",
 CellChangeTimes->{{3.671878645734527*^9, 3.671878678346408*^9}, {
  3.671879180165639*^9, 3.671879204321514*^9}, {3.671925793925869*^9, 
  3.671925799312703*^9}},
 FontSize->18],

Cell[BoxData[
 RowBox[{
  RowBox[{"TimeArrayReport", "[", "t_", "]"}], ":=", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"t", " ", "=", " ", 
    RowBox[{"List", " ", "of", " ", "time", " ", "points"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "dt", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dt", " ", "=", " ", 
      RowBox[{
       RowBox[{"t", "[", 
        RowBox[{"[", "2", "]"}], "]"}], " ", "-", " ", 
       RowBox[{"t", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<The time step is \>\"", ",", "dt", ",", "\"\< s\>\""}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<The Nyquist frequency is \>\"", ",", 
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{"2", "*", "dt"}], ")"}]}], ",", "\"\< Hz\>\""}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6718790750566072`*^9, 3.671879152792118*^9}, {
  3.671879265062523*^9, 3.671879274937353*^9}},
 FontSize->18],

Cell["\<\
Calculate the digital Fourier transform of a one-dimensional time-domain \
signal and plot it.\
\>", "Text",
 CellChangeTimes->{{3.67145051013356*^9, 3.671450534424446*^9}, {
  3.671925803906604*^9, 3.671925826665345*^9}},
 FontSize->18],

Cell[BoxData[
 RowBox[{
  RowBox[{"DFFT", "[", 
   RowBox[{"signal_", ",", "t_", ",", " ", 
    RowBox[{"query_:", "True"}]}], "]"}], " ", ":=", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"signal", " ", "=", " ", 
    RowBox[{"A", " ", 
     StyleBox["function",
      FontSlant->"Italic"], " ", "that", " ", "computes", " ", "the", " ", 
     "signal"}]}], " ", "*)"}], "\[IndentingNewLine]", " ", 
  RowBox[{"(*", "      ", 
   RowBox[{"t", " ", "=", " ", 
    RowBox[{"A", " ", "list", " ", "of", " ", "time", " ", "points"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", " ", 
  RowBox[{"(*", "  ", 
   RowBox[{"query", " ", "=", " ", 
    RowBox[{"True", " ", "or", " ", "False"}]}], " ", "*)"}], "    ", 
  "\[IndentingNewLine]", " ", 
  RowBox[{"(*", "          ", 
   RowBox[{
    RowBox[{
    "True", " ", "to", " ", "plot", " ", "the", " ", "real", " ", "part"}], 
    ",", " ", 
    RowBox[{"imaginary", " ", "part"}], ",", " ", 
    RowBox[{"and", " ", "magnitude", " ", "of", " ", "the", " ", "FT"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", " ", 
  RowBox[{"(*", "          ", 
   RowBox[{
   "False", " ", "to", " ", "plot", " ", "only", " ", "the", " ", "real", " ",
     "part", " ", "of", " ", "the", " ", "FT"}], " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"NN", ",", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"number", " ", "of", " ", "data", " ", "points"}], " ", "*)"}],
       "\[IndentingNewLine]", "               ", "T", ",", "  ", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"total", " ", "acquisition", " ", "time"}], ";", " ", 
        RowBox[{
        "assumes", " ", "data", " ", "starts", " ", "at", " ", "zero"}]}], 
       " ", "*)"}], "\[IndentingNewLine]", "               ", "f"}], "      ", 
     RowBox[{"(*", " ", 
      RowBox[{"array", " ", "of", " ", "frequency", " ", "points"}], " ", 
      "*)"}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"NN", " ", "=", " ", 
      RowBox[{
       RowBox[{"Dimensions", "[", 
        RowBox[{"signal", " ", "/@", " ", "t"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"FFTS", " ", "=", " ", 
      RowBox[{"RotateRight", "[", 
       RowBox[{
        RowBox[{"Fourier", "[", 
         RowBox[{"signal", "/@", " ", "t"}], "]"}], ",", 
        RowBox[{"NN", "/", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"T", " ", "=", " ", 
      RowBox[{"t", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"f", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"jj", "/", "T"}], ",", 
        RowBox[{"{", 
         RowBox[{"jj", ",", 
          RowBox[{
           RowBox[{"-", "NN"}], "/", "2"}], ",", 
          RowBox[{
           RowBox[{"NN", "/", "2"}], "-", "1"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"p1", "=", " ", 
      RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"t", ",", 
             RowBox[{"Re", "[", 
              RowBox[{"signal", " ", "/@", " ", "t"}], "]"}]}], "}"}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"t", ",", 
             RowBox[{"Im", "[", 
              RowBox[{"signal", "/@", " ", "t"}], "]"}]}], "}"}], "]"}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"AxesLabel", "\[Rule]", " ", 
         RowBox[{"{", 
          RowBox[{"\"\<time [s]\>\"", ",", "\"\<signal\>\""}], "}"}]}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"query", " ", "\[Equal]", " ", "True"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"p2", "=", 
        RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{"f", ",", 
               RowBox[{"Re", "[", "FFTS", "]"}]}], "}"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{"f", ",", 
               RowBox[{"Im", "[", "FFTS", "]"}]}], "}"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{"f", ",", 
               RowBox[{"Abs", "[", "FFTS", "]"}]}], "}"}], "]"}]}], " ", 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"PlotRange", "\[Rule]", " ", "All"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<freq [Hz]\>\"", ",", "\"\<DFT{signal}\>\""}], 
            "}"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"p2", "=", 
        RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"f", ",", 
             RowBox[{"Re", "[", "FFTS", "]"}]}], "}"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"PlotRange", "\[Rule]", " ", "All"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<freq [Hz]\>\"", ",", "\"\<DFT{signal}\>\""}], 
            "}"}]}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{"GraphicsGrid", "[", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"p1", ",", "p2"}], "}"}], "}"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.594944534421811*^9, 3.5949447042651577`*^9}, {
   3.594944761549816*^9, 3.5949447856729527`*^9}, {3.5949457080553913`*^9, 
   3.594945725580372*^9}, 3.594957008065167*^9, {3.5949599090104303`*^9, 
   3.594959943126217*^9}, {3.671420918194263*^9, 3.671420985060692*^9}, {
   3.6714500698553047`*^9, 3.6714501975055017`*^9}, {3.671450354497389*^9, 
   3.671450368115725*^9}, {3.6714504102572317`*^9, 3.671450429646456*^9}, {
   3.6714507085616426`*^9, 3.671450719913899*^9}, {3.671450779304175*^9, 
   3.671450820615818*^9}, {3.6714508637422657`*^9, 3.671450868872673*^9}, {
   3.6714509162185383`*^9, 3.671450949134245*^9}, {3.6714510544854803`*^9, 
   3.671451069853394*^9}, {3.6718792844380093`*^9, 3.671879368113778*^9}, {
   3.671925835717597*^9, 3.6719258742851*^9}, {3.671925936992208*^9, 
   3.671926034878324*^9}, {3.671968479061063*^9, 3.6719685186359243`*^9}, {
   3.671970633853286*^9, 3.6719706378576927`*^9}, {3.671970687142659*^9, 
   3.6719706935478477`*^9}, {3.6719707976287947`*^9, 3.671970817673162*^9}},
 FontSize->18],

Cell["\<\
Calculate the digital Fourier transform of a one-dimensional time-domain \
signal and plot it.\
\>", "Text",
 CellChangeTimes->{{3.67145051013356*^9, 3.671450534424446*^9}, {
  3.671925803906604*^9, 3.671925826665345*^9}},
 FontSize->18],

Cell[BoxData[
 RowBox[{
  RowBox[{"DFFT$all", "[", 
   RowBox[{"signal_", ",", "t_"}], "]"}], " ", ":=", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"signal", " ", "=", " ", 
    RowBox[{"A", " ", 
     StyleBox["function",
      FontSlant->"Italic"], " ", "that", " ", "computes", " ", "the", " ", 
     "signal"}]}], " ", "*)"}], "\[IndentingNewLine]", " ", 
  RowBox[{"(*", "      ", 
   RowBox[{"t", " ", "=", " ", 
    RowBox[{"A", " ", "list", " ", "of", " ", "time", " ", "points"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", " ", 
  RowBox[{"(*", "  ", 
   RowBox[{"query", " ", "=", " ", 
    RowBox[{"True", " ", "or", " ", "False"}]}], " ", "*)"}], "    ", 
  "\[IndentingNewLine]", " ", 
  RowBox[{"(*", "          ", 
   RowBox[{
    RowBox[{
    "True", " ", "to", " ", "plot", " ", "the", " ", "real", " ", "part"}], 
    ",", " ", 
    RowBox[{"imaginary", " ", "part"}], ",", " ", 
    RowBox[{"and", " ", "magnitude", " ", "of", " ", "the", " ", "FT"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", " ", 
  RowBox[{"(*", "          ", 
   RowBox[{
   "False", " ", "to", " ", "plot", " ", "only", " ", "the", " ", "real", " ",
     "part", " ", "of", " ", "the", " ", "FT"}], " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"NN", ",", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"number", " ", "of", " ", "data", " ", "points"}], " ", "*)"}],
       "\[IndentingNewLine]", "               ", "T", ",", "  ", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"total", " ", "acquisition", " ", "time"}], ";", " ", 
        RowBox[{
        "assumes", " ", "data", " ", "starts", " ", "at", " ", "zero"}]}], 
       " ", "*)"}], "\[IndentingNewLine]", "               ", "f"}], "      ", 
     RowBox[{"(*", " ", 
      RowBox[{"array", " ", "of", " ", "frequency", " ", "points"}], " ", 
      "*)"}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"NN", " ", "=", " ", 
      RowBox[{
       RowBox[{"Dimensions", "[", 
        RowBox[{"signal", " ", "/@", " ", "t"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"FFTS", " ", "=", " ", 
      RowBox[{"RotateRight", "[", 
       RowBox[{
        RowBox[{"Fourier", "[", 
         RowBox[{"signal", "/@", " ", "t"}], "]"}], ",", 
        RowBox[{"NN", "/", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"T", " ", "=", " ", 
      RowBox[{"t", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"f", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"jj", "/", "T"}], ",", 
        RowBox[{"{", 
         RowBox[{"jj", ",", 
          RowBox[{
           RowBox[{"-", "NN"}], "/", "2"}], ",", 
          RowBox[{
           RowBox[{"NN", "/", "2"}], "-", "1"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"p1", "=", 
      RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{"f", ",", 
           RowBox[{"Re", "[", "FFTS", "]"}]}], "}"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"PlotRange", "\[Rule]", " ", "All"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"AxesLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<freq [Hz]\>\"", ",", "\"\<Re[DFT{signal}]\>\""}], 
          "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"p2", "=", 
      RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{"f", ",", 
           RowBox[{"Im", "[", "FFTS", "]"}]}], "}"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"PlotRange", "\[Rule]", " ", "All"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"AxesLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<freq [Hz]\>\"", ",", "\"\<Im[DFT{signal}]\>\""}], 
          "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"p3", "=", 
      RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{"f", ",", 
           RowBox[{"Abs", "[", "FFTS", "]"}]}], "}"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"PlotRange", "\[Rule]", " ", "All"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"AxesLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<freq [Hz]\>\"", ",", "\"\<Abs[DFT{signal}]\>\""}], 
          "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{"GraphicsGrid", "[", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"p1", ",", "p2", ",", "p3"}], "}"}], "}"}], "]"}], "]"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.594944534421811*^9, 3.5949447042651577`*^9}, {
   3.594944761549816*^9, 3.5949447856729527`*^9}, {3.5949457080553913`*^9, 
   3.594945725580372*^9}, 3.594957008065167*^9, {3.5949599090104303`*^9, 
   3.594959943126217*^9}, {3.671420918194263*^9, 3.671420985060692*^9}, {
   3.6714500698553047`*^9, 3.6714501975055017`*^9}, {3.671450354497389*^9, 
   3.671450368115725*^9}, {3.6714504102572317`*^9, 3.671450429646456*^9}, {
   3.6714507085616426`*^9, 3.671450719913899*^9}, {3.671450779304175*^9, 
   3.671450820615818*^9}, {3.6714508637422657`*^9, 3.671450868872673*^9}, {
   3.6714509162185383`*^9, 3.671450949134245*^9}, {3.6714510544854803`*^9, 
   3.671451069853394*^9}, {3.6718792844380093`*^9, 3.671879368113778*^9}, {
   3.671925835717597*^9, 3.6719258742851*^9}, {3.671925936992208*^9, 
   3.671926034878324*^9}, {3.671968479061063*^9, 3.6719685186359243`*^9}, {
   3.671970633853286*^9, 3.6719706378576927`*^9}, {3.671970687142659*^9, 
   3.6719706935478477`*^9}, {3.6719707976287947`*^9, 3.671970817673162*^9}, {
   3.67213616116146*^9, 3.6721362437379303`*^9}, {3.6721362836034946`*^9, 
   3.6721362872414103`*^9}, {3.6721364527386017`*^9, 3.672136468932028*^9}},
 FontSize->18]
}, Open  ]],

Cell[CellGroupData[{

Cell["Free-evolution signal", "Section",
 CellChangeTimes->{{3.671877788364067*^9, 3.671877801891901*^9}, {
   3.67193091232129*^9, 3.671930920025263*^9}, 3.671931208844771*^9}],

Cell["Edit the chemical shifts and the J-couplings here", "Text",
 FontSize->18,
 Background->RGBColor[1, 1, 0]],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "HamiltonianParameters$coupled", " ", "=", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[CapitalDelta]$I", "\[Rule]", " ", 
      RowBox[{"2", "\[Pi]", " ", "*", " ", "100"}]}], ",", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"I", "-", 
       RowBox[{"spin", " ", "chemical", " ", 
        RowBox[{"shift", " ", "[", "radians", "]"}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"\[CapitalDelta]$S", " ", "\[Rule]", " ", 
      RowBox[{"2", "\[Pi]", " ", "*", "300"}]}], ",", "  ", 
     RowBox[{"(*", " ", 
      RowBox[{"S", "-", 
       RowBox[{"spin", " ", "chemical", " ", 
        RowBox[{"shift", " ", "[", "radians", "]"}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"J", " ", "\[Rule]", 
      RowBox[{"2", "\[Pi]", " ", "*", " ", "50"}]}], ",", "        ", 
     RowBox[{"(*", " ", 
      RowBox[{"scalar", " ", 
       RowBox[{"coupling", " ", "[", "radians", "]"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"T2", " ", "->", " ", "0.3"}]}], "                ", 
    RowBox[{"(*", " ", 
     RowBox[{"spin", " ", "dephasing", " ", 
      RowBox[{"time", " ", "[", "s", "]"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", " ", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6718784052135963`*^9, 3.671878411230259*^9}, {
  3.6718899865391703`*^9, 3.6718899879822617`*^9}, {3.671893345336955*^9, 
  3.671893358339196*^9}, {3.671893432270978*^9, 3.671893433199575*^9}, {
  3.671893502024897*^9, 3.671893516017412*^9}, {3.671926065314743*^9, 
  3.6719260897642317`*^9}, {3.671926204655142*^9, 3.6719262049565563`*^9}, {
  3.6719263239631643`*^9, 3.671926440113193*^9}},
 FontSize->18,
 Background->GrayLevel[0.900008]],

Cell["\<\
Make a copy of the parameters with the scalar coupling set to zero, e.g., \
with the two spins uncoupled.  Useful for testing.\
\>", "Text",
 CellChangeTimes->{{3.671926459357728*^9, 3.671926507429882*^9}},
 FontSize->18],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "HamiltonianParameters$uncoupled", " ", "=", " ", 
   "HamiltonianParameters$coupled"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HamiltonianParameters$uncoupled", "[", 
    RowBox[{"[", "3", "]"}], "]"}], "  ", "=", " ", 
   RowBox[{"J", "\[Rule]", " ", "0"}]}], ";"}]}], "Input",
 FontSize->18],

Cell[TextData[{
 "Evolve the initial density operator ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["I", "x"], "+", 
    SubscriptBox["S", "x"]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " under the coupled-spin Hamiltonian.  Add an expontential decay so we get a \
reasonable looking signal.  Calculate the signal corresponding to observation \
of the complex signal (",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["I", "x"], "+", 
    SubscriptBox["S", "x"]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ") + I (",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["I", "y"], "+", 
    SubscriptBox["S", "xy"]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ") using the matrix form of the operators."
}], "Text",
 CellChangeTimes->{{3.671926609871134*^9, 3.6719267717859077`*^9}, {
  3.671926805754479*^9, 3.671926826367587*^9}},
 FontSize->18],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Rho]", " ", "=", " ", 
   RowBox[{
    RowBox[{"FreeEvolution", "[", 
     RowBox[{
      RowBox[{"Ix", " ", "+", " ", "Sx"}], ",", "t"}], "]"}], " ", 
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", "t"}], "/", "T2"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Signal", "[", "t_", "]"}], " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Tr", "[", 
      RowBox[{"\[Rho]", " ", ".", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Ix", " ", "+", " ", "Sx"}], ")"}], " ", "+", " ", 
         RowBox[{"I", " ", 
          RowBox[{"(", 
           RowBox[{"Iy", " ", "+", " ", "Sy"}], ")"}]}]}], ")"}]}], "]"}], 
     " ", "/.", " ", "\[IndentingNewLine]", "SubstituteSpinMatrices"}], " ", "/.",
     " ", "HamiltonianParameters$coupled"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6718778062706413`*^9, 3.671877871978508*^9}, {
  3.671878060162859*^9, 3.671878069913027*^9}, {3.6718783287908993`*^9, 
  3.671878354545123*^9}, {3.671926521847446*^9, 3.67192659098673*^9}},
 FontSize->18],

Cell["Create an array of 1024 time points.", "Text",
 CellChangeTimes->{{3.6719267775702467`*^9, 3.671926789124267*^9}, {
  3.671926831972439*^9, 3.671926853607119*^9}},
 FontSize->18],

Cell[BoxData[{
 RowBox[{
  RowBox[{"t$List", " ", "=", " ", 
   RowBox[{"TimeArray", "[", 
    RowBox[{
     RowBox[{"2", "^", "10"}], ",", "1.0"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"t$List", "  ", "//", " ", "TimeArrayReport"}]}], "Input",
 CellChangeTimes->{{3.671878809659215*^9, 3.671878851393158*^9}, {
  3.6718789144656487`*^9, 3.671878914874456*^9}, {3.671878946684762*^9, 
  3.6718789474033823`*^9}, {3.671879016941156*^9, 3.6718790191336823`*^9}, {
  3.671879463966322*^9, 3.671879520402073*^9}},
 FontSize->18],

Cell["\<\
Calculate the time-domain signal.  Fourier transform it to reveal the \
spectrum of the two coupled spins.\
\>", "Text",
 CellChangeTimes->{{3.6719268568921213`*^9, 3.6719269042170486`*^9}},
 FontSize->18],

Cell[BoxData[
 RowBox[{"DFFT", "[", 
  RowBox[{"Signal", ",", "t$List", ",", "True"}], "]"}]], "Input",
 CellChangeTimes->{{3.671878923786921*^9, 3.671878955234336*^9}, {
  3.67187903156674*^9, 3.6718790328034353`*^9}, {3.671879480142063*^9, 
  3.671879482371788*^9}, {3.671968450735117*^9, 3.6719684606398087`*^9}, {
  3.672135778917077*^9, 3.672135779491321*^9}},
 FontSize->18],

Cell["\<\
Let's plot the real, imaginary, and absolute value signals separately.  \
Notice how broad the  \
\>", "Text",
 CellChangeTimes->{{3.672138184827166*^9, 3.672138231470685*^9}},
 FontSize->18],

Cell[BoxData[
 RowBox[{"DFFT$all", "[", 
  RowBox[{"Signal", ",", "t$List"}], "]"}]], "Input",
 CellChangeTimes->{{3.672136259603026*^9, 3.672136261997446*^9}},
 FontSize->18],

Cell["\<\
Recalculate the signal with the spin-spin coupling dialed to zero.  Note how \
the doublet pattern in the spectrum vanishes.\
\>", "Text",
 CellChangeTimes->{{3.6719269354635553`*^9, 3.6719269775769243`*^9}},
 FontSize->18],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Rho]", " ", "=", " ", 
   RowBox[{
    RowBox[{"FreeEvolution", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Ix", "+", "Sx"}], ")"}], " ", ",", "t"}], "]"}], " ", 
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", "t"}], "/", "T2"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Signal", "[", "t_", "]"}], " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Tr", "[", 
      RowBox[{"\[Rho]", " ", ".", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Ix", " ", "+", " ", "Sx"}], ")"}], " ", "+", " ", 
         RowBox[{"I", " ", 
          RowBox[{"(", 
           RowBox[{"Iy", " ", "+", " ", "Sy"}], ")"}]}]}], ")"}]}], " ", 
      "]"}], " ", "/.", "  ", "SubstituteSpinMatrices"}], " ", "/.", " ", 
    "HamiltonianParameters$uncoupled"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"DFFT", "[", 
  RowBox[{"Signal", ",", "t$List", ",", "False"}], "]"}]}], "Input",
 CellChangeTimes->{{3.671890058520727*^9, 3.671890093220854*^9}},
 FontSize->18],

Cell[TextData[{
 "Evolve just ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["I", "x"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ".  We see just one of the doublets."
}], "Text",
 CellChangeTimes->{{3.671926991546083*^9, 3.671927063528008*^9}},
 FontSize->18],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Rho]", " ", "=", " ", 
   RowBox[{
    RowBox[{"FreeEvolution", "[", 
     RowBox[{"Ix", " ", ",", "t"}], "]"}], " ", 
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", "t"}], "/", "T2"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Signal", "[", "t_", "]"}], " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Tr", "[", 
      RowBox[{"\[Rho]", " ", ".", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Ix", " ", "+", " ", "Sx"}], ")"}], " ", "+", " ", 
         RowBox[{"I", " ", 
          RowBox[{"(", 
           RowBox[{"Iy", " ", "+", " ", "Sy"}], ")"}]}]}], ")"}]}], " ", 
      "]"}], " ", "/.", "  ", "SubstituteSpinMatrices"}], " ", "/.", " ", 
    "HamiltonianParameters$coupled"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"DFFT", "[", 
  RowBox[{"Signal", ",", "t$List", ",", "False"}], "]"}]}], "Input",
 CellChangeTimes->{{3.671879552920395*^9, 3.6718796083732033`*^9}, {
   3.6718798308195457`*^9, 3.671879835009947*^9}, {3.67189010920415*^9, 
   3.6718901116128597`*^9}, 3.671927043032271*^9},
 FontSize->18],

Cell[TextData[{
 "Evolve just ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["S", "x"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ".  See see just the other doublet."
}], "Text",
 CellChangeTimes->{{3.671926991546083*^9, 3.67192707818895*^9}},
 FontSize->18],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Rho]", " ", "=", " ", 
   RowBox[{
    RowBox[{"FreeEvolution", "[", 
     RowBox[{"Sx", " ", ",", "t"}], "]"}], " ", 
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", "t"}], "/", "T2"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Signal", "[", "t_", "]"}], " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Tr", "[", 
      RowBox[{"\[Rho]", " ", ".", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Ix", " ", "+", " ", "Sx"}], ")"}], " ", "+", " ", 
         RowBox[{"I", " ", 
          RowBox[{"(", 
           RowBox[{"Iy", " ", "+", " ", "Sy"}], ")"}]}]}], ")"}]}], " ", 
      "]"}], " ", "/.", "  ", "SubstituteSpinMatrices"}], " ", "/.", " ", 
    "HamiltonianParameters$coupled"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"DFFT", "[", 
  RowBox[{"Signal", ",", "t$List", ",", "False"}], "]"}]}], "Input",
 CellChangeTimes->{{3.671879828325494*^9, 3.671879870169961*^9}, {
   3.6718901173386097`*^9, 3.6718901188849373`*^9}, 3.671927093031798*^9, {
   3.671970717176458*^9, 3.671970717712057*^9}, {3.671970751675149*^9, 
   3.671970752300644*^9}},
 FontSize->18]
}, Open  ]],

Cell[CellGroupData[{

Cell["INEPT polarization transfer", "Section",
 CellChangeTimes->{{3.671894558571884*^9, 3.671894571280798*^9}, {
  3.671931193845932*^9, 3.6719311957679033`*^9}}],

Cell[TextData[{
 "Here INEPT is an acronym that stands for ",
 StyleBox["insensitive nuclei enhanced by polarization transfer",
  FontSlant->"Italic"],
 ".  Thinking through the INEPT experiment helps you understand how \
two-dimensional spectroscopy works.  \n\nThe INEPT experiment shows how a J \
coupling can be harnessed to transfer spin polarization from a nucleus with a \
large magnetic moment -- ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["\[InvisiblePrefixScriptBase]", "1"], 
    StyleBox["H",
     FontSlant->"Plain"]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ", the I-spin here -- to a nucleus with a small magnetic moment -- ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["\[InvisiblePrefixScriptBase]", "13"], 
    StyleBox["C",
     FontSlant->"Plain"]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ", the S-spin here.  At thermal equilibrium the initial density operator is\n\
\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Rho]", "equil"], "=", " ", 
    RowBox[{
     RowBox[{"a", " ", 
      SubscriptBox["I", "z"]}], "+", " ", 
     RowBox[{"b", " ", 
      SubscriptBox["S", "z"]}]}]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "\n\t\nwith ",
 StyleBox["a",
  FontSlant->"Italic"],
 " and ",
 StyleBox["b",
  FontSlant->"Italic"],
 " the Curie factors for each of the spins.  We worked through these \
Curie-law factors in detail on a homework.  To discuss the INEPT experiment \
it is enough to know that the factor b is about 1/16 the size of the a factor:"
}], "Text",
 CellChangeTimes->{{3.67192713595021*^9, 3.671927213545163*^9}, {
  3.671927255053945*^9, 3.671927305940894*^9}, {3.671928174600897*^9, 
  3.671928577836887*^9}, {3.671928610351489*^9, 3.671928617136512*^9}},
 FontSize->18],

Cell[BoxData[
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"SubstitutePrefactors", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a", " ", "\[Rule]", " ", "1"}], ",", "  ", 
      RowBox[{"b", "\[Rule]", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox["1", "4"], ")"}], "2"]}]}], "}"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.671927856381318*^9, 3.6719278888428907`*^9}, 
   3.671928613109912*^9},
 FontSize->16],

Cell[TextData[{
 "In other words, the thermal-equilibrium ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["\[InvisiblePrefixScriptBase]", "13"], 
    StyleBox["C",
     FontSlant->"Plain"]}], TraditionalForm]]],
 " signal is about 1/16 as large as the thermal-equilibrium ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["\[InvisiblePrefixScriptBase]", "1"], 
    StyleBox["H",
     FontSlant->"Plain"]}], TraditionalForm]]],
 " signal in a magnetic resonance experiment.  "
}], "Text",
 CellChangeTimes->{{3.671928591928565*^9, 3.671928597076543*^9}, {
  3.6719287486694593`*^9, 3.6719289996695843`*^9}},
 FontSize->18],

Cell[CellGroupData[{

Cell[TextData[{
 "The usual ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["\[InvisiblePrefixScriptBase]", "13"], 
    StyleBox["C",
     FontSlant->"Plain"]}], TraditionalForm]]],
 " spectrum"
}], "Subsection",
 CellChangeTimes->{{3.6719290067686377`*^9, 3.671929046666102*^9}}],

Cell[TextData[{
 "Let\[CloseCurlyQuote]s calculate the usual ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["\[InvisiblePrefixScriptBase]", "13"], 
    StyleBox["C",
     FontSlant->"Plain"]}], TraditionalForm]]],
 " signal.  Deliver a \[Pi]/2 pulse to the ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["\[InvisiblePrefixScriptBase]", "13"], 
    StyleBox["C",
     FontSlant->"Plain"]}], TraditionalForm]]],
 " spins and then evolve the spins under the Hamiltonian\n\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"H", " ", "=", "  ", 
    RowBox[{
     RowBox[{
      FormBox[
       SubscriptBox["\[CapitalDelta]", "I"],
       TraditionalForm], " ", 
      SubscriptBox["I", "z"]}], "+", " ", 
     RowBox[{
      SubscriptBox["\[CapitalDelta]", "S"], " ", 
      SubscriptBox["S", "z"]}], " ", "+", " ", 
     RowBox[{"J", " ", 
      SubscriptBox["I", "z"], 
      SubscriptBox["S", "z"]}]}]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "\n\t\nFor simplicity we will work on resonance where ",
 Cell[BoxData[
  RowBox[{
   FormBox[
    RowBox[{
     SubscriptBox["\[CapitalDelta]", "I"], "\[RightArrow]", "0"}],
    TraditionalForm], " "}]]],
 "and  ",
 Cell[BoxData[
  RowBox[{
   FormBox[
    SubscriptBox["\[CapitalDelta]", "S"],
    TraditionalForm], "\[RightArrow]", "0."}]]]
}], "Text",
 CellChangeTimes->{{3.671928591928565*^9, 3.671928597076543*^9}, {
  3.6719287486694593`*^9, 3.671929005834066*^9}, {3.671929053396553*^9, 
  3.671929057388837*^9}, {3.671929101341604*^9, 3.6719291013416443`*^9}},
 FontSize->18],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Rho]$0", "  ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"a", " ", "Iz"}], " ", "+", " ", 
     RowBox[{"b", " ", "Sz"}]}], "//", "  ", 
    RowBox[{
     RowBox[{"PulseS", "[", 
      RowBox[{"#", ",", 
       RowBox[{"\[Pi]", "/", "2"}], ",", 
       RowBox[{"\[Pi]", "/", "2"}]}], "]"}], "&"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"\[Rho]$1", " ", "=", " ", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"\[Rho]$0", " ", "//", "  ", 
      RowBox[{
       RowBox[{"FreeEvolution", "[", 
        RowBox[{"#", ",", "t"}], "]"}], "&"}]}], "  ", "//", " ", 
     "NCExpand"}], ")"}], " ", "/.", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[CapitalDelta]$I", "\[Rule]", " ", "0"}], ",", 
     RowBox[{"\[CapitalDelta]$S", "\[Rule]", " ", "0"}]}], 
    "}"}]}]}]}], "Input",
 CellChangeTimes->{
  3.671894887871954*^9, {3.6718956707762423`*^9, 3.671895671663657*^9}, {
   3.671896898653215*^9, 3.671896899382049*^9}, {3.671897521305914*^9, 
   3.671897543198839*^9}, {3.67189776888809*^9, 3.671897769086577*^9}, {
   3.671897893950562*^9, 3.6718978993615923`*^9}, 3.6719273142720547`*^9, {
   3.671927352447545*^9, 3.6719273568931513`*^9}, {3.671927404413039*^9, 
   3.671927408445538*^9}, 3.671927442572917*^9, {3.67192759422403*^9, 
   3.671927659964732*^9}, {3.6719276908032627`*^9, 3.6719276955998983`*^9}, {
   3.671927829301469*^9, 3.67192784071618*^9}},
 FontSize->16],

Cell[TextData[{
 "We detect the complex magnetization and Fourier transform it to obtain the ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["\[InvisiblePrefixScriptBase]", "13"], 
    StyleBox["C",
     FontSlant->"Plain"]}], TraditionalForm]]],
 " spectrum."
}], "Text",
 CellChangeTimes->{{3.671929074833055*^9, 3.671929108684803*^9}},
 FontSize->18],

Cell[BoxData[
 RowBox[{
  RowBox[{"Signal", "[", "t_", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Tr", "[", 
       RowBox[{"\[Rho]$1", ".", 
        RowBox[{"(", 
         RowBox[{"Sx", " ", "+", " ", 
          RowBox[{"I", " ", "Sy"}]}], ")"}]}], "]"}], " ", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "t"}], "/", "T2"}], "]"}]}], "/.", " ", 
     "SubstituteSpinMatrices"}], "  ", "/.", " ", 
    "HamiltonianParameters$coupled"}], " ", "/.", 
   "SubstitutePrefactors"}]}]], "Input",
 CellChangeTimes->{{3.671927850116914*^9, 3.6719278701482983`*^9}, 
   3.67192790017627*^9},
 FontSize->16],

Cell[BoxData[
 RowBox[{"DFFT", "[", 
  RowBox[{"Signal", ",", "t$List", ",", "False"}], "]"}]], "Input",
 FontSize->16],

Cell["\<\
The spectum shows a symmetric doublet, due the J-coupling, that is centered \
near zero frequency.  The height of each peak in the specrum is approximately \
~0.28.\
\>", "Text",
 CellChangeTimes->{{3.671929136026559*^9, 3.671929219557954*^9}},
 FontSize->18]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "The ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["\[InvisiblePrefixScriptBase]", "13"], 
    StyleBox["C",
     FontSlant->"Plain"]}], TraditionalForm]]],
 " spectrum following polarization transfer from ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["\[InvisiblePrefixScriptBase]", "1"], 
    StyleBox["H",
     FontSlant->"Plain"]}], TraditionalForm]]],
 " "
}], "Subsection",
 CellChangeTimes->{{3.6719290067686377`*^9, 3.671929046666102*^9}, {
  3.671929248802558*^9, 3.671929278764144*^9}}],

Cell[TextData[{
 "The INEPT experiment consists of a string of pulses applied to the I-spins \
and the S-spins.  \n\n\t I spins: ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      RowBox[{"\[Pi]", "/", "2"}], ")"}], "y"], "-", "\[Tau]", "-", 
    SubscriptBox[
     RowBox[{"(", "\[Pi]", ")"}], "x"], "-", "\[Tau]", "-", 
    SubscriptBox[
     RowBox[{"(", 
      RowBox[{"\[Pi]", "/", "2"}], ")"}], "x"]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "\n\tS spins: ",
 Cell[BoxData[
  FormBox[
   RowBox[{"                            ", 
    RowBox[{
     SubscriptBox[
      RowBox[{"(", "\[Pi]", ")"}], "x"], "-", "\[Tau]", "-", 
     SubscriptBox[
      RowBox[{"(", 
       RowBox[{"\[Pi]", "/", "2"}], ")"}], "y"], "-", "detect"}]}], 
   TraditionalForm]]],
 "\n\nwith the time delay set to \[Tau] = 2\[Pi] / (4 ",
 StyleBox["J",
  FontSlant->"Italic"],
 "), with ",
 StyleBox["J",
  FontSlant->"Italic"],
 " the scalar coupling.  Now let\[CloseCurlyQuote]s calculate the usual ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["\[InvisiblePrefixScriptBase]", "13"], 
    StyleBox["C",
     FontSlant->"Plain"]}], TraditionalForm]]],
 " signal following the INEPT polarization-transfer sequence.  For simplicity \
we will again work on resonance where ",
 Cell[BoxData[
  RowBox[{
   FormBox[
    RowBox[{
     SubscriptBox["\[CapitalDelta]", "I"], "\[RightArrow]", "0"}],
    TraditionalForm], " "}]]],
 "and  ",
 Cell[BoxData[
  RowBox[{
   FormBox[
    SubscriptBox["\[CapitalDelta]", "S"],
    TraditionalForm], "\[RightArrow]", "0."}]]],
 "  in the calculation below I print out the density operator at each step in \
the evolution."
}], "Text",
 CellChangeTimes->{{3.671928591928565*^9, 3.671928597076543*^9}, {
  3.6719287486694593`*^9, 3.671929005834066*^9}, {3.671929053396553*^9, 
  3.671929057388837*^9}, {3.671929101341604*^9, 3.6719291013416443`*^9}, {
  3.671929303002233*^9, 3.671929613724959*^9}},
 FontSize->18],

Cell[BoxData[{
 RowBox[{"\[Rho]$0", "  ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"a", " ", "Iz"}], " ", "+", " ", 
    RowBox[{"b", " ", "Sz"}]}], "//", "  ", 
   RowBox[{
    RowBox[{"PulseI", "[", 
     RowBox[{"#", ",", 
      RowBox[{"\[Pi]", "/", "2"}], ",", 
      RowBox[{"\[Pi]", "/", "2"}]}], "]"}], 
    "&"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"\[Rho]$1", " ", "=", " ", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"\[Rho]$0", " ", "//", "  ", 
      RowBox[{
       RowBox[{"FreeEvolution", "[", 
        RowBox[{"#", ",", "t"}], "]"}], "&"}]}], "  ", "//", " ", 
     "NCExpand"}], ")"}], " ", "/.", " ", 
   RowBox[{"{", 
    RowBox[{"\[CapitalDelta]$I", "\[Rule]", " ", "0"}], 
    "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"\[Rho]$2", " ", "=", " ", 
  RowBox[{
   RowBox[{"\[Rho]$1", " ", "//", "  ", 
    RowBox[{
     RowBox[{"PulseI", "[", 
      RowBox[{"#", ",", "0", ",", "\[Pi]"}], "]"}], "&"}]}], " ", "//", "  ", 
   
   RowBox[{
    RowBox[{"PulseS", "[", 
     RowBox[{"#", ",", "0", ",", "\[Pi]"}], "]"}], " ", 
    "&"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]$3", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Rho]$2", " ", "//", "  ", 
       RowBox[{
        RowBox[{"FreeEvolution", "[", 
         RowBox[{"#", ",", "t"}], "]"}], "&"}]}], "  ", "//", " ", 
      "NCExpand"}], ")"}], " ", "/.", " ", 
    RowBox[{"{", 
     RowBox[{"\[CapitalDelta]$I", "\[Rule]", " ", "0"}], "}"}]}]}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{"\[Rho]$4", " ", "=", " ", 
  RowBox[{
   RowBox[{"\[Rho]$3", " ", "//", "  ", 
    RowBox[{
     RowBox[{"PulseI", "[", 
      RowBox[{"#", ",", "0", ",", 
       RowBox[{"\[Pi]", "/", "2"}]}], "]"}], "&"}]}], " ", "//", "  ", 
   RowBox[{
    RowBox[{"PulseS", "[", 
     RowBox[{"#", ",", 
      RowBox[{"\[Pi]", "/", "2"}], ",", 
      RowBox[{"\[Pi]", "/", "2"}]}], "]"}], " ", "&"}]}]}]}], "Input",
 CellChangeTimes->{{3.6718968880439243`*^9, 3.6718969524440727`*^9}, {
  3.671897032206025*^9, 3.671897046650464*^9}, {3.671897204722954*^9, 
  3.6718973152312098`*^9}, {3.671897447305798*^9, 3.671897494886711*^9}},
 FontSize->16],

Cell[TextData[{
 "The signal in the \[OpenCurlyDoubleQuote]regular\[CloseCurlyDoubleQuote] \
experiment arose from the term \n\n\t",
 Cell[BoxData[
  RowBox[{"b", " ", "Sx", " ", 
   RowBox[{"Cos", "[", 
    FractionBox[
     RowBox[{"J", " ", "t"}], "2"], "]"}]}]],
  CellChangeTimes->{3.671927906329776*^9},
  FontSize->16],
 " \n\t\nin the density operator.  After the series of pulses in the INEPT \
experiment we now have a term in the density operator given by \n\n\t",
 Cell[BoxData[
  RowBox[{
   RowBox[{"4", " ", "a", " ", 
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{"J", " ", "t"}], "2"], "]"}], " ", 
    RowBox[{"Iz", "**", "Sx"}], " ", 
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"J", " ", "t"}], "2"], "]"}]}], "\[RightArrow]", 
   RowBox[{"2", " ", "a", " ", 
    RowBox[{"Iz", "**", "Sx"}]}]}]],
  CellChangeTimes->{{3.671897290448884*^9, 3.671897318647407*^9}, 
    3.6718974957149878`*^9, 3.671926274808988*^9, 3.6719263064016457`*^9, 
    3.671927462557098*^9},
  FontSize->16]
}], "Text",
 CellChangeTimes->{{3.671929983682289*^9, 3.671930025398354*^9}, {
  3.6719300670315847`*^9, 3.671930136013072*^9}, {3.671930214310153*^9, 
  3.671930238234023*^9}},
 FontSize->18],

Cell[TextData[{
 "where the term following the arrow is what we get by setting the delay time \
to 2 \[Pi]/(4 ",
 StyleBox["J",
  FontSlant->"Italic"],
 ").    This term arose from the ",
 StyleBox["initial I-spin signal",
  FontSlant->"Italic"],
 " evolving under the spin-spin coupling to give a ",
 StyleBox["mixed I-spin & S-spin signal",
  FontSlant->"Italic"],
 ".  Further evolution under the ",
 StyleBox["J",
  FontSlant->"Italic"],
 " coupling Hamiltonian will give rise a a ",
 StyleBox["pure S-spin signal",
  FontSlant->"Italic"],
 ".    "
}], "Text",
 CellChangeTimes->{{3.671929679776863*^9, 3.671929734673861*^9}, {
  3.6719300283127527`*^9, 3.671930035311207*^9}, {3.671930125234267*^9, 
  3.671930144046606*^9}, {3.671930192463664*^9, 3.6719302063730507`*^9}, {
  3.671930242543427*^9, 3.6719304284876223`*^9}, {3.671930459396369*^9, 
  3.671930460318253*^9}},
 FontSize->18],

Cell[BoxData[
 RowBox[{"\[Rho]$5", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Rho]$4", "  ", "/.", " ", 
     RowBox[{"{", 
      RowBox[{"t", "\[Rule]", " ", 
       RowBox[{"2", " ", 
        RowBox[{"\[Pi]", "/", 
         RowBox[{"(", 
          RowBox[{"4", " ", "J"}], ")"}]}]}]}], "}"}]}], " ", "//", " ", 
    RowBox[{
     RowBox[{"FreeEvolution", "[", 
      RowBox[{"#", ",", "t"}], "]"}], "&"}]}], "  ", "//", " ", "NCExpand", 
   " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Why", " ", "is", " ", "an", " ", "extra", " ", "NCExpand", " ", "needed",
      " ", 
     RowBox[{"here", "?"}]}], " ", "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.671897328718656*^9, 3.671897341318771*^9}, {
   3.671897503862351*^9, 3.671897504112216*^9}, {3.6718975870222588`*^9, 
   3.671897595144972*^9}, {3.671897800030439*^9, 3.671897802751381*^9}, 
   3.671963095423436*^9, {3.671963134468152*^9, 3.6719631376188498`*^9}, {
   3.671963209374254*^9, 3.671963226473454*^9}, {3.671963276848936*^9, 
   3.671963375084201*^9}},
 FontSize->16],

Cell[TextData[{
 "Remarkably,",
 StyleBox[" ",
  FontColor->RGBColor[1, 0.5, 0]],
 StyleBox["the ",
  FontWeight->"Bold",
  FontColor->RGBColor[1, 0.5, 0]],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["\[InvisiblePrefixScriptBase]", "13"], 
    StyleBox["C",
     FontSlant->"Plain"]}], TraditionalForm]],
  FontWeight->"Bold",
  FontColor->RGBColor[1, 0.5, 0]],
 StyleBox[" signal is now approximately 16x larger",
  FontWeight->"Bold",
  FontColor->RGBColor[1, 0.5, 0]],
 ".  This signal increase corresonds to a ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["16", "2"], "="}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " 256-fold savings in signal averaging time."
}], "Text",
 CellChangeTimes->{{3.6719297393833017`*^9, 3.6719299051187763`*^9}, {
  3.6719633616707907`*^9, 3.671963362378067*^9}},
 FontSize->18],

Cell[BoxData[
 RowBox[{
  RowBox[{"Signal", "[", "t_", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Tr", "[", 
        RowBox[{"\[Rho]$5", ".", 
         RowBox[{"(", 
          RowBox[{"Sx", " ", "+", " ", 
           RowBox[{"I", " ", "Sy"}]}], ")"}]}], "]"}], " ", 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", "t"}], "/", "T2"}], "]"}]}], "/.", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[CapitalDelta]$I", "\[Rule]", " ", "0"}], ",", 
        RowBox[{"\[CapitalDelta]$S", "\[Rule]", " ", "0"}]}], "}"}]}], " ", "/.",
      " ", "SubstituteSpinMatrices"}], "  ", "/.", " ", 
    "HamiltonianParameters$coupled"}], " ", "/.", " ", 
   "SubstitutePrefactors"}]}]], "Input",
 CellChangeTimes->{{3.6719277375221233`*^9, 3.671927764941704*^9}, {
  3.671927937526128*^9, 3.671927942191386*^9}},
 FontSize->16],

Cell[BoxData[
 RowBox[{"DFFT", "[", 
  RowBox[{"Signal", ",", "t$List", ",", "False"}], "]"}]], "Input",
 CellChangeTimes->{{3.671928661319326*^9, 3.671928673340681*^9}},
 FontSize->16]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Utility functions for two-dimensional data", "Section",
 CellChangeTimes->{{3.6718794064359694`*^9, 3.671879415291848*^9}, {
  3.671880018523059*^9, 3.6718800471106577`*^9}, {3.671925764434554*^9, 
  3.6719257748967113`*^9}, {3.671930943790674*^9, 3.67193094526243*^9}}],

Cell[CellGroupData[{

Cell["Function to take the 2D Fourier Transform", "Subsection",
 CellChangeTimes->{{3.6719639282030687`*^9, 3.671963944704712*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DFFT2", "[", 
   RowBox[{"signal_", ",", "t1_", ",", " ", "t2_", ",", " ", 
    RowBox[{"query_:", "False"}]}], "]"}], " ", ":=", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"signal", " ", "=", " ", 
    RowBox[{"A", " ", 
     StyleBox["function",
      FontSlant->"Italic"], " ", "that", " ", "computes", " ", "the", " ", 
     "signal"}]}], " ", "*)"}], "\[IndentingNewLine]", " ", 
  RowBox[{"(*", "     ", 
   RowBox[{"t1", " ", "=", " ", 
    RowBox[{"A", " ", "list", " ", "of", " ", "time", " ", "points"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", " ", 
  RowBox[{"(*", "     ", 
   RowBox[{"t2", " ", "=", " ", 
    RowBox[{"A", " ", "list", " ", "of", " ", "time", " ", "points"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", " ", 
  RowBox[{"(*", "  ", 
   RowBox[{
    RowBox[{"query", " ", "=", " ", 
     RowBox[{"True", " ", "or", " ", "False"}]}], ",", " ", 
    RowBox[{
    "whether", " ", "to", " ", "print", " ", "out", " ", "diagnostic", " ", 
     "messages"}]}], " ", "*)"}], " ", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"t1$NN", ",", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "number", " ", "of", " ", "time", " ", "points", " ", "in", " ", 
         "the", " ", "indirect"}], ",", " ", 
        RowBox[{"t1", " ", "dimension"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "             ", "t2$NN", ",", "  ", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "number", " ", "of", " ", "time", " ", "points", " ", "in", " ", 
         "the", " ", "direct"}], ",", " ", 
        RowBox[{"t2", " ", "dimension"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "             ", "f1", ",", "         ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "the", " ", "frequency", " ", "axis", " ", "in", " ", "the", " ", 
        "indirect", " ", "dimension"}], " ", "*)"}], "\[IndentingNewLine]", 
      "             ", "f2"}], "             ", 
     RowBox[{"(*", " ", 
      RowBox[{
      "the", " ", "frequency", " ", "axis", " ", "in", " ", "the", " ", 
       "indirect", " ", "dimension"}], " ", "*)"}], "\[IndentingNewLine]", 
     "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"Too", " ", 
        RowBox[{"fancy", ":", " ", "signal$List"}]}], " ", "=", " ", 
       RowBox[{"Outer", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"N", "[", 
           RowBox[{"signal", "[", 
            RowBox[{"#1", ",", "#2"}], "]"}], "]"}], "&"}], ",", "t1", ",", 
         "t2"}], "]"}]}], ";"}], " ", "*)"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"t1$NN", " ", "=", " ", 
      RowBox[{
       RowBox[{"Dimensions", "[", "t1", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"t2$NN", " ", "=", " ", 
      RowBox[{
       RowBox[{"Dimensions", "[", "t2", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"signal$List", "  ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"signal", "[", 
          RowBox[{
           RowBox[{"t1", "[", 
            RowBox[{"[", "i$1", "]"}], "]"}], ",", 
           RowBox[{"t2", "[", 
            RowBox[{"[", "i$2", "]"}], "]"}]}], "]"}], " ", "//", " ", "N"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i$2", ",", "1", ",", "t2$NN"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i$1", ",", "1", ",", "t1$NN"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"query", " ", "\[Equal]", " ", "True"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Number of t1 points = \>\"", ",", "t1$NN"}], "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Number of t2 points = \>\"", ",", "t2$NN"}], "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Dimensions of signal$List = \>\"", ",", 
          RowBox[{"Dimensions", "[", "signal$List", " ", "]"}]}], "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"signal$List$FT", " ", "=", " ", 
      RowBox[{"RotateLeft", "[", 
       RowBox[{
        RowBox[{"Fourier", "[", "signal$List", " ", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"t2$NN", "/", "2"}], ",", 
          RowBox[{"t1$NN", "/", "2"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"f1", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"jj", "/", 
         RowBox[{"t1", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"jj", ",", 
          RowBox[{
           RowBox[{"-", "t1$NN"}], "/", "2"}], ",", 
          RowBox[{
           RowBox[{"t1$NN", "/", "2"}], "-", "1"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"f2", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"jj", "/", 
         RowBox[{"t2", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"jj", ",", 
          RowBox[{
           RowBox[{"-", "t2$NN"}], "/", "2"}], ",", 
          RowBox[{
           RowBox[{"t2$NN", "/", "2"}], "-", "1"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"SetOptions", "[", 
      RowBox[{"ListPlot3D", ",", "\[IndentingNewLine]", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", "\[IndentingNewLine]", 
       RowBox[{"DataRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"f1", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"f1", "[", 
             RowBox[{"[", "t1$NN", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"f2", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"f2", "[", 
             RowBox[{"[", "t2$NN", "]"}], "]"}]}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PlotLabel", "\[Rule]", "\"\<2D spectrum\\n\\n\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Mesh", "\[Rule]", "False"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"p1", "=", 
      RowBox[{"ListPlot3D", "[", 
       RowBox[{
        RowBox[{"Re", "[", "signal$List$FT", " ", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"AxesLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<f1 [Hz]\>\"", ",", "\"\<f2 [Hz]\>\"", ",", 
           "\"\<Re[FT[signal(\!\(\*SubscriptBox[\(t\), \
\(1\)]\),\!\(\*SubscriptBox[\(t\), \(2\)]\))]]\>\""}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ViewPoint", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"1.561`", ",", 
           RowBox[{"-", "2.881`"}], ",", "0.845`"}], "}"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"p2", "=", 
      RowBox[{"ListPlot3D", "[", 
       RowBox[{
        RowBox[{"Im", "[", "signal$List$FT", " ", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"AxesLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<f1 [Hz]\>\"", ",", "\"\<f2 [Hz]\>\"", ",", 
           
           "\"\<Im[FT[signal(\!\(\*SubscriptBox[\(t\), \
\(1\)]\),\!\(\*SubscriptBox[\(t\), \(2\)]\))]]\>\""}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ViewPoint", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"1.561`", ",", 
           RowBox[{"-", "2.881`"}], ",", "0.845`"}], "}"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"p3", "=", 
      RowBox[{"ListPlot3D", "[", 
       RowBox[{
        RowBox[{"Abs", "[", "signal$List$FT", " ", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"AxesLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<f1 [Hz]\>\"", ",", "\"\<f2 [Hz]\>\"", ",", 
           "\"\<Abs[FT[signal(\!\(\*SubscriptBox[\(t\), \
\(1\)]\),\!\(\*SubscriptBox[\(t\), \(2\)]\))]]\>\""}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ViewPoint", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"1.561`", ",", 
           RowBox[{"-", "2.881`"}], ",", "0.845`"}], "}"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{"p1", ",", "p2", ",", "p3"}], "}"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.67193290920819*^9, 3.6719330377265368`*^9}, {
   3.671933142753436*^9, 3.671933162376494*^9}, {3.6719333041758547`*^9, 
   3.6719333080361967`*^9}, {3.6719333479495993`*^9, 3.671933365500202*^9}, {
   3.671933400528564*^9, 3.6719335352625093`*^9}, {3.671933581091715*^9, 
   3.671933602951006*^9}, {3.671933731987199*^9, 3.671933788458231*^9}, {
   3.6719338474435177`*^9, 3.671933864022208*^9}, {3.671934014299584*^9, 
   3.671934200366333*^9}, {3.671934265028734*^9, 3.671934270339427*^9}, {
   3.6719343010252123`*^9, 3.67193430320455*^9}, {3.671959590875065*^9, 
   3.671959598587652*^9}, {3.671959804931814*^9, 3.6719599764517*^9}, {
   3.671960018737183*^9, 3.67196008004738*^9}, 3.671960273199786*^9, {
   3.671960321213346*^9, 3.6719603709863653`*^9}, 3.67196042847437*^9, {
   3.6719604955694523`*^9, 3.671960498458959*^9}, {3.671960536231584*^9, 
   3.671960539830352*^9}, {3.671961011715127*^9, 3.6719610159290247`*^9}, {
   3.671962015017626*^9, 3.671962023511508*^9}, {3.6719627029769278`*^9, 
   3.671962742127977*^9}, {3.671964563929368*^9, 3.6719645721762667`*^9}, {
   3.6719646033103333`*^9, 3.671964611915827*^9}, {3.67196470667852*^9, 
   3.671964728583891*^9}, {3.671964767280039*^9, 3.671964795968655*^9}, {
   3.671964850957272*^9, 3.671965099947947*^9}},
 FontSize->16]
}, Open  ]],

Cell[CellGroupData[{

Cell["Test case #1", "Subsection",
 CellChangeTimes->{{3.671963950365428*^9, 3.6719639568018723`*^9}, {
  3.671965345676228*^9, 3.671965351356316*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"t1$List", "=", " ", 
   RowBox[{"TimeArray", "[", 
    RowBox[{
     RowBox[{"2", "^", "6"}], ",", "0.25"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t2$List", "=", " ", 
   RowBox[{"TimeArray", "[", 
    RowBox[{
     RowBox[{"2", "^", "7"}], ",", "0.50"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.671964302001038*^9, 3.67196431130612*^9}, {
  3.671964388838485*^9, 3.671964389310945*^9}, {3.671965118720688*^9, 
  3.671965120125567*^9}, {3.671965246291473*^9, 3.671965246683483*^9}},
 FontSize->16],

Cell[BoxData[{
 RowBox[{"t1$List", "  ", "//", " ", 
  "TimeArrayReport"}], "\[IndentingNewLine]", 
 RowBox[{"t2$List", "  ", "//", " ", "TimeArrayReport"}]}], "Input",
 FontSize->16],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Signal2D", "[", 
    RowBox[{"t1_", ",", "t2_"}], "]"}], " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", "2", " ", "\[Pi]", " ", "100", " ", "t1"}], 
      "]"}], "  ", 
     RowBox[{"Exp", "[", 
      RowBox[{"I", " ", "2", " ", "\[Pi]", " ", "50", " ", "t2"}], "]"}], " ", 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", "t1"}], "/", "0.08"}], " ", "]"}], " ", 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", "t2"}], "/", "0.15"}], "]"}]}], " ", "+", " ", "0.05"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"p1", ",", "p2", ",", "p3"}], "}"}], " ", "=", " ", 
    RowBox[{"DFFT2", "[", 
     RowBox[{"Signal2D", ",", "t1$List", ",", "t2$List", ",", " ", "True"}], 
     "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", "p3"}], "Input",
 CellChangeTimes->{{3.671963999366246*^9, 3.6719640344474707`*^9}, {
   3.6719640677091312`*^9, 3.671964185961536*^9}, {3.6719642177147837`*^9, 
   3.671964247057164*^9}, {3.671964400643404*^9, 3.671964404849866*^9}, 
   3.6719644407232723`*^9, {3.671964635376355*^9, 3.671964639130764*^9}, {
   3.6719651603045177`*^9, 3.671965236765723*^9}, {3.67196528052987*^9, 
   3.6719652895975027`*^9}, 3.6719653341987143`*^9, {3.671965380029688*^9, 
   3.671965455271617*^9}, {3.671965593957251*^9, 3.6719655946398697`*^9}},
 FontSize->16]
}, Open  ]],

Cell[CellGroupData[{

Cell["Test Case #2", "Subsection",
 CellChangeTimes->{{3.671965356378434*^9, 3.6719653613619003`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"t1$List", "=", " ", 
   RowBox[{"TimeArray", "[", 
    RowBox[{
     RowBox[{"2", "^", "9"}], ",", "0.25"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t2$List", "=", " ", 
    RowBox[{"TimeArray", "[", 
     RowBox[{
      RowBox[{"2", "^", "6"}], ",", "0.50"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"t1$List", "  ", "//", " ", 
  "TimeArrayReport"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t2$List", "  ", "//", " ", "TimeArrayReport"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Signal2D", "[", 
    RowBox[{"t1_", ",", "t2_"}], "]"}], " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", "2", " ", "\[Pi]", "  ", "300", " ", "t1"}], 
      "]"}], "  ", 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", "2", " ", "\[Pi]", "  ", "30", " ", "t2"}], 
      "]"}], " ", 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", "t1"}], "/", "0.05"}], " ", "]"}], " ", 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", "t2"}], "/", "0.10"}], "]"}]}], " ", "+", " ", "0.05"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"p1", ",", "p2", ",", "p3"}], "}"}], " ", "=", " ", 
    RowBox[{"DFFT2", "[", 
     RowBox[{"Signal2D", ",", "t1$List", ",", "t2$List", ",", " ", "True"}], 
     "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", "p3"}], "Input",
 CellChangeTimes->{{3.671963999366246*^9, 3.6719640344474707`*^9}, {
   3.6719640677091312`*^9, 3.671964185961536*^9}, {3.6719642177147837`*^9, 
   3.671964247057164*^9}, {3.671964400643404*^9, 3.671964404849866*^9}, 
   3.6719644407232723`*^9, {3.671964635376355*^9, 3.671964639130764*^9}, {
   3.6719651603045177`*^9, 3.671965236765723*^9}, {3.67196528052987*^9, 
   3.671965331690147*^9}, {3.671965498611329*^9, 3.671965537537755*^9}, {
   3.671965569428731*^9, 3.6719655820492573`*^9}, {3.67196563709977*^9, 
   3.6719656758534822`*^9}},
 FontSize->16]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Heteronuclear COSY signal", "Section",
 CellChangeTimes->{{3.6718800638033447`*^9, 3.671880072138873*^9}, {
   3.671930934282226*^9, 3.671930938702942*^9}, 3.671968604647366*^9},
 FontSize->24],

Cell["This is the signal that we worked out in class", "Text",
 CellChangeTimes->{{3.671968609825365*^9, 3.671968618588675*^9}},
 FontSize->18],

Cell[CellGroupData[{

Cell["Set the couplings and number of points", "Subsection",
 CellChangeTimes->{{3.671961125575214*^9, 3.671961141177919*^9}}],

Cell["Edit the chemical shifts and the J-couplings here", "Text",
 FontSize->18,
 Background->RGBColor[1, 1, 0]],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "HamiltonianParameters$coupled", " ", "=", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[CapitalDelta]$I", "\[Rule]", " ", 
      RowBox[{"2", "\[Pi]", " ", "*", " ", "100"}]}], ",", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"I", "-", 
       RowBox[{"spin", " ", "chemical", " ", 
        RowBox[{"shift", " ", "[", "radians", "]"}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"\[CapitalDelta]$S", " ", "\[Rule]", " ", 
      RowBox[{"2", "\[Pi]", " ", "*", "150"}]}], ",", "  ", 
     RowBox[{"(*", " ", 
      RowBox[{"S", "-", 
       RowBox[{"spin", " ", "chemical", " ", 
        RowBox[{"shift", " ", "[", "radians", "]"}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"J", " ", "\[Rule]", 
      RowBox[{"2", "\[Pi]", " ", "*", " ", "40"}]}], ",", "        ", 
     RowBox[{"(*", " ", 
      RowBox[{"scalar", " ", 
       RowBox[{"coupling", " ", "[", "radians", "]"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"T2", " ", "->", " ", "0.10"}]}], "             ", 
    RowBox[{"(*", " ", 
     RowBox[{"spin", " ", "dephasing", " ", 
      RowBox[{"time", " ", "[", "s", "]"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", " ", "}"}]}], ";"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQA2IQfeLqsoTe6NeOHnHpiSD6kUMgx2QgvSGvHkyHndBa
MwVIb7p1ai2IvrWaYzuIfp2kBqa/nj6wH0Qv6Ws4CKIThLSWLQHS00osVoLo
N9+mbAfRMnPmgWm7S3XHQLT7fOarIJpnabjESiA960yQFIj+UfN1z1Yg7amn
vBdEb3offQVEf7vaA6aTt528B6KFDp8H06saj38E0aFZep9A9DP35VbbgPSO
IlZbEL0ntakaRGvfFasB0aunHOfcAaSjl10F09t2SfmC6Oaq3f4g+oSDTjiI
1uKuiQHRz15OTATzdRaBaWWhl247gfSVeeLuIPq39zRfEP3PeReY3rDw8FMQ
rRD6HkwDAEi/vzU=
  "],
 FontSize->16,
 Background->GrayLevel[0.900008]],

Cell["Edit the number of points at the total acquisition time here", "Text",
 CellChangeTimes->{{3.671935003456821*^9, 3.671935014639059*^9}},
 FontSize->18,
 Background->RGBColor[1, 1, 0]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"t1$List", "=", " ", 
   RowBox[{"TimeArray", "[", 
    RowBox[{
     RowBox[{"2", "^", "7"}], ",", "0.25"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t2$List", "=", " ", 
   RowBox[{"TimeArray", "[", 
    RowBox[{
     RowBox[{"2", "^", "7"}], ",", "0.25"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.671932531775362*^9, 3.671932558418375*^9}, {
   3.671932615125964*^9, 3.671932624373652*^9}, 3.671933087559319*^9, {
   3.6719335444862022`*^9, 3.6719335494129143`*^9}, {3.6719336086423903`*^9, 
   3.671933610588026*^9}, {3.6719336478538837`*^9, 3.671933650406972*^9}, {
   3.6719336917141457`*^9, 3.671933693399531*^9}, {3.6719338845339003`*^9, 
   3.671933885891416*^9}, {3.6719343541751137`*^9, 3.671934355746716*^9}, {
   3.671934409104306*^9, 3.671934415234016*^9}, {3.671934459376684*^9, 
   3.671934491924694*^9}, {3.671934532996088*^9, 3.671934543210248*^9}, {
   3.671934774264757*^9, 3.6719347827671223`*^9}, {3.671960216255967*^9, 
   3.671960234716063*^9}, {3.671960441836606*^9, 3.671960442409441*^9}, {
   3.67196127955404*^9, 3.67196131850441*^9}, {3.67196642584122*^9, 
   3.671966426356633*^9}, {3.671969585303156*^9, 3.6719695911194887`*^9}},
 FontSize->16,
 Background->GrayLevel[0.85]],

Cell["\<\
Make a copy of the parameters with the scalar coupling set to zero, e.g., \
with the two spins uncoupled.  Useful for testing.\
\>", "Text",
 CellChangeTimes->{{3.671926459357728*^9, 3.671926507429882*^9}},
 FontSize->18],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "HamiltonianParameters$uncoupled", " ", "=", " ", 
   "HamiltonianParameters$coupled"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HamiltonianParameters$uncoupled", "[", 
    RowBox[{"[", "3", "]"}], "]"}], "  ", "=", " ", 
   RowBox[{"J", "\[Rule]", " ", "0"}]}], ";"}]}], "Input",
 FontSize->18]
}, Open  ]],

Cell[CellGroupData[{

Cell["Some checks", "Subsection",
 CellChangeTimes->{{3.671961163155218*^9, 3.671961173753989*^9}}],

Cell["Check out the Nyquist frequencies", "Text",
 CellChangeTimes->{{3.671959676120822*^9, 3.671959692378523*^9}},
 FontSize->16],

Cell[BoxData[{
 RowBox[{"t1$List", "  ", "//", " ", 
  "TimeArrayReport"}], "\[IndentingNewLine]", 
 RowBox[{"t2$List", "  ", "//", " ", "TimeArrayReport"}]}], "Input",
 CellChangeTimes->{{3.671959650984557*^9, 3.671959663832185*^9}},
 FontSize->16]
}, Open  ]],

Cell[CellGroupData[{

Cell["Evolve the density operator", "Subsection",
 CellChangeTimes->{{3.671961177397146*^9, 3.671961192586527*^9}}],

Cell["\<\
Compute evolution.  This computation takes a couple of seconds.\
\>", "Text",
 CellChangeTimes->{{3.671935019629524*^9, 3.671935034174068*^9}, {
  3.6719605645133953`*^9, 3.6719605705526447`*^9}},
 FontSize->18],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]$0", " ", "=", " ", 
    RowBox[{"Iz", "+", " ", "Sz"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Initial", " ", 
    RowBox[{"(", 
     RowBox[{"\[Pi]", "/", "2"}], ")"}], "y", " ", "pulse"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]$1$A", " ", "=", " ", 
    RowBox[{"\[Rho]$0", " ", "//", " ", 
     RowBox[{
      RowBox[{"PulseS", "[", 
       RowBox[{"#", ",", 
        RowBox[{"\[Pi]", "/", "2"}], ",", 
        RowBox[{"\[Pi]", "/", "2"}]}], "]"}], "&"}]}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]$2$A", " ", "=", " ", 
   RowBox[{"\[Rho]$1$A", " ", "//", "  ", 
    RowBox[{
     RowBox[{"FreeEvolution", "[", 
      RowBox[{"#", ",", "t1"}], "]"}], "&"}]}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]$3$A", " ", "=", " ", 
    RowBox[{
     RowBox[{"\[Rho]$2$A", "  ", "//", " ", 
      RowBox[{
       RowBox[{"PulseS", "[", 
        RowBox[{"#", ",", 
         RowBox[{"\[Pi]", "/", "2"}], ",", 
         RowBox[{"\[Pi]", "/", "2"}]}], "]"}], "&"}]}], " ", "//", " ", 
     RowBox[{
      RowBox[{"PulseI", "[", 
       RowBox[{"#", ",", 
        RowBox[{"\[Pi]", "/", "2"}], ",", 
        RowBox[{"\[Pi]", "/", "2"}]}], "]"}], "&"}]}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]$4$A", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Rho]$3$A", " ", "//", "  ", 
       RowBox[{
        RowBox[{"FreeEvolution", "[", 
         RowBox[{"#", ",", "t2"}], "]"}], "&"}]}], " ", "//", " ", 
      "NCExpand"}], " ", "//", " ", "MultSort"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Initial", " ", 
    RowBox[{"(", 
     RowBox[{"\[Pi]", "/", "2"}], ")"}], "x", " ", "pulse"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]$1$B", " ", "=", " ", 
    RowBox[{"\[Rho]$0", " ", "//", " ", 
     RowBox[{
      RowBox[{"PulseS", "[", 
       RowBox[{"#", ",", "0", ",", 
        RowBox[{"\[Pi]", "/", "2"}]}], "]"}], "&"}]}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]$2$B", " ", "=", " ", 
   RowBox[{"\[Rho]$1$B", " ", "//", "  ", 
    RowBox[{
     RowBox[{"FreeEvolution", "[", 
      RowBox[{"#", ",", "t1"}], "]"}], "&"}]}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]$3$B", " ", "=", " ", 
    RowBox[{
     RowBox[{"\[Rho]$2$B", "  ", "//", " ", 
      RowBox[{
       RowBox[{"PulseS", "[", 
        RowBox[{"#", ",", 
         RowBox[{"\[Pi]", "/", "2"}], ",", 
         RowBox[{"\[Pi]", "/", "2"}]}], "]"}], "&"}]}], " ", "//", " ", 
     RowBox[{
      RowBox[{"PulseI", "[", 
       RowBox[{"#", ",", 
        RowBox[{"\[Pi]", "/", "2"}], ",", 
        RowBox[{"\[Pi]", "/", "2"}]}], "]"}], "&"}]}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]$4$B", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Rho]$3$B", " ", "//", "  ", 
      RowBox[{
       RowBox[{"FreeEvolution", "[", 
        RowBox[{"#", ",", "t2"}], "]"}], "&"}]}], " ", "//", " ", 
     "NCExpand"}], " ", "//", " ", "MultSort"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.671880359452848*^9, 3.671880405654752*^9}, 
   3.6718805922056723`*^9, {3.671880654857966*^9, 3.671880658456214*^9}, {
   3.671890253281252*^9, 3.671890258732644*^9}, {3.671890514052863*^9, 
   3.671890531652615*^9}, {3.6718938201845903`*^9, 3.6718938368617887`*^9}, {
   3.671930954705418*^9, 3.671931017275107*^9}, 3.671931151058281*^9, {
   3.671934630648226*^9, 3.671934631703808*^9}, {3.671934668462163*^9, 
   3.671934668773761*^9}, {3.6719605559094963`*^9, 3.671960557480361*^9}, {
   3.671960621069422*^9, 3.671960621963992*^9}, {3.6719606859333878`*^9, 
   3.671960725034295*^9}, {3.671960833371766*^9, 3.671960835934683*^9}, {
   3.671960886232214*^9, 3.671960907062376*^9}, 3.6719609456733513`*^9, {
   3.671961074334423*^9, 3.671961080525428*^9}, {3.6719622809344807`*^9, 
   3.6719622908226767`*^9}, {3.6719624324839697`*^9, 3.671962441605382*^9}, {
   3.67196292873599*^9, 3.6719629321760273`*^9}, {3.67196299885725*^9, 
   3.671963002474958*^9}, {3.671963410249606*^9, 3.671963434808103*^9}, {
   3.67196348159336*^9, 3.6719634969874287`*^9}, {3.671963786339136*^9, 
   3.671963786485096*^9}, {3.6719659113954678`*^9, 3.671966018770185*^9}, {
   3.671966147940074*^9, 3.671966150638332*^9}, {3.671966243701359*^9, 
   3.6719662661919518`*^9}, {3.6719665328095007`*^9, 3.67196656405721*^9}, {
   3.6719670380983047`*^9, 3.67196704626505*^9}, {3.671967523270999*^9, 
   3.671967526955697*^9}, {3.671968168673579*^9, 3.671968191966599*^9}},
 FontSize->16]
}, Open  ]],

Cell[CellGroupData[{

Cell["Examine the two signals and combine them", "Subsection",
 CellChangeTimes->{{3.671968201171743*^9, 3.67196821820794*^9}}],

Cell[BoxData[
 RowBox[{"(", 
  RowBox[{
   RowBox[{
    RowBox[{"Tr", "[", 
     RowBox[{"\[Rho]$4$A", " ", ".", 
      RowBox[{"(", 
       RowBox[{"Ix", " ", "+", " ", 
        RowBox[{"I", " ", "Iy"}]}], ")"}]}], "]"}], " ", "/.", " ", 
    "SubstituteSpinMatrices"}], "  ", "//", " ", "Simplify"}], " ", 
  ")"}]], "Input",
 CellChangeTimes->{{3.671966565437508*^9, 3.671966742743554*^9}, {
  3.671967437765218*^9, 3.67196743891486*^9}, {3.671967807199925*^9, 
  3.671967807702455*^9}, {3.671967845292038*^9, 3.6719678458043613`*^9}},
 FontSize->16],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"Tr", "[", 
      RowBox[{"\[Rho]$4$B", " ", ".", 
       RowBox[{"(", 
        RowBox[{"Ix", " ", "+", " ", 
         RowBox[{"I", " ", "Iy"}]}], ")"}]}], "]"}], " ", "/.", " ", 
     "SubstituteSpinMatrices"}], "  ", "//", " ", "Simplify"}], " ", ")"}], 
  " "}]], "Input",
 CellChangeTimes->{{3.671966786581603*^9, 3.671966786801403*^9}, 
   3.6719674296774*^9, {3.6719678097780857`*^9, 3.671967809981552*^9}, {
   3.671967848651556*^9, 3.671967849761945*^9}},
 FontSize->16],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Rho]$4", " ", "=", " ", 
   RowBox[{
    RowBox[{"-", "\[Rho]$4$A"}], " ", "+", " ", 
    RowBox[{"I", " ", "\[Rho]$4$B"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"(", 
  RowBox[{
   RowBox[{
    RowBox[{"Tr", "[", 
     RowBox[{"\[Rho]$4", " ", ".", 
      RowBox[{"(", 
       RowBox[{"Ix", " ", "+", " ", 
        RowBox[{"I", " ", "Iy"}]}], ")"}]}], "]"}], " ", "/.", " ", 
    "SubstituteSpinMatrices"}], "  ", "//", " ", "Simplify"}], " ", 
  ")"}]}], "Input",
 CellChangeTimes->{{3.671966853423469*^9, 3.671966980704862*^9}, {
  3.671968224737483*^9, 3.6719682320550337`*^9}},
 FontSize->16]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute the signal and apply the 2D FT", "Subsection",
 CellChangeTimes->{{3.671961195103389*^9, 3.671961211402051*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Signal2D", "[", 
    RowBox[{"t1_", ",", "t2_"}], "]"}], " ", "=", " ", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Tr", "[", 
          RowBox[{"\[Rho]$4", ".", 
           RowBox[{"(", 
            RowBox[{"Ix", " ", "+", " ", 
             RowBox[{"I", " ", "Iy"}]}], ")"}]}], "]"}], " ", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "t1"}], "/", "T2"}], "]"}], " ", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "t2"}], "/", "T2"}], "]"}]}], " ", "+", "0.025"}], "/.",
        "\[IndentingNewLine]", " ", "SubstituteSpinMatrices"}], " ", "/.", 
      " ", "\[IndentingNewLine]", "HamiltonianParameters$coupled"}], " ", "//",
      " ", "Simplify"}], " ", "//", " ", "N"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6719618553997602`*^9, 3.671961858187746*^9}, {
  3.671961957632979*^9, 3.671961968850966*^9}, {3.671962139492156*^9, 
  3.6719621396800413`*^9}, {3.6719635232842913`*^9, 3.671963533673254*^9}, {
  3.671963790457479*^9, 3.671963799378996*^9}, {3.6719657459183607`*^9, 
  3.671965746041649*^9}, {3.671965813218071*^9, 3.671965834051178*^9}, {
  3.6719697122958813`*^9, 3.671969713353312*^9}, {3.671970916017273*^9, 
  3.67197092928715*^9}},
 FontSize->16],

Cell["Fourier transform the signal.   This takes a minute or so.", "Text",
 CellChangeTimes->{{3.671935044258762*^9, 3.6719350524686747`*^9}, {
  3.671960577588045*^9, 3.6719605998631897`*^9}, {3.671960645960691*^9, 
  3.6719606557175407`*^9}, {3.671963564552681*^9, 3.671963573311535*^9}},
 FontSize->18],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"p1", ",", "p2", ",", "p3"}], "}"}], " ", "=", " ", 
   RowBox[{"DFFT2", "[", 
    RowBox[{"Signal2D", ",", "t1$List", ",", "t2$List"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.671881660314452*^9, 3.671881683505583*^9}, {
   3.671881715652314*^9, 3.671881723794434*^9}, {3.6718901308991117`*^9, 
   3.671890140126958*^9}, {3.67189019665511*^9, 3.671890196829525*^9}, {
   3.671892971354268*^9, 3.6718929714678288`*^9}, {3.671893026070917*^9, 
   3.6718930261749077`*^9}, 3.671932589687904*^9, 3.671934659488551*^9, {
   3.671934731891508*^9, 3.671934732059461*^9}, {3.671935155580461*^9, 
   3.671935158165567*^9}, {3.671960115925538*^9, 3.6719601445045347`*^9}, {
   3.671960183219754*^9, 3.671960207693185*^9}, {3.671960293139372*^9, 
   3.671960298605274*^9}, {3.671960405949394*^9, 3.671960409397332*^9}, {
   3.671960615957674*^9, 3.671960718647657*^9}, {3.671962184757069*^9, 
   3.671962225500497*^9}},
 FontSize->16],

Cell[BoxData[{"p1", "\[IndentingNewLine]", "p3"}], "Input",
 CellChangeTimes->{{3.671962500316848*^9, 3.6719625005187073`*^9}, {
  3.671965857173787*^9, 3.671965878944346*^9}, {3.671966185507186*^9, 
  3.6719661952099857`*^9}, {3.671966284602901*^9, 3.6719662849153223`*^9}, {
  3.6719680746628847`*^9, 3.6719680749207172`*^9}, {3.671968246334671*^9, 
  3.671968246554215*^9}, {3.671968287970796*^9, 3.6719682893213367`*^9}},
 FontSize->16]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Homonuclear COSY signal", "Section",
 CellChangeTimes->{{3.6718800638033447`*^9, 3.671880072138873*^9}, {
   3.671930934282226*^9, 3.671930938702942*^9}, 3.671968604647366*^9, {
   3.671968817454822*^9, 3.671968818712557*^9}},
 FontSize->24],

Cell[TextData[{
 "This is the signal you get if you pulse and detect ",
 StyleBox["both",
  FontSlant->"Italic"],
 " nuclei at the same time."
}], "Text",
 CellChangeTimes->{{3.671968609825365*^9, 3.671968618588675*^9}, {
  3.671968832325036*^9, 3.67196885962831*^9}, {3.671969388538517*^9, 
  3.671969390079811*^9}},
 FontSize->18],

Cell[CellGroupData[{

Cell["Set the couplings and number of points", "Subsection",
 CellChangeTimes->{{3.671961125575214*^9, 3.671961141177919*^9}}],

Cell["Edit the chemical shifts and the J-couplings here", "Text",
 FontSize->18,
 Background->RGBColor[1, 1, 0]],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "HamiltonianParameters$coupled", " ", "=", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[CapitalDelta]$I", "\[Rule]", " ", 
      RowBox[{"2", "\[Pi]", " ", "*", " ", "50"}]}], ",", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"I", "-", 
       RowBox[{"spin", " ", "chemical", " ", 
        RowBox[{"shift", " ", "[", "radians", "]"}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"\[CapitalDelta]$S", " ", "\[Rule]", " ", 
      RowBox[{"2", "\[Pi]", " ", "*", "150"}]}], ",", "  ", 
     RowBox[{"(*", " ", 
      RowBox[{"S", "-", 
       RowBox[{"spin", " ", "chemical", " ", 
        RowBox[{"shift", " ", "[", "radians", "]"}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"J", " ", "\[Rule]", 
      RowBox[{"2", "\[Pi]", " ", "*", " ", "23"}]}], ",", "        ", 
     RowBox[{"(*", " ", 
      RowBox[{"scalar", " ", 
       RowBox[{"coupling", " ", "[", "radians", "]"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"T2", " ", "->", " ", "0.10"}]}], "              ", 
    RowBox[{"(*", " ", 
     RowBox[{"spin", " ", "dephasing", " ", 
      RowBox[{"time", " ", "[", "s", "]"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", " ", "}"}]}], ";"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAGIQfeLqsoTe6NeOHnHpiSD6kUMgx2QgvSGvHkyHndBa
MwVIb7p1ai2IvrWaYzuIfp2kBqa/nj6wH0Qv6Ws4CKIThLSWLQHS00osVoLo
N9+mbAfRMnPmgWm7S3XHQLT7fOarIJpnabjESiA960yQFIj+UfN1z1Yg7amn
vBdEb3offQVEf7vaA6aTt528B6KFDp8H06saj38E0aFZep9A9DP35VbbgPSO
IlZbEL0ntakaRGvfFasB0aunHOfcAaSjl10F09t2SfmC6Oaq3f4g+oSDTjiI
1uKuiQHRz15OTATzdRaBaWWhl247gfSVeeLuIPq39zRfEP3PeReYTjfneQii
970RAtMBj/6L7ALSJTWnxUD04lu96iC6q+wdmAYAITnPfQ==
  "],
 FontSize->16,
 Background->GrayLevel[0.900008]],

Cell["Edit the number of points at the total acquisition time here", "Text",
 CellChangeTimes->{{3.671935003456821*^9, 3.671935014639059*^9}},
 FontSize->18,
 Background->RGBColor[1, 1, 0]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"t1$List", "=", " ", 
   RowBox[{"TimeArray", "[", 
    RowBox[{
     RowBox[{"2", "^", "7"}], ",", "0.25"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t2$List", "=", " ", 
   RowBox[{"TimeArray", "[", 
    RowBox[{
     RowBox[{"2", "^", "7"}], ",", "0.25"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.671932531775362*^9, 3.671932558418375*^9}, {
   3.671932615125964*^9, 3.671932624373652*^9}, 3.671933087559319*^9, {
   3.6719335444862022`*^9, 3.6719335494129143`*^9}, {3.6719336086423903`*^9, 
   3.671933610588026*^9}, {3.6719336478538837`*^9, 3.671933650406972*^9}, {
   3.6719336917141457`*^9, 3.671933693399531*^9}, {3.6719338845339003`*^9, 
   3.671933885891416*^9}, {3.6719343541751137`*^9, 3.671934355746716*^9}, {
   3.671934409104306*^9, 3.671934415234016*^9}, {3.671934459376684*^9, 
   3.671934491924694*^9}, {3.671934532996088*^9, 3.671934543210248*^9}, {
   3.671934774264757*^9, 3.6719347827671223`*^9}, {3.671960216255967*^9, 
   3.671960234716063*^9}, {3.671960441836606*^9, 3.671960442409441*^9}, {
   3.67196127955404*^9, 3.67196131850441*^9}, {3.67196642584122*^9, 
   3.671966426356633*^9}, {3.671969537559432*^9, 3.671969542240697*^9}},
 FontSize->16,
 Background->GrayLevel[0.85]],

Cell["\<\
Make a copy of the parameters with the scalar coupling set to zero, e.g., \
with the two spins uncoupled.  Useful for testing.\
\>", "Text",
 CellChangeTimes->{{3.671926459357728*^9, 3.671926507429882*^9}},
 FontSize->18],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "HamiltonianParameters$uncoupled", " ", "=", " ", 
   "HamiltonianParameters$coupled"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HamiltonianParameters$uncoupled", "[", 
    RowBox[{"[", "3", "]"}], "]"}], "  ", "=", " ", 
   RowBox[{"J", "\[Rule]", " ", "0"}]}], ";"}]}], "Input",
 FontSize->18]
}, Open  ]],

Cell[CellGroupData[{

Cell["Some checks", "Subsection",
 CellChangeTimes->{{3.671961163155218*^9, 3.671961173753989*^9}}],

Cell["Check out the Nyquist frequencies", "Text",
 CellChangeTimes->{{3.671959676120822*^9, 3.671959692378523*^9}},
 FontSize->16],

Cell[BoxData[{
 RowBox[{"t1$List", "  ", "//", " ", 
  "TimeArrayReport"}], "\[IndentingNewLine]", 
 RowBox[{"t2$List", "  ", "//", " ", "TimeArrayReport"}]}], "Input",
 CellChangeTimes->{{3.671959650984557*^9, 3.671959663832185*^9}},
 FontSize->16]
}, Open  ]],

Cell[CellGroupData[{

Cell["Evolve the density operator", "Subsection",
 CellChangeTimes->{{3.671961177397146*^9, 3.671961192586527*^9}}],

Cell["Compute evolution.  This computationcan take up to a minute.", "Text",
 CellChangeTimes->{{3.671935019629524*^9, 3.671935034174068*^9}, {
  3.6719605645133953`*^9, 3.6719605705526447`*^9}, {3.671969287167769*^9, 
  3.6719692919639597`*^9}},
 FontSize->18],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]$0", " ", "=", " ", 
    RowBox[{"Iz", "+", " ", "Sz"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Initial", " ", 
    RowBox[{"(", 
     RowBox[{"\[Pi]", "/", "2"}], ")"}], "y", " ", "pulses"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]$1$A", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"\[Rho]$0", " ", "//", " ", 
        RowBox[{
         RowBox[{"PulseS", "[", 
          RowBox[{"#", ",", 
           RowBox[{"\[Pi]", "/", "2"}], ",", 
           RowBox[{"\[Pi]", "/", "2"}]}], "]"}], "&"}]}], " ", "//", " ", 
       RowBox[{
        RowBox[{"PulseI", "[", 
         RowBox[{"#", ",", 
          RowBox[{"\[Pi]", "/", "2"}], ",", 
          RowBox[{"\[Pi]", "/", "2"}]}], "]"}], "&"}]}], " ", "//", " ", 
      "NCExpand"}], " ", "//", " ", "MultSort"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]$2$A", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Rho]$1$A", " ", "//", "  ", 
      RowBox[{
       RowBox[{"FreeEvolution", "[", 
        RowBox[{"#", ",", "t1"}], "]"}], "&"}]}], " ", "//", " ", 
     "NCExpand"}], " ", "//", " ", "MultSort"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]$3$A", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"\[Rho]$2$A", "  ", "//", " ", 
        RowBox[{
         RowBox[{"PulseS", "[", 
          RowBox[{"#", ",", 
           RowBox[{"\[Pi]", "/", "2"}], ",", 
           RowBox[{"\[Pi]", "/", "2"}]}], "]"}], "&"}]}], " ", "//", " ", 
       RowBox[{
        RowBox[{"PulseI", "[", 
         RowBox[{"#", ",", 
          RowBox[{"\[Pi]", "/", "2"}], ",", 
          RowBox[{"\[Pi]", "/", "2"}]}], "]"}], "&"}]}], " ", "//", " ", 
      "NCExpand"}], " ", "//", " ", "MultSort"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]$4$A", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Rho]$3$A", " ", "//", "  ", 
       RowBox[{
        RowBox[{"FreeEvolution", "[", 
         RowBox[{"#", ",", "t2"}], "]"}], "&"}]}], " ", "//", " ", 
      "NCExpand"}], " ", "//", " ", "MultSort"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Initial", " ", 
    RowBox[{"(", 
     RowBox[{"\[Pi]", "/", "2"}], ")"}], "x", " ", "pulses"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]$1$B", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"\[Rho]$0", " ", "//", " ", 
        RowBox[{
         RowBox[{"PulseS", "[", 
          RowBox[{"#", ",", "0", ",", 
           RowBox[{"\[Pi]", "/", "2"}]}], "]"}], "&"}]}], " ", "//", "  ", 
       RowBox[{
        RowBox[{"PulseI", "[", 
         RowBox[{"#", ",", "0", ",", 
          RowBox[{"\[Pi]", "/", "2"}]}], "]"}], "&"}]}], " ", "//", " ", 
      "NCExpand"}], " ", "//", " ", "MultSort"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]$2$B", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Rho]$1$B", " ", "//", "  ", 
      RowBox[{
       RowBox[{"FreeEvolution", "[", 
        RowBox[{"#", ",", "t1"}], "]"}], "&"}]}], " ", "//", " ", 
     "NCExpand"}], " ", "//", " ", "MultSort"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]$3$B", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"\[Rho]$2$B", "  ", "//", " ", 
        RowBox[{
         RowBox[{"PulseS", "[", 
          RowBox[{"#", ",", 
           RowBox[{"\[Pi]", "/", "2"}], ",", 
           RowBox[{"\[Pi]", "/", "2"}]}], "]"}], "&"}]}], " ", "//", " ", 
       RowBox[{
        RowBox[{"PulseI", "[", 
         RowBox[{"#", ",", 
          RowBox[{"\[Pi]", "/", "2"}], ",", 
          RowBox[{"\[Pi]", "/", "2"}]}], "]"}], "&"}]}], " ", "//", " ", 
      "NCExpand"}], " ", "//", " ", "MultSort"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]$4$B", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Rho]$3$B", " ", "//", "  ", 
      RowBox[{
       RowBox[{"FreeEvolution", "[", 
        RowBox[{"#", ",", "t2"}], "]"}], "&"}]}], " ", "//", " ", 
     "NCExpand"}], " ", "//", " ", "MultSort"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.671880359452848*^9, 3.671880405654752*^9}, 
   3.6718805922056723`*^9, {3.671880654857966*^9, 3.671880658456214*^9}, {
   3.671890253281252*^9, 3.671890258732644*^9}, {3.671890514052863*^9, 
   3.671890531652615*^9}, {3.6718938201845903`*^9, 3.6718938368617887`*^9}, {
   3.671930954705418*^9, 3.671931017275107*^9}, 3.671931151058281*^9, {
   3.671934630648226*^9, 3.671934631703808*^9}, {3.671934668462163*^9, 
   3.671934668773761*^9}, {3.6719605559094963`*^9, 3.671960557480361*^9}, {
   3.671960621069422*^9, 3.671960621963992*^9}, {3.6719606859333878`*^9, 
   3.671960725034295*^9}, {3.671960833371766*^9, 3.671960835934683*^9}, {
   3.671960886232214*^9, 3.671960907062376*^9}, 3.6719609456733513`*^9, {
   3.671961074334423*^9, 3.671961080525428*^9}, {3.6719622809344807`*^9, 
   3.6719622908226767`*^9}, {3.6719624324839697`*^9, 3.671962441605382*^9}, {
   3.67196292873599*^9, 3.6719629321760273`*^9}, {3.67196299885725*^9, 
   3.671963002474958*^9}, {3.671963410249606*^9, 3.671963434808103*^9}, {
   3.67196348159336*^9, 3.6719634969874287`*^9}, {3.671963786339136*^9, 
   3.671963786485096*^9}, {3.6719659113954678`*^9, 3.671966018770185*^9}, {
   3.671966147940074*^9, 3.671966150638332*^9}, {3.671966243701359*^9, 
   3.6719662661919518`*^9}, {3.6719665328095007`*^9, 3.67196656405721*^9}, {
   3.6719670380983047`*^9, 3.67196704626505*^9}, {3.671967523270999*^9, 
   3.671967526955697*^9}, {3.671968168673579*^9, 3.671968191966599*^9}, {
   3.6719689148129387`*^9, 3.6719689635398207`*^9}, {3.671969093344201*^9, 
   3.671969105614452*^9}},
 FontSize->16]
}, Open  ]],

Cell[CellGroupData[{

Cell["Examine the two signals and combine them", "Subsection",
 CellChangeTimes->{{3.671968201171743*^9, 3.67196821820794*^9}}],

Cell[BoxData[
 RowBox[{"(", 
  RowBox[{
   RowBox[{
    RowBox[{"Tr", "[", 
     RowBox[{"\[Rho]$4$A", " ", ".", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Ix", " ", "+", " ", "Sx"}], ")"}], " ", "+", " ", 
        RowBox[{"I", " ", 
         RowBox[{"(", 
          RowBox[{"Iy", " ", "+", " ", "Sy"}], ")"}]}]}], ")"}]}], "]"}], " ",
     "/.", " ", "SubstituteSpinMatrices"}], "  ", "//", " ", "Simplify"}], 
  " ", ")"}]], "Input",
 CellChangeTimes->{{3.671966565437508*^9, 3.671966742743554*^9}, {
  3.671967437765218*^9, 3.67196743891486*^9}, {3.671967807199925*^9, 
  3.671967807702455*^9}, {3.671967845292038*^9, 3.6719678458043613`*^9}, {
  3.671969338900051*^9, 3.671969352024382*^9}},
 FontSize->16],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"Tr", "[", 
      RowBox[{"\[Rho]$4$B", " ", ".", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Ix", " ", "+", " ", "Sx"}], ")"}], " ", "+", " ", 
         RowBox[{"I", " ", 
          RowBox[{"(", 
           RowBox[{"Iy", " ", "+", " ", "Sy"}], ")"}]}]}], ")"}]}], "]"}], 
     " ", "/.", " ", "SubstituteSpinMatrices"}], "  ", "//", " ", 
    "Simplify"}], " ", ")"}], " "}]], "Input",
 CellChangeTimes->{{3.671966786581603*^9, 3.671966786801403*^9}, 
   3.6719674296774*^9, {3.6719678097780857`*^9, 3.671967809981552*^9}, {
   3.671967848651556*^9, 3.671967849761945*^9}, {3.671969373554744*^9, 
   3.6719693750388412`*^9}},
 FontSize->16],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Rho]$4", " ", "=", " ", 
   RowBox[{
    RowBox[{"-", "\[Rho]$4$A"}], " ", "+", " ", 
    RowBox[{"I", " ", "\[Rho]$4$B"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"(", 
  RowBox[{
   RowBox[{
    RowBox[{"Tr", "[", 
     RowBox[{"\[Rho]$4", " ", ".", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Ix", " ", "+", " ", "Sx"}], ")"}], " ", "+", " ", 
        RowBox[{"I", " ", 
         RowBox[{"(", 
          RowBox[{"Iy", " ", "+", " ", "Sy"}], ")"}]}]}], ")"}]}], "]"}], " ",
     "/.", " ", "SubstituteSpinMatrices"}], "  ", "//", " ", "Simplify"}], 
  " ", ")"}]}], "Input",
 CellChangeTimes->{{3.671966853423469*^9, 3.671966980704862*^9}, {
   3.671968224737483*^9, 3.6719682320550337`*^9}, 3.671969364729782*^9},
 FontSize->16]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute the signal and apply the 2D FT", "Subsection",
 CellChangeTimes->{{3.671961195103389*^9, 3.671961211402051*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Signal2D", "[", 
    RowBox[{"t1_", ",", "t2_"}], "]"}], " ", "=", " ", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Tr", "[", 
         RowBox[{"\[Rho]$4", ".", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Ix", " ", "+", " ", "Sx"}], ")"}], " ", "+", " ", 
            RowBox[{"I", " ", 
             RowBox[{"(", 
              RowBox[{"Iy", " ", "+", " ", "Sy"}], ")"}]}]}], ")"}]}], "]"}], 
        " ", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "t1"}], "/", "T2"}], "]"}], " ", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "t2"}], "/", "T2"}], "]"}]}], " ", "+", "0.025"}], "/.",
       "\[IndentingNewLine]", " ", "SubstituteSpinMatrices"}], " ", "/.", " ",
      "\[IndentingNewLine]", "HamiltonianParameters$coupled"}], " ", "//", 
    " ", "Simplify"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6719618553997602`*^9, 3.671961858187746*^9}, {
  3.671961957632979*^9, 3.671961968850966*^9}, {3.671962139492156*^9, 
  3.6719621396800413`*^9}, {3.6719635232842913`*^9, 3.671963533673254*^9}, {
  3.671963790457479*^9, 3.671963799378996*^9}, {3.6719657459183607`*^9, 
  3.671965746041649*^9}, {3.671965813218071*^9, 3.671965834051178*^9}, {
  3.671969419511218*^9, 3.671969430091721*^9}, {3.6719700879326067`*^9, 
  3.671970088681526*^9}},
 FontSize->16],

Cell["\<\
Fourier transform the signal.   This takes a couple of seconds.\
\>", "Text",
 CellChangeTimes->{{3.671935044258762*^9, 3.6719350524686747`*^9}, {
  3.671960577588045*^9, 3.6719605998631897`*^9}, {3.671960645960691*^9, 
  3.6719606557175407`*^9}, {3.671963564552681*^9, 3.671963573311535*^9}, {
  3.671970059300753*^9, 3.671970063023987*^9}},
 FontSize->18],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"p1", ",", "p2", ",", "p3"}], "}"}], " ", "=", " ", 
   RowBox[{"DFFT2", "[", 
    RowBox[{"Signal2D", ",", "t1$List", ",", "t2$List"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.671881660314452*^9, 3.671881683505583*^9}, {
   3.671881715652314*^9, 3.671881723794434*^9}, {3.6718901308991117`*^9, 
   3.671890140126958*^9}, {3.67189019665511*^9, 3.671890196829525*^9}, {
   3.671892971354268*^9, 3.6718929714678288`*^9}, {3.671893026070917*^9, 
   3.6718930261749077`*^9}, 3.671932589687904*^9, 3.671934659488551*^9, {
   3.671934731891508*^9, 3.671934732059461*^9}, {3.671935155580461*^9, 
   3.671935158165567*^9}, {3.671960115925538*^9, 3.6719601445045347`*^9}, {
   3.671960183219754*^9, 3.671960207693185*^9}, {3.671960293139372*^9, 
   3.671960298605274*^9}, {3.671960405949394*^9, 3.671960409397332*^9}, {
   3.671960615957674*^9, 3.671960718647657*^9}, {3.671962184757069*^9, 
   3.671962225500497*^9}},
 FontSize->16],

Cell[BoxData["p3"], "Input",
 CellChangeTimes->{{3.671962500316848*^9, 3.6719625005187073`*^9}, {
  3.671965857173787*^9, 3.671965878944346*^9}, {3.671966185507186*^9, 
  3.6719661952099857`*^9}, {3.671966284602901*^9, 3.6719662849153223`*^9}, {
  3.6719680746628847`*^9, 3.6719680749207172`*^9}, {3.671968246334671*^9, 
  3.671968246554215*^9}, {3.671968287970796*^9, 3.6719682893213367`*^9}, {
  3.6719700492346*^9, 3.6719700517908373`*^9}},
 FontSize->16]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Scratch", "Section",
 CellChangeTimes->{{3.671850422179201*^9, 3.671850426859233*^9}},
 FontSize->24],

Cell[CellGroupData[{

Cell["2 D data sets", "Subsection",
 CellChangeTimes->{{3.671932670504936*^9, 3.671932678767653*^9}}],

Cell[BoxData[{
 RowBox[{"t1$List", "=", " ", 
  RowBox[{"TimeArray", "[", 
   RowBox[{
    RowBox[{"2", "^", "2"}], ",", "0.01"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{" ", 
  RowBox[{"TimeArrayReport", "[", "t1$List", "]"}]}]}], "Input",
 CellChangeTimes->{{3.6719312821049547`*^9, 3.6719313598957357`*^9}, {
  3.67193142875105*^9, 3.671931428958355*^9}},
 FontSize->18],

Cell[BoxData[{
 RowBox[{"t2$List", "=", " ", 
  RowBox[{"TimeArray", "[", 
   RowBox[{
    RowBox[{"2", "^", "2"}], ",", "0.005"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{" ", 
  RowBox[{"TimeArrayReport", "[", "t2$List", "]"}]}]}], "Input",
 CellChangeTimes->{{3.671931369453434*^9, 3.671931386426395*^9}, {
  3.671931432461632*^9, 3.6719314326490097`*^9}},
 FontSize->18],

Cell["\<\
Calculate the 2D digital Fourier transform of a two-dimensional time-domain \
signal and plot it.\
\>", "Text",
 CellChangeTimes->{{3.67145051013356*^9, 3.671450534424446*^9}, {
  3.671925803906604*^9, 3.671925826665345*^9}, {3.671931496256731*^9, 
  3.671931503804096*^9}},
 FontSize->18],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.671931786917663*^9, 3.6719318437817497`*^9}, {
  3.671931980217062*^9, 3.67193203951527*^9}, {3.67193209429169*^9, 
  3.671932152406588*^9}},
 FontSize->16]
}, Open  ]],

Cell[CellGroupData[{

Cell["Spin operators", "Subsection",
 CellChangeTimes->{{3.671932684519408*^9, 3.6719326969385147`*^9}}],

Cell["\<\
In this section we play with creating matrices for spin = 1/2 I and S-spin \
angular momentum operators in the 4 x 4 Zeeman basis.  Name the matrices \
something different to avoid collisions.\
\>", "Text",
 CellChangeTimes->{{3.671930543578741*^9, 3.671930678160561*^9}, {
  3.671930736774769*^9, 3.6719307546942663`*^9}},
 FontSize->18],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"IzOp", "[", 
    RowBox[{"1", "/", "2"}], "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "/", "2"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IzOp", "[", 
   RowBox[{"1", "/", "2"}], "]"}], "  ", "//", " ", "MatrixForm"}]}], "Input",\

 CellChangeTimes->{{3.671873261245534*^9, 3.671873349546627*^9}, {
  3.67187469667444*^9, 3.671874700584927*^9}, {3.671876504606627*^9, 
  3.671876518477325*^9}, {3.671876664602162*^9, 3.6718766688192387`*^9}},
 FontSize->18],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"IdOp", "[", 
    RowBox[{"1", "/", "2"}], "]"}], "=", " ", 
   RowBox[{"IdentityMatrix", "[", "2", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IdOp", "[", 
   RowBox[{"1", "/", "2"}], "]"}], " ", "//", " ", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.6718733397675877`*^9, 3.671873342264292*^9}, {
  3.671874682900289*^9, 3.671874690969413*^9}, {3.671876524991015*^9, 
  3.671876557678874*^9}, {3.671876674817213*^9, 3.671876677651585*^9}},
 FontSize->18],

Cell["The following proceedure took a while to work out.", "Text",
 CellChangeTimes->{{3.671930788543001*^9, 3.6719308014710093`*^9}},
 FontSize->18],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Iz$custom", " ", "=", " ", 
   RowBox[{
    RowBox[{"Outer", "[", 
     RowBox[{"Times", ",", 
      RowBox[{"IzOp", "[", 
       RowBox[{"1", "/", "2"}], "]"}], " ", ",", 
      RowBox[{"IdOp", "[", 
       RowBox[{"1", "/", "2"}], "]"}]}], " ", "]"}], " ", "//", " ", 
    "ArrayFlatten"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sz$custom", " ", "=", " ", 
   RowBox[{
    RowBox[{"Outer", "[", 
     RowBox[{"Times", ",", 
      RowBox[{"IdOp", "[", 
       RowBox[{"1", "/", "2"}], "]"}], "  ", ",", 
      RowBox[{"IzOp", "[", 
       RowBox[{"1", "/", "2"}], "]"}]}], "]"}], "  ", "//", " ", 
    "ArrayFlatten"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.671874818765115*^9, 3.6718748738269167`*^9}, {
  3.671875133720261*^9, 3.671875146635041*^9}, {3.67187521177174*^9, 
  3.671875242054728*^9}, {3.671875276625236*^9, 3.671875288595008*^9}, {
  3.671875321378615*^9, 3.6718753264854727`*^9}, {3.671875476377839*^9, 
  3.6718754780982943`*^9}, {3.6718755479683447`*^9, 3.6718755505920877`*^9}, {
  3.671876540845921*^9, 3.671876608465255*^9}, {3.671930694197357*^9, 
  3.671930712647798*^9}},
 FontSize->18],

Cell[BoxData[{
 RowBox[{"Iz$custom", "  ", "//", " ", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"Sz$custom", "  ", "//", " ", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.671875560494595*^9, 3.6718755717873507`*^9}, {
  3.671930716085187*^9, 3.67193071872372*^9}},
 FontSize->18],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Iz$custom", " ", ".", "Iz$custom"}], "  ", "//", " ", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sz$custom", " ", ".", "Sz$custom"}], " ", "//", " ", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.671876622496077*^9, 3.6718766264915247`*^9}, {
  3.6719307220675297`*^9, 3.671930731550399*^9}},
 FontSize->18]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bras and kets", "Subsection",
 CellChangeTimes->{{3.672139793820101*^9, 3.672139798618196*^9}}],

Cell[TextData[{
 "This is how to implement column and row bras and kets` in ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " "
}], "Text",
 CellChangeTimes->{{3.671930766723958*^9, 3.671930775626086*^9}, {
   3.672139755369976*^9, 3.6721397858367567`*^9}, 3.67213989410353*^9},
 FontSize->18],

Cell[BoxData[
 RowBox[{
  RowBox[{"L$1", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "a", "}"}], ",", 
     RowBox[{"{", "b", "}"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6721394192553*^9, 3.6721394379154177`*^9}, {
   3.672139627436914*^9, 3.672139629114683*^9}, 3.672139700452574*^9},
 FontSize->18],

Cell[BoxData[
 RowBox[{
  RowBox[{"L$2", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"c", ",", "d"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.672139635438106*^9, 3.672139649010167*^9}, {
  3.672139683470373*^9, 3.672139697480274*^9}},
 FontSize->18],

Cell[BoxData[
 RowBox[{
  RowBox[{"Outer", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Q", "[", 
      RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", "L$2", " ", ",", " ", 
    "L$1"}], "]"}], " ", "//", " ", "FullForm"}]], "Input",
 CellChangeTimes->{{3.672139439848589*^9, 3.672139498926976*^9}, {
  3.672139621648326*^9, 3.67213962283377*^9}},
 FontSize->18],

Cell[BoxData[
 RowBox[{
  RowBox[{"Outer", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Q", "[", 
      RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", "b"}], "}"}], " ", ",", 
    RowBox[{"{", 
     RowBox[{"c", ",", "d"}], "}"}]}], "]"}], " ", "//", 
  "FullForm"}]], "Input",
 CellChangeTimes->{{3.67213951819134*^9, 3.672139542568778*^9}, {
  3.672139608838372*^9, 3.6721396118125887`*^9}},
 FontSize->18],

Cell[BoxData[{
 RowBox[{"L$1", " ", ".", " ", "L$2"}], "\[IndentingNewLine]", 
 RowBox[{"L$2", " ", ".", " ", "L$1"}]}], "Input",
 CellChangeTimes->{{3.672139673053404*^9, 3.672139711313513*^9}},
 FontSize->18]
}, Open  ]]
}, Closed]]
}, Open  ]]
},
WindowSize->{1039, 839},
WindowMargins->{{20, Automatic}, {0, Automatic}},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September 9, \
2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 302, 4, 92, "Title"],
Cell[885, 28, 156, 6, 83, "Text"],
Cell[1044, 36, 808, 17, 59, "Text"],
Cell[CellGroupData[{
Cell[1877, 57, 46, 1, 60, "Section"],
Cell[1926, 60, 1568, 40, 301, "Text"],
Cell[3497, 102, 633, 12, 131, "Text"],
Cell[4133, 116, 453, 11, 59, "Text"],
Cell[4589, 129, 673, 13, 131, "Text"],
Cell[5265, 144, 227, 5, 35, "Text"],
Cell[5495, 151, 1560, 36, 275, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7092, 192, 98, 1, 64, "Section"],
Cell[CellGroupData[{
Cell[7215, 197, 114, 1, 44, "Subsection"],
Cell[7332, 200, 315, 9, 77, "Text"],
Cell[7650, 211, 608, 13, 33, "Input"],
Cell[8261, 226, 152, 2, 33, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8450, 233, 103, 1, 44, "Subsection"],
Cell[8556, 236, 686, 15, 83, "Text"],
Cell[9245, 253, 463, 10, 53, "Input"],
Cell[9711, 265, 301, 6, 59, "Text"],
Cell[10015, 273, 638, 13, 53, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[10702, 292, 226, 3, 64, "Section"],
Cell[10931, 297, 169, 3, 35, "Text"],
Cell[11103, 302, 1065, 26, 172, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12205, 333, 118, 1, 64, "Section"],
Cell[CellGroupData[{
Cell[12348, 338, 97, 1, 44, "Subsection"],
Cell[12448, 341, 545, 10, 83, "Text"],
Cell[12996, 353, 1690, 40, 195, "Input"],
Cell[14689, 395, 292, 6, 59, "Text"],
Cell[14984, 403, 1971, 52, 126, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16992, 460, 97, 1, 44, "Subsection"],
Cell[17092, 463, 203, 3, 35, "Text"],
Cell[17298, 468, 1691, 40, 195, "Input"],
Cell[18992, 510, 206, 3, 35, "Text"],
Cell[19201, 515, 1955, 52, 126, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21193, 572, 188, 3, 49, "Subsection"],
Cell[21384, 577, 1174, 31, 113, "Text"],
Cell[22561, 610, 4770, 99, 533, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[27380, 715, 349, 4, 64, "Section"],
Cell[27732, 721, 1539, 38, 208, "Text"],
Cell[29274, 761, 1862, 46, 195, "Input"],
Cell[31139, 809, 300, 7, 59, "Text"],
Cell[31442, 818, 1474, 41, 117, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32953, 864, 109, 1, 64, "Section"],
Cell[33065, 867, 152, 3, 32, "Input"],
Cell[33220, 872, 209, 5, 35, "Text"],
Cell[33432, 879, 447, 11, 33, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33916, 895, 231, 3, 64, "Section"],
Cell[34150, 900, 171, 3, 35, "Text"],
Cell[34324, 905, 1334, 34, 218, "Input"],
Cell[35661, 941, 244, 4, 35, "Text"],
Cell[35908, 947, 1158, 29, 195, "Input"],
Cell[37069, 978, 247, 6, 35, "Text"],
Cell[37319, 986, 7357, 170, 1000, "Input"],
Cell[44679, 1158, 247, 6, 35, "Text"],
Cell[44929, 1166, 6418, 145, 885, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51384, 1316, 177, 2, 64, "Section"],
Cell[51564, 1320, 112, 2, 51, "Text"],
Cell[51679, 1324, 1764, 39, 188, "Input"],
Cell[53446, 1365, 231, 5, 59, "Text"],
Cell[53680, 1372, 357, 10, 57, "Input"],
Cell[54040, 1384, 909, 28, 92, "Text"],
Cell[54952, 1414, 1113, 30, 80, "Input"],
Cell[56068, 1446, 184, 3, 35, "Text"],
Cell[56255, 1451, 539, 12, 57, "Input"],
Cell[56797, 1465, 215, 5, 35, "Text"],
Cell[57015, 1472, 380, 7, 33, "Input"],
Cell[57398, 1481, 201, 5, 35, "Text"],
Cell[57602, 1488, 175, 4, 33, "Input"],
Cell[57780, 1494, 233, 5, 59, "Text"],
Cell[58016, 1501, 1080, 31, 103, "Input"],
Cell[59099, 1534, 270, 9, 37, "Text"],
Cell[59372, 1545, 1149, 31, 103, "Input"],
Cell[60524, 1578, 268, 9, 37, "Text"],
Cell[60795, 1589, 1198, 32, 103, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[62030, 1626, 163, 2, 64, "Section"],
Cell[62196, 1630, 1804, 48, 306, "Text"],
Cell[64003, 1680, 449, 13, 55, "Input"],
Cell[64455, 1695, 643, 19, 61, "Text"],
Cell[CellGroupData[{
Cell[65123, 1718, 292, 10, 45, "Subsection"],
Cell[65418, 1730, 1562, 49, 160, "Text"],
Cell[66983, 1781, 1444, 36, 53, "Input"],
Cell[68430, 1819, 365, 11, 37, "Text"],
Cell[68798, 1832, 663, 20, 74, "Input"],
Cell[69464, 1854, 119, 3, 32, "Input"],
Cell[69586, 1859, 269, 6, 59, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[69892, 1870, 541, 18, 45, "Subsection"],
Cell[70436, 1890, 1988, 60, 217, "Text"],
Cell[72427, 1952, 2170, 63, 113, "Input"],
Cell[74600, 2017, 1218, 32, 211, "Text"],
Cell[75821, 2051, 893, 24, 83, "Text"],
Cell[76717, 2077, 1046, 26, 53, "Input"],
Cell[77766, 2105, 854, 28, 61, "Text"],
Cell[78623, 2135, 905, 25, 74, "Input"],
Cell[79531, 2162, 185, 4, 32, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[79765, 2172, 276, 3, 64, "Section"],
Cell[CellGroupData[{
Cell[80066, 2179, 131, 1, 44, "Subsection"],
Cell[80200, 2182, 10337, 245, 1034, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[90574, 2432, 151, 2, 44, "Subsection"],
Cell[90728, 2436, 568, 15, 53, "Input"],
Cell[91299, 2453, 183, 4, 53, "Input"],
Cell[91485, 2459, 1488, 36, 94, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[93010, 2500, 102, 1, 44, "Subsection"],
Cell[93115, 2503, 2137, 57, 215, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[95301, 2566, 199, 3, 60, "Section"],
Cell[95503, 2571, 143, 2, 35, "Text"],
Cell[CellGroupData[{
Cell[95671, 2577, 126, 1, 44, "Subsection"],
Cell[95800, 2580, 112, 2, 51, "Text"],
Cell[95915, 2584, 1773, 42, 169, "Input"],
Cell[97691, 2628, 189, 3, 51, "Text"],
Cell[97883, 2633, 1272, 25, 69, "Input"],
Cell[99158, 2660, 231, 5, 59, "Text"],
Cell[99392, 2667, 357, 10, 57, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[99786, 2682, 99, 1, 44, "Subsection"],
Cell[99888, 2685, 130, 2, 33, "Text"],
Cell[100021, 2689, 249, 5, 53, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[100307, 2699, 115, 1, 44, "Subsection"],
Cell[100425, 2702, 221, 5, 35, "Text"],
Cell[100649, 2709, 4814, 121, 313, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[105500, 2835, 127, 1, 44, "Subsection"],
Cell[105630, 2838, 553, 14, 32, "Input"],
Cell[106186, 2854, 556, 15, 32, "Input"],
Cell[106745, 2871, 641, 18, 53, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[107423, 2894, 126, 1, 44, "Subsection"],
Cell[107552, 2897, 1387, 33, 114, "Input"],
Cell[108942, 2932, 305, 4, 35, "Text"],
Cell[109250, 2938, 999, 19, 32, "Input"],
Cell[110252, 2959, 440, 6, 53, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[110741, 2971, 247, 4, 60, "Section"],
Cell[110991, 2977, 332, 9, 35, "Text"],
Cell[CellGroupData[{
Cell[111348, 2990, 126, 1, 44, "Subsection"],
Cell[111477, 2993, 112, 2, 51, "Text"],
Cell[111592, 2997, 1805, 42, 169, "Input"],
Cell[113400, 3041, 189, 3, 51, "Text"],
Cell[113592, 3046, 1270, 25, 69, "Input"],
Cell[114865, 3073, 231, 5, 59, "Text"],
Cell[115099, 3080, 357, 10, 57, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[115493, 3095, 99, 1, 44, "Subsection"],
Cell[115595, 3098, 130, 2, 33, "Text"],
Cell[115728, 3102, 249, 5, 53, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[116014, 3112, 115, 1, 44, "Subsection"],
Cell[116132, 3115, 261, 4, 35, "Text"],
Cell[116396, 3121, 5951, 152, 313, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[122384, 3278, 127, 1, 44, "Subsection"],
Cell[122514, 3281, 744, 19, 32, "Input"],
Cell[123261, 3302, 756, 20, 32, "Input"],
Cell[124020, 3324, 806, 22, 53, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[124863, 3351, 126, 1, 44, "Subsection"],
Cell[124992, 3354, 1501, 37, 114, "Input"],
Cell[126496, 3393, 367, 7, 35, "Text"],
Cell[126866, 3402, 999, 19, 32, "Input"],
Cell[127868, 3423, 458, 7, 32, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[128375, 3436, 107, 2, 60, "Section"],
Cell[CellGroupData[{
Cell[128507, 3442, 101, 1, 44, "Subsection"],
Cell[128611, 3445, 376, 9, 57, "Input"],
Cell[128990, 3456, 376, 9, 57, "Input"],
Cell[129369, 3467, 299, 7, 35, "Text"],
Cell[129671, 3476, 205, 4, 32, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[129913, 3485, 104, 1, 44, "Subsection"],
Cell[130020, 3488, 348, 7, 59, "Text"],
Cell[130371, 3497, 728, 22, 57, "Input"],
Cell[131102, 3521, 528, 13, 57, "Input"],
Cell[131633, 3536, 149, 2, 35, "Text"],
Cell[131785, 3540, 1168, 28, 57, "Input"],
Cell[132956, 3570, 293, 6, 57, "Input"],
Cell[133252, 3578, 370, 9, 57, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[133659, 3592, 101, 1, 44, "Subsection"],
Cell[133763, 3595, 298, 8, 35, "Text"],
Cell[134064, 3605, 333, 9, 33, "Input"],
Cell[134400, 3616, 258, 7, 33, "Input"],
Cell[134661, 3625, 361, 10, 33, "Input"],
Cell[135025, 3637, 449, 14, 33, "Input"],
Cell[135477, 3653, 210, 4, 57, "Input"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
