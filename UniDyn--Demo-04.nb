(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     65258,       1490]
NotebookOptionsPosition[     56149,       1359]
NotebookOutlinePosition[     56601,       1377]
CellTagsIndexPosition[     56558,       1374]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["UniDyn--Demo-04.nb", "Title",
 CellChangeTimes->{{3.6352690845273046`*^9, 3.635269100847275*^9}, {
  3.6609180081345453`*^9, 3.660918013241088*^9}, {3.661433595181979*^9, 
  3.661433595493599*^9}, {3.671421633380262*^9, 
  3.6714216336468887`*^9}},ExpressionUUID->"9bff736d-4c0d-4164-ac50-\
6010707a1cd6"],

Cell["\<\
John A. Marohn
jam99@cornell.edu
Cornell University\
\>", "Text",
 CellChangeTimes->{{3.635269101985786*^9, 3.635269121580956*^9}},
 FontSize->18,ExpressionUUID->"6f7894b0-f9a0-42a7-9171-6194e366610c"],

Cell[TextData[{
 StyleBox["Abstract:",
  FontWeight->"Bold"],
 "  Use the ",
 StyleBox["UniDyn",
  FontWeight->"Bold"],
 " Evolver function to calculate the evolution of the magnetization of a two \
coupled spin = 1/2 particles."
}], "Text",
 CellChangeTimes->{{3.6352698622319117`*^9, 3.635269926908793*^9}, {
  3.6352701305950613`*^9, 3.635270138669529*^9}, {3.6614336154747458`*^9, 
  3.661433666560676*^9}, {3.661433776071369*^9, 3.6614337761699266`*^9}, {
  3.6614620415959*^9, 3.66146210493357*^9}, {3.67142163980396*^9, 
  3.671421654441256*^9}, {3.6714566972027082`*^9, 3.6714567047338247`*^9}},
 FontSize->18,ExpressionUUID->"7e9f2b5e-cdd0-4460-b6e7-cc0ad521ad19"],

Cell[CellGroupData[{

Cell["Set the path to the package", "Section",
 CellChangeTimes->{{3.635270036711257*^9, 
  3.63527004852262*^9}},ExpressionUUID->"53c56eb4-cde7-499c-badb-\
528efbdc7dc2"],

Cell[TextData[{
 "Tell ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " the path to the directory containing the package.    \n\nEDIT THE \
FOLLOWING PATH STRING:"
}], "Text",
 CellChangeTimes->{{3.635270060901009*^9, 3.635270086988311*^9}, {
  3.6610825274488792`*^9, 3.6610825288209763`*^9}},
 FontSize->16,ExpressionUUID->"9ddeefdf-eb4a-4c24-954b-28b5f7c3109e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$NCPath", " ", "=", " ", "\"\</Users/jam99/Dropbox\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "$UniDynPath", " ", "=", 
    "\"\</Users/jam99/Dropbox/MarohnGroup__Software_Library/UniDyn/unidyn\>\"\
"}], ";"}], " "}]}], "Input",
 CellChangeTimes->{{3.6349053527016897`*^9, 3.6349054064223843`*^9}, {
   3.634910931339162*^9, 3.634910931457775*^9}, {3.634914337947165*^9, 
   3.6349143671071568`*^9}, {3.634922597904743*^9, 3.634922606812076*^9}, {
   3.635268730835155*^9, 3.635268731125407*^9}, {3.635269951638358*^9, 
   3.635269958323474*^9}, {3.660918115324842*^9, 3.660918132325369*^9}, {
   3.660918590921587*^9, 3.660918600403768*^9}, 3.859899397992119*^9},
 FontSize->16,
 CellLabel->"In[1]:=",ExpressionUUID->"a419521a-c7ad-4f1d-b671-6a4dbc030bd8"],

Cell["YOU SHOULD NOT NEED TO EDIT ANYTHING FROM HERE ONWARDS.", "Text",
 CellChangeTimes->{{3.635270073196437*^9, 3.635270077357624*^9}},
 FontSize->16,ExpressionUUID->"6166a40f-9cd5-4040-890a-26018e2090b1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Load the package", "Section",
 CellChangeTimes->{{3.635269129230983*^9, 
  3.63526913095236*^9}},ExpressionUUID->"468777c8-bf9a-43fc-b526-\
fa4a7e7a1196"],

Cell[TextData[{
 "Append the package path to the system path.  Before trying to load the \
package, ask ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " to find it.  This is a test that we directed ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " to the correct directory.  The output of this command should be the full \
system path to the UniDyn.m file.   "
}], "Text",
 CellChangeTimes->{{3.635269223597199*^9, 3.635269340159473*^9}, {
   3.635269947982662*^9, 3.6352699492517843`*^9}, {3.635269985297124*^9, 
   3.63527000724584*^9}, 3.635270066996499*^9, {3.63527010818321*^9, 
   3.6352701131658497`*^9}, {3.660918102499856*^9, 3.6609181035465183`*^9}},
 FontSize->18,ExpressionUUID->"97047fec-134c-4195-9ad4-2411a10634fb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$Path", " ", "=", " ", 
   RowBox[{"AppendTo", "[", 
    RowBox[{"$Path", ",", "$NCPath"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$Path", " ", "=", " ", 
   RowBox[{"AppendTo", "[", 
    RowBox[{"$Path", ",", "$UniDynPath"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"FindFile", "[", "\"\<UniDyn`\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"FindFile", "[", "\"\<NC`\>\"", "]"}]}], "Input",
 CellChangeTimes->{{3.634906393354924*^9, 3.634906398308229*^9}, {
   3.634922599063291*^9, 3.634922599752222*^9}, {3.635268728673848*^9, 
   3.6352687402094*^9}, {3.635269954012105*^9, 3.6352699550474253`*^9}, 
   3.859899407656878*^9},
 FontSize->16,
 CellLabel->"In[3]:=",ExpressionUUID->"54113382-83cc-48fc-9f56-15f3f7f7521c"],

Cell["\<\
Now that we are confident that the path is set correctly, load the package.  \
Setting the global $VerboseLoad variable to True will print out the help \
strings for key commands in the package.  \
\>", "Text",
 CellChangeTimes->{{3.635269347360386*^9, 3.63526943190546*^9}, 
   3.8598993597157803`*^9},
 FontSize->18,ExpressionUUID->"76c4313c-63f7-4ce5-8da3-5f8f965c2a0c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$VerboseLoad", " ", "=", "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Needs", "[", "\"\<UniDyn`\>\"", "]"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQfYUjQpVD9LXjxxR+TRC9peyGEyeQ/lH0EExXTKuJ
BdGbVk8B0zYvFOpA9Ik35o0gmsEzcwKI3ruyF0yrn4ubDqITDHPAdMGBGUdA
9K1JG8G0V4+DGg+Q1vtwBUyLu5WcAtE8yv6nQfT861tdBUDm3NFxA9F2v/Ym
g+h4M4cUED09+VEGiC6rzcoH0RUNSUHSQHqfnVQoiP6uyGkiC6T5nmeCabdp
f25FAekIO8nbINqkKUQlBUiz/Z0DplNs3jwG0Q88GJ+A6Bf2PcZdQNqjYi6Y
XnQt//l3t9eOqzNZX4DoFiF11h9A+sM0WzCtqnCwYKH7a8c9B1ULQTQAyl6Q
EA==
  "],
 FontSize->16,
 CellLabel->"In[7]:=",ExpressionUUID->"663f0f98-230c-4e74-a5d9-d519ad4fca77"]
}, Closed]],

Cell[CellGroupData[{

Cell["Evolver with simplification", "Section",
 CellChangeTimes->{{3.6714440687071867`*^9, 
  3.671444088666716*^9}},ExpressionUUID->"6e04c5f1-bd3d-4e48-a954-\
33f17b608c40"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SimplifyingEvolver", "[", 
   RowBox[{"H_", ",", "t_", ",", "\[Rho]$0_"}], "]"}], ":=", "  ", 
  "\[IndentingNewLine]", "\t", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Evolver", "[", 
      RowBox[{"H", ",", " ", "t", ",", " ", "\[Rho]$0"}], "]"}], "//", 
     "Simplify"}], "//", " ", "ExpToTrig"}], " ", "//", " ", "FullSimplify", 
   " "}]}]], "Input",
 CellChangeTimes->{{3.671444089823865*^9, 3.671444165795093*^9}},
 FontSize->16,
 CellLabel->"In[9]:=",ExpressionUUID->"3b79a2b4-c5b1-427d-81cc-9b898b8033f8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Unitary evolution of a single spin 1/2 ", "Section",
 CellChangeTimes->{{3.6614338330758963`*^9, 3.661433850988009*^9}, {
  3.6614339433230333`*^9, 3.661433947755453*^9}, {3.671422107818894*^9, 
  3.671422108739214*^9}, {3.671445264092331*^9, 
  3.6714452741228848`*^9}},ExpressionUUID->"f6b43116-b609-4e9c-b16c-\
abdb4f965a10"],

Cell[CellGroupData[{

Cell["Create a single spin", "Subsection",
 CellChangeTimes->{{3.661433931683024*^9, 
  3.661433953976736*^9}},ExpressionUUID->"a6bea89f-30b9-4fb1-ad88-\
85f066779394"],

Cell[TextData[{
 "The assumptions define below are required for ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " to recognize ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SqrtBox[
     RowBox[{"\[Dash]", 
      RowBox[{
       SuperscriptBox["\[CapitalDelta]", "2"], "-", 
       SuperscriptBox["\[Omega]", "2"]}]}]], "=", " ", 
    RowBox[{"I", 
     SqrtBox[
      RowBox[{
       SuperscriptBox["\[CapitalDelta]", "2"], "+", 
       SuperscriptBox["\[Omega]", "2"]}]]}]}], TraditionalForm]],
  FontSize->14,ExpressionUUID->"e2e7e9d7-4c64-4e5e-990e-9dcc9dcc5897"],
 " inside an exponential.   One of the variables has to be defined to be > 0 \
and not just \[GreaterSlantEqual] 0."
}], "Text",
 CellChangeTimes->{{3.661454934610312*^9, 3.661455077339642*^9}, {
   3.661455120999338*^9, 3.6614551250107203`*^9}, {3.66145516298409*^9, 
   3.661455238939184*^9}, {3.6614552751916943`*^9, 3.6614553005499*^9}, 
   3.66169791700492*^9},
 FontSize->18,ExpressionUUID->"7e4d1fff-4084-4f39-bb2e-211541b1ffd3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "\[IndentingNewLine]", 
   RowBox[{"\[CapitalDelta]\[Omega]", ",", "                     ", 
    RowBox[{"(*", " ", 
     RowBox[{"resonance", " ", "offset", " ", "frequency"}], " ", "*)"}], 
    "\[IndentingNewLine]", "\[Omega]$1", ",", "                  ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Rabi", " ", "frequency", " ", "of", " ", "the", " ", "applied", " ", 
      "irradiation"}], " ", "*)"}], "\[IndentingNewLine]", "t", ",", 
    "                      ", 
    RowBox[{"(*", " ", "time", " ", "*)"}], "\[IndentingNewLine]", "Ix", ",", 
    " ", "Iy", ",", " ", "Iz", ",", "  ", 
    RowBox[{"(*", " ", 
     RowBox[{"spin", " ", "angular", " ", "momentum", " ", "operators"}], " ",
      "*)"}], "\[IndentingNewLine]", "\[Rho]$0", ",", "                  ", 
    RowBox[{"(*", " ", 
     RowBox[{"initial", " ", "spin", " ", "density", " ", "operator"}], " ", 
     "*)"}], "\[IndentingNewLine]", "H"}], "                          ", 
   RowBox[{"(*", " ", 
    RowBox[{"spin", " ", "Hamiltonian"}], " ", "*)"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CreateScalar", "[", 
   RowBox[{"\[CapitalDelta]\[Omega]", ",", "\[Omega]$1", ",", " ", "t"}], 
   "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SpinSingle$CreateOperators", "[", 
    RowBox[{"Ix", ",", " ", "Iy", ",", " ", "Iz", ",", " ", 
     RowBox[{"L", "=", 
      RowBox[{"1", "/", "2"}]}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$Assumptions", "  ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Element", "[", 
      RowBox[{"\[CapitalDelta]\[Omega]", ",", " ", "Reals"}], "]"}], ",", " ", 
     RowBox[{
     "\[CapitalDelta]\[Omega]", " ", "\[GreaterSlantEqual]", " ", "0"}], ",", 
     " ", 
     RowBox[{"Element", "[", 
      RowBox[{"\[Omega]$1", ",", " ", "Reals"}], "]"}], ",", " ", 
     RowBox[{
      RowBox[{"\[Omega]", " ", "$1"}], " ", ">", " ", "0"}], ",", " ", 
     RowBox[{"Element", "[", 
      RowBox[{"t", ",", " ", "Reals"}], "]"}], ",", " ", 
     RowBox[{"t", " ", "\[GreaterSlantEqual]", " ", "0"}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.6614339585492563`*^9, 3.661434010703532*^9}, {
   3.661434214867899*^9, 3.661434222437502*^9}, {3.661434384868638*^9, 
   3.6614346039604807`*^9}, {3.6614346490398808`*^9, 3.661434789890903*^9}, {
   3.661435094092959*^9, 3.661435125986967*^9}, {3.6614352184576807`*^9, 
   3.661435260920999*^9}, 3.661454979504386*^9, {3.6614550830373096`*^9, 
   3.6614550896485147`*^9}, {3.661455140167131*^9, 3.66145514338946*^9}, {
   3.6614552141564493`*^9, 3.661455268214559*^9}, {3.67144439281918*^9, 
   3.671444466838715*^9}, {3.6714447797901983`*^9, 3.67144478623868*^9}, {
   3.85989950642107*^9, 3.859899558994093*^9}},
 FontSize->16,
 CellLabel->"In[10]:=",ExpressionUUID->"e27ff726-a31d-4280-9da5-b3ec0413d867"]
}, Open  ]],

Cell[CellGroupData[{

Cell["On-resonance nutation", "Subsection",
 CellChangeTimes->{{3.661433867714074*^9, 3.661433876857678*^9}, {
  3.671421868173057*^9, 3.671421871614409*^9}, {3.6714219148357353`*^9, 
  3.671421918418017*^9}},
 FontSize->18,ExpressionUUID->"b296b0ef-707f-4427-bf88-3f932ba353eb"],

Cell[TextData[{
 "On-resonance irradiation Hamiltonian written in the interaction \
representation.  The initial density operator is parallel to ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["I", "x"], TraditionalForm]],ExpressionUUID->
  "68f6f9a6-8a7e-480f-a5fe-acfcc3f61ad5"],
 "."
}], "Text",
 CellChangeTimes->{{3.66145534764102*^9, 3.661455424815099*^9}, {
  3.671421878357871*^9, 3.671421899244645*^9}, {3.671421943547707*^9, 
  3.671421954189911*^9}, {3.8598994401425*^9, 3.859899447640983*^9}},
 FontSize->18,ExpressionUUID->"8c4ddf58-9e12-4d7a-a1b2-e39a7011a1f9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"H", " ", "=", " ", 
   RowBox[{"\[Omega]$1", " ", "Ix"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]$0", " ", "=", " ", "Iz"}], ";"}]}], "Input",
 CellChangeTimes->{{3.661435227848398*^9, 3.6614352284068127`*^9}, {
  3.67142180007626*^9, 3.6714218530576353`*^9}, {3.671421959643671*^9, 
  3.6714219696004133`*^9}, {3.67144444768364*^9, 3.671444447928295*^9}},
 FontSize->18,
 CellLabel->"In[14]:=",ExpressionUUID->"1e69b901-3a7f-4793-9b7e-da44f03e76c0"],

Cell["Calculate the time-dependent density operator.  ", "Text",
 CellChangeTimes->{{3.6614351443358517`*^9, 3.661435173054531*^9}, {
   3.6614549233087606`*^9, 3.661454923410828*^9}, {3.66145543210454*^9, 
   3.661455456329935*^9}, {3.671444261951881*^9, 3.671444267395067*^9}, 
   3.859899451340558*^9},
 FontSize->18,ExpressionUUID->"4e2eadd0-83dc-4ff4-8aee-e1ab179f97d4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SimplifyingEvolver", "[", 
   RowBox[{"H", ",", "t", ",", "\[Rho]$0"}], "]"}], " ", "/.", " ", 
  RowBox[{"{", " ", 
   RowBox[{"\[Omega]$1", "->", " ", 
    RowBox[{"Subscript", "[", 
     RowBox[{"\[Omega]", ",", "1"}], "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.6614340197481413`*^9, 3.661434178968038*^9}, {
   3.661434272954471*^9, 3.661434333128969*^9}, {3.661434640514575*^9, 
   3.661434643212017*^9}, {3.661434786650895*^9, 3.661434809637779*^9}, {
   3.661435106977956*^9, 3.661435116198124*^9}, {3.6614351828003273`*^9, 
   3.661435197915441*^9}, 3.661455661961378*^9, {3.6614557085212173`*^9, 
   3.6614557978065453`*^9}, {3.661455834919834*^9, 3.6614558778332987`*^9}, {
   3.6714218159749727`*^9, 3.671421839685802*^9}, {3.67142199694174*^9, 
   3.671422014075262*^9}, {3.671443825072248*^9, 3.6714439215422697`*^9}, {
   3.671444206438972*^9, 3.671444233751779*^9}, {3.671444450342011*^9, 
   3.671444450487729*^9}},
 FontSize->18,
 CellLabel->"In[16]:=",ExpressionUUID->"c99fe488-de19-4937-a048-776a190352e6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Free evolution", "Subsection",
 CellChangeTimes->{{3.661433867714074*^9, 3.661433876857678*^9}, {
  3.671421868173057*^9, 3.671421871614409*^9}},
 FontSize->18,ExpressionUUID->"3a888b7e-71cf-468a-91ce-f0ca1666c759"],

Cell[TextData[{
 "Zeeman-interaction Hamiltonian written in the interaction representation.  \
The initial density operator is parallel to ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["I", "x"], TraditionalForm]],ExpressionUUID->
  "d0dceb4b-68eb-407c-b5c4-d897dd52ebfd"],
 "."
}], "Text",
 CellChangeTimes->{{3.66145534764102*^9, 3.661455424815099*^9}, {
   3.671421878357871*^9, 3.671421937332016*^9}, {3.6714442931458473`*^9, 
   3.6714442946514378`*^9}, 3.859899575861712*^9},
 FontSize->18,ExpressionUUID->"3f9232f8-f86f-4f92-9383-000dc8758ff8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"H", " ", "=", " ", 
   RowBox[{"\[CapitalDelta]\[Omega]", " ", "Iz"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]$0", " ", "=", " ", "Ix"}], ";"}]}], "Input",
 CellChangeTimes->{{3.661435227848398*^9, 3.6614352284068127`*^9}, {
  3.67142180007626*^9, 3.6714218530576353`*^9}, {3.6714220466047583`*^9, 
  3.671422048575047*^9}, {3.671444387730156*^9, 3.671444388691031*^9}},
 FontSize->18,
 CellLabel->"In[17]:=",ExpressionUUID->"6cbc036e-1b76-4e0c-8440-ec01ed30e832"],

Cell["Calculate the time-dependent density operator.  ", "Text",
 CellChangeTimes->{{3.6614351443358517`*^9, 3.661435173054531*^9}, {
   3.6614549233087606`*^9, 3.661454923410828*^9}, {3.66145543210454*^9, 
   3.661455456329935*^9}, {3.671444261951881*^9, 3.671444267395067*^9}, 
   3.859899580161625*^9},
 FontSize->18,ExpressionUUID->"35c1528c-5f39-4b8c-b5dc-820b6cca3463"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SimplifyingEvolver", "[", 
   RowBox[{"H", ",", "t", ",", "\[Rho]$0"}], "]"}], " "}]], "Input",
 CellChangeTimes->{{3.6614340197481413`*^9, 3.661434178968038*^9}, {
   3.661434272954471*^9, 3.661434333128969*^9}, {3.661434640514575*^9, 
   3.661434643212017*^9}, {3.661434786650895*^9, 3.661434809637779*^9}, {
   3.661435106977956*^9, 3.661435116198124*^9}, {3.6614351828003273`*^9, 
   3.661435197915441*^9}, 3.661455661961378*^9, {3.6614557085212173`*^9, 
   3.6614557978065453`*^9}, {3.661455834919834*^9, 3.6614558778332987`*^9}, {
   3.6714218159749727`*^9, 3.671421839685802*^9}, {3.67142199694174*^9, 
   3.671422014075262*^9}, {3.671443825072248*^9, 3.6714439215422697`*^9}, {
   3.671444206438972*^9, 3.671444233751779*^9}, {3.671444303923465*^9, 
   3.6714443370387487`*^9}, {3.671444373803419*^9, 3.67144438068778*^9}, {
   3.6714444813129387`*^9, 3.6714444814771967`*^9}},
 FontSize->18,
 CellLabel->"In[19]:=",ExpressionUUID->"e399ead3-8c9b-4625-9721-b1487c38b024"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Unitary evolution of two coupled spins", "Section",
 CellChangeTimes->{{3.6614338330758963`*^9, 3.661433850988009*^9}, {
  3.6614339433230333`*^9, 3.661433947755453*^9}, {3.671422107818894*^9, 
  3.671422108739214*^9}, {3.6714222011816072`*^9, 3.671422206982089*^9}, {
  3.67144525430057*^9, 
  3.6714453019043407`*^9}},ExpressionUUID->"684595b5-1db8-4b78-8c65-\
f4e450c5d9fe"],

Cell[CellGroupData[{

Cell["Create a two spins", "Subsection",
 CellChangeTimes->{{3.661433931683024*^9, 3.661433953976736*^9}, {
  3.6714222121324053`*^9, 
  3.671422215219035*^9}},ExpressionUUID->"9d81a36a-8d42-4abc-90b8-\
70432f110a6b"],

Cell[TextData[{
 "The assumptions define below are required for ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " to recognize ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SqrtBox[
     RowBox[{"\[Dash]", 
      RowBox[{
       SuperscriptBox["\[CapitalDelta]", "2"], "-", 
       SuperscriptBox["\[Omega]", "2"]}]}]], "=", " ", 
    RowBox[{"I", 
     SqrtBox[
      RowBox[{
       SuperscriptBox["\[CapitalDelta]", "2"], "+", 
       SuperscriptBox["\[Omega]", "2"]}]]}]}], TraditionalForm]],
  FontSize->14,ExpressionUUID->"e6060d88-9fed-465b-b161-43d1c7b139d9"],
 " inside an exponential.   One of the variables has to be defined to be > 0 \
and not just \[GreaterSlantEqual] 0."
}], "Text",
 CellChangeTimes->{{3.661454934610312*^9, 3.661455077339642*^9}, {
   3.661455120999338*^9, 3.6614551250107203`*^9}, {3.66145516298409*^9, 
   3.661455238939184*^9}, {3.6614552751916943`*^9, 3.6614553005499*^9}, 
   3.66169791700492*^9},
 FontSize->18,ExpressionUUID->"9361befa-f2a8-4535-9485-c390512fc0e6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"\[CapitalDelta]$I", ",", "                 ", 
    RowBox[{"(*", " ", 
     RowBox[{"resonance", " ", "offset", " ", "frequency"}], " ", "*)"}], 
    "\[IndentingNewLine]", "\[CapitalDelta]$S", ",", "                 ", 
    RowBox[{"(*", " ", 
     RowBox[{"resonance", " ", "offset", " ", "frequency"}], " ", "*)"}], 
    "\[IndentingNewLine]", "J", ",", "                      ", 
    RowBox[{"(*", " ", 
     RowBox[{"spin", "-", 
      RowBox[{"spin", " ", "coupling"}]}], " ", "*)"}], "\[IndentingNewLine]",
     "Ix", ",", " ", "Iy", ",", " ", "Iz", ",", " ", 
    RowBox[{"(*", " ", 
     RowBox[{"spin", " ", "angular", " ", "momentum", " ", "operators"}], " ",
      "*)"}], "\[IndentingNewLine]", "Sx", ",", " ", "Sy", ",", " ", "Sz", 
    ",", " ", 
    RowBox[{"(*", " ", 
     RowBox[{"spin", " ", "angular", " ", "momentum", " ", "operators"}], " ",
      "*)"}], "\[IndentingNewLine]", "\[Rho]", ",", "                      ", 
    
    RowBox[{"(*", " ", 
     RowBox[{"spin", " ", "density", " ", "operator"}], " ", "*)"}], " ", 
    "\[IndentingNewLine]", "t", ",", "                       ", 
    RowBox[{"(*", " ", "time", " ", "*)"}], "\[IndentingNewLine]", "\[Rho]$0",
     ",", "                  ", 
    RowBox[{"(*", " ", 
     RowBox[{"initial", " ", "spin", " ", "density", " ", "operator"}], " ", 
     "*)"}], "\[IndentingNewLine]", "H"}], "                          ", 
   RowBox[{"(*", " ", 
    RowBox[{"spin", " ", "Hamiltonian"}], " ", "*)"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CreateScalar", "[", 
   RowBox[{
   "\[CapitalDelta]$I", ",", "\[CapitalDelta]$S", ",", "J", ",", "t"}], " ", 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CreateOperator", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Ix", ",", " ", "Iy", ",", " ", "Iz"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Sx", ",", " ", "Sy", ",", " ", "Sz"}], "}"}]}], "}"}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"SpinSingle$CreateOperators", "[", 
   RowBox[{"Ix", ",", " ", "Iy", ",", " ", "Iz", ",", " ", 
    RowBox[{"L", "=", 
     RowBox[{"1", "/", "2"}]}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SpinSingle$CreateOperators", "[", 
    RowBox[{"Sx", ",", " ", "Sy", ",", " ", "Sz", ",", " ", 
     RowBox[{"L", "=", 
      RowBox[{"1", "/", "2"}]}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$Assumptions", "  ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Element", "[", 
      RowBox[{"\[CapitalDelta]$I", ",", " ", "Reals"}], "]"}], ",", " ", 
     RowBox[{"\[CapitalDelta]$I", " ", "\[GreaterSlantEqual]", " ", "0"}], 
     ",", " ", 
     RowBox[{"Element", "[", 
      RowBox[{"\[CapitalDelta]$S", ",", " ", "Reals"}], "]"}], ",", " ", 
     RowBox[{"\[CapitalDelta]$S", " ", "\[GreaterSlantEqual]", " ", "0"}], 
     ",", " ", 
     RowBox[{"Element", "[", 
      RowBox[{"J", ",", " ", "Reals"}], "]"}], ",", " ", 
     RowBox[{"J", "  ", ">", " ", "0"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6614339585492563`*^9, 3.661434010703532*^9}, {
   3.661434214867899*^9, 3.661434222437502*^9}, {3.661434384868638*^9, 
   3.6614346039604807`*^9}, {3.6614346490398808`*^9, 3.661434789890903*^9}, {
   3.661435094092959*^9, 3.661435125986967*^9}, {3.6614352184576807`*^9, 
   3.661435260920999*^9}, 3.661454979504386*^9, {3.6614550830373096`*^9, 
   3.6614550896485147`*^9}, {3.661455140167131*^9, 3.66145514338946*^9}, {
   3.6614552141564493`*^9, 3.661455268214559*^9}, {3.671422223446307*^9, 
   3.671422276457761*^9}, {3.6714223930390167`*^9, 3.671422478451767*^9}, {
   3.6714445143764687`*^9, 3.671444514801667*^9}, {3.6714447631748466`*^9, 
   3.671444772352507*^9}, {3.671445003838581*^9, 3.6714450185403843`*^9}, {
   3.859899587907319*^9, 3.8598995977607327`*^9}},
 FontSize->16,
 CellLabel->"In[20]:=",ExpressionUUID->"aa221a61-11f4-40ee-ab06-7a1db9d83b98"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Evolution under J coupling", "Subsection",
 CellChangeTimes->{{3.661433867714074*^9, 3.661433876857678*^9}, {
  3.671421868173057*^9, 3.671421871614409*^9}, {3.6714219148357353`*^9, 
  3.671421918418017*^9}, {3.671422672061537*^9, 3.6714226776017923`*^9}},
 FontSize->18,ExpressionUUID->"5f6cb74e-219c-45e9-8745-333005cc07b3"],

Cell[TextData[{
 "On-resonance irradiation Hamiltonian written in the interaction \
representation.  The initial density operator is parallel to ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["I", "x"], TraditionalForm]],ExpressionUUID->
  "a1fc89cf-b744-4f88-81df-1eaae4139682"],
 "."
}], "Text",
 CellChangeTimes->{{3.66145534764102*^9, 3.661455424815099*^9}, {
   3.671421878357871*^9, 3.671421899244645*^9}, {3.671421943547707*^9, 
   3.671421954189911*^9}, 3.8598996137223682`*^9, 3.859900307767496*^9},
 FontSize->18,ExpressionUUID->"0d0d45a4-9b4c-4c4e-9fd5-55c424f24d39"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"H$0", " ", "=", " ", 
   RowBox[{
    RowBox[{"\[CapitalDelta]$I", " ", "Iz"}], " ", "+", " ", 
    RowBox[{"\[CapitalDelta]$S", " ", "Sz"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H$J", " ", "=", "  ", 
   RowBox[{"J", " ", 
    RowBox[{"Iz", " ", "**", "Sz"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]$0", " ", "=", " ", "Ix"}], ";"}]}], "Input",
 CellChangeTimes->{{3.661435227848398*^9, 3.6614352284068127`*^9}, {
  3.67142180007626*^9, 3.6714218530576353`*^9}, {3.671421959643671*^9, 
  3.6714219696004133`*^9}, {3.6714223575305777`*^9, 3.6714223833917007`*^9}, {
  3.671422492003399*^9, 3.6714225172812433`*^9}, {3.671422565223255*^9, 
  3.6714226639457006`*^9}, {3.671422720776108*^9, 3.671422732714869*^9}, {
  3.671422884191368*^9, 3.671422906513636*^9}, {3.671445306458117*^9, 
  3.671445315152834*^9}},
 FontSize->18,
 CellLabel->"In[26]:=",ExpressionUUID->"a00dcacb-437c-4f36-839c-e925ff9a9abf"],

Cell["Try to calculate the density operator in a single step.", "Text",
 CellChangeTimes->{{3.6614351443358517`*^9, 3.661435173054531*^9}, {
  3.6614549233087606`*^9, 3.661454923410828*^9}, {3.66145543210454*^9, 
  3.661455456329935*^9}, {3.671423019921378*^9, 3.671423027975905*^9}, {
  3.671444610818163*^9, 3.6714446239059343`*^9}},
 FontSize->18,ExpressionUUID->"6146a20e-e81d-4da7-a74d-066b888f45bb"],

Cell[BoxData[
 RowBox[{"SimplifyingEvolver", "[", 
  RowBox[{
   RowBox[{"H$0", "+", "H$J"}], ",", "t", ",", " ", "\[Rho]$0"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6714445338823757`*^9, 3.67144458551854*^9}, {
  3.67144462976528*^9, 3.6714446319951973`*^9}, {3.6714560711542673`*^9, 
  3.671456073271255*^9}, {3.859899621295248*^9, 3.859899625231573*^9}, {
  3.859899736711619*^9, 3.859899754038085*^9}},
 FontSize->18,
 CellLabel->"In[29]:=",ExpressionUUID->"009bb6a3-4959-4135-894a-ea1e8e62a288"],

Cell["\<\
This single-step evolution fails.  Instead, let us calculate the density \
operator in two steps.  We can do this because the H$J and H$0 Hamiltonians \
commute. Evolve under the J-coupling first and under the chemical shift \
second.\
\>", "Text",
 CellChangeTimes->{{3.6614351443358517`*^9, 3.661435173054531*^9}, {
   3.6614549233087606`*^9, 3.661454923410828*^9}, {3.66145543210454*^9, 
   3.661455456329935*^9}, {3.671423019921378*^9, 3.671423027975905*^9}, {
   3.671444658306387*^9, 3.671444659698904*^9}, {3.6714449146063337`*^9, 
   3.6714449155532513`*^9}, {3.6714450795854177`*^9, 3.67144514621312*^9}, {
   3.671445228941722*^9, 3.671445240799491*^9}, 3.859899634158753*^9, {
   3.859899829929502*^9, 3.859899831618025*^9}},
 FontSize->18,ExpressionUUID->"da25078d-f7a4-4cc5-b8e9-a9440c7db5ea"],

Cell[BoxData[
 RowBox[{"\[Rho]", " ", "=", " ", 
  RowBox[{
   RowBox[{"\[Rho]$0", "//", " ", 
    RowBox[{
     RowBox[{"SimplifyingEvolver", "[", 
      RowBox[{"H$J", ",", "t", ",", " ", "#"}], "]"}], "&"}]}], " ", "//", 
   " ", 
   RowBox[{
    RowBox[{"SimplifyingEvolver", "[", 
     RowBox[{"H$0", ",", "t", ",", " ", "#"}], "]"}], "&"}]}]}]], "Input",
 CellChangeTimes->{{3.6714445338823757`*^9, 3.67144458551854*^9}, {
  3.671444718970388*^9, 3.671444720200667*^9}, {3.67144506677122*^9, 
  3.671445068444508*^9}},
 FontSize->18,
 CellLabel->"In[30]:=",ExpressionUUID->"8b19999b-45e0-4234-a62f-e2467a9a91df"],

Cell["\<\
Try another way -- evolve under the chemical shift first and under the \
J-coupling second.\
\>", "Text",
 CellChangeTimes->{{3.671444834167573*^9, 3.671444836235317*^9}, 
   3.6714448860615*^9, {3.67144504811789*^9, 3.6714450516386957`*^9}, {
   3.671445149850709*^9, 3.671445168663072*^9}},
 FontSize->18,ExpressionUUID->"5dc683d5-9720-468d-8a4a-261ab1f93e5d"],

Cell[BoxData[
 RowBox[{"\[Rho]", " ", "=", " ", 
  RowBox[{
   RowBox[{"\[Rho]$0", "//", " ", 
    RowBox[{
     RowBox[{"SimplifyingEvolver", "[", 
      RowBox[{"H$0", ",", "t", ",", " ", "#"}], "]"}], "&"}]}], " ", "//", 
   " ", 
   RowBox[{
    RowBox[{"SimplifyingEvolver", "[", 
     RowBox[{"H$J", ",", "t", ",", " ", "#"}], "]"}], "&"}]}]}]], "Input",
 CellChangeTimes->{{3.671444842217965*^9, 3.67144484462682*^9}, {
  3.671445070458337*^9, 3.6714450715733213`*^9}},
 FontSize->18,
 CellLabel->"In[31]:=",ExpressionUUID->"f2e2b454-70cb-4958-b4ad-3b5aa09639f5"],

Cell["We see by inspection that we get the same answer either way.", "Text",
 CellChangeTimes->{{3.671445189839492*^9, 3.671445213699987*^9}},
 FontSize->18,ExpressionUUID->"9fa4c359-92ed-44f7-bd57-97d7150a9173"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Load spin 1/2 operator matrices", "Subsection",
 CellChangeTimes->{{3.661433867714074*^9, 3.661433876857678*^9}, {
  3.671421868173057*^9, 3.671421871614409*^9}, {3.6714219148357353`*^9, 
  3.671421918418017*^9}, {3.671422672061537*^9, 3.6714226776017923`*^9}, {
  3.671445358783841*^9, 3.671445362453095*^9}, {3.671446027798325*^9, 
  3.6714460412821283`*^9}, {3.6714462497064*^9, 3.671446264593584*^9}},
 FontSize->18,ExpressionUUID->"900e6483-1356-497f-8419-667ab249f42b"],

Cell["\<\
Load matrices representing two J=1/2 spins and give them a test drive.\
\>", "Text",
 CellChangeTimes->{{3.6714456820202208`*^9, 3.6714457113829813`*^9}, {
  3.671445998615802*^9, 3.6714460069003553`*^9}},
 FontSize->18,ExpressionUUID->"f0a13f73-9adf-4099-89ea-810a8aea9408"],

Cell[BoxData[
 RowBox[{"<<", "Matrices--two-spin-half.m"}]], "Input",
 CellChangeTimes->{{3.671445490424717*^9, 3.6714454909529467`*^9}},
 FontSize->16,
 CellLabel->"In[32]:=",ExpressionUUID->"e09b53da-7781-4a5f-80b4-2302df931d48"],

Cell["Let's look at one of the matrices, the matrix for Iz. ", "Text",
 CellChangeTimes->{{3.671446066910582*^9, 3.6714461288371677`*^9}},
 FontSize->18,ExpressionUUID->"20524f0c-f0f7-4f1a-a313-cd31b5871c6c"],

Cell[BoxData[{
 RowBox[{"mIz", " ", "//", " ", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"mSz", " ", "//", " ", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.6714461004791517`*^9, 3.671446108624913*^9}, {
  3.6714561340688353`*^9, 3.6714561363062973`*^9}},
 FontSize->18,
 CellLabel->"In[33]:=",ExpressionUUID->"b3d33e44-c391-4925-9952-e75f223a4c4d"],

Cell["\<\
For a single spin 1/2 particle, Iz is a 2 x 2 matrix.  In the product space \
of two spin 1/2 particles, however, the Iz is now a 4 x 4 matrix.  All the \
operators are 4 x 4 matrices.

Check that the [Ix, Iy]/I = Iz and [Sx, Sy]/I = Sz commutation relations hold \
with the matrices.\
\>", "Text",
 CellChangeTimes->{{3.6714457461606293`*^9, 3.671445793433889*^9}, {
  3.671446130846957*^9, 3.6714462332544622`*^9}},
 FontSize->18,ExpressionUUID->"47c29951-2635-4173-8c18-89a753dcd1ce"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"m$1", "=", " ", 
    FractionBox[
     RowBox[{
      RowBox[{"mIx", " ", ".", " ", "mIy"}], " ", "-", " ", 
      RowBox[{"mIy", ".", "mIx"}]}], "I"]}], " ", ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"m$2", " ", "=", " ", 
    FractionBox[
     RowBox[{
      RowBox[{"mSx", " ", ".", " ", "mSy"}], " ", "-", " ", 
      RowBox[{"mSy", ".", "mSx"}]}], "I"]}], " ", ";"}], " "}]}], "Input",
 CellChangeTimes->{{3.671445494504896*^9, 3.671445533291304*^9}, {
  3.671445568666006*^9, 3.67144560414019*^9}, {3.6714458103519*^9, 
  3.671445839226697*^9}},
 FontSize->16,
 CellLabel->"In[35]:=",ExpressionUUID->"75ac0881-3718-4e14-ae67-3279c0940096"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"m$1", " ", "//", " ", "MatrixForm"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"should", " ", "be", " ", "Iz"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"m$2", " ", "//", " ", "MatrixForm", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"should", " ", "be", " ", "Sz"}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.67144559223693*^9, 3.671445621775893*^9}, {
  3.671445829324806*^9, 3.671445840614127*^9}},
 FontSize->16,
 CellLabel->"In[37]:=",ExpressionUUID->"57f6e5db-0e3a-4d3e-a2a3-99ea8947662b"],

Cell["\<\
Make the (matrix) operator I$total = Iz + Sz.  We can see by inspection that \
this matrix looks correct.  The I$total operator should have eigenvalues \
{-1,0,0,+1}.  The matrix I$total is diagonal and we can read the eigenvalues \
off diagonal elements.\
\>", "Text",
 CellChangeTimes->{{3.671445880334059*^9, 3.6714459936436*^9}},
 FontSize->18,ExpressionUUID->"5a6818dd-027f-4a6a-a7d2-ced5add9e6ea"],

Cell[BoxData[
 RowBox[{
  RowBox[{"m$1", " ", "+", " ", "m$2"}], " ", "//", " ", 
  "MatrixForm"}]], "Input",
 FontSize->16,
 CellLabel->"In[39]:=",ExpressionUUID->"a9d6d1b3-f2e4-467b-9dc8-9135de17bb64"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculate the analytical signal using the matrices", "Subsection",
 CellChangeTimes->{{3.671446273220752*^9, 3.671446279573361*^9}, {
  3.671446693404964*^9, 3.6714467036370564`*^9}, {3.671446816216303*^9, 
  3.671446818974146*^9}},ExpressionUUID->"e54a5818-8a28-4218-a188-\
7e67d5d3ac23"],

Cell["\<\
Write the matrix representation of Iy Sz using the matrices loaded above.\
\>", "Text",
 CellChangeTimes->{{3.859900709821823*^9, 3.8599007456790133`*^9}},
 FontSize->18,ExpressionUUID->"3af15648-fb3c-4a4a-808f-527af5905935"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mIy", " ", ".", " ", "mSz"}], " ", "//", " ", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.8599006855011597`*^9, 3.859900698203217*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"7d4cc931-0111-4dbc-b7e8-40749702ba4b"],

Cell["\<\
Show that we can obtain the same matrix from the symbolic product Iy**Sz by \
(1) substituting the spin operators with matrices and (2) replacing the \
NonCommutativeMultiply operator with the Dot (i.e., matrix multiplication) \
operator.\
\>", "Text",
 CellChangeTimes->{{3.859900709821823*^9, 3.859900831482979*^9}},
 FontSize->18,ExpressionUUID->"3b05a16a-acf3-4271-be14-59833de80251"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Iy", "**", "Sz"}], " ", "/.", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Ix", "\[Rule]", " ", "mIx"}], ",", " ", 
      RowBox[{"Iy", "\[Rule]", " ", "mIy"}], ",", " ", 
      RowBox[{"Iz", "\[Rule]", " ", "mIz"}], ",", " ", 
      RowBox[{"Sx", "\[Rule]", " ", "mSx"}], ",", " ", 
      RowBox[{"Sy", "\[Rule]", " ", "mSy"}], ",", " ", 
      RowBox[{"Sz", "\[Rule]", " ", "mSz"}]}], "}"}]}], " ", "//.", " ", 
   RowBox[{"NonCommutativeMultiply", " ", "->", " ", "Dot"}]}], " ", "//", 
  " ", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.859900472210082*^9, 3.859900600246011*^9}, {
  3.859900663438994*^9, 3.8599006802598352`*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"8bea8132-36b3-4e56-93f7-44122001fdf2"],

Cell[BoxData[
 RowBox[{"\[Rho]", " ", "//", " ", "Expand"}]], "Input",
 CellChangeTimes->{{3.859902056844697*^9, 3.8599020809360657`*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"1082791b-92d1-44ce-a391-7ac2b03dcb0b"],

Cell["Calculate the density operator matrix.", "Text",
 CellChangeTimes->{{3.671446402857369*^9, 3.671446411712953*^9}},
 FontSize->18,ExpressionUUID->"48564b56-62a0-4837-acd7-12acc8797d9a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"\[Rho]$matrix", ",", "\[Rho]$temp", ",", " ", "t"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]$temp", " ", "=", " ", 
   RowBox[{
    RowBox[{"Expand", "[", "\[Rho]", "]"}], " ", "/.", " ", 
    RowBox[{"NonCommutativeMultiply", " ", "->", " ", "Dot"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]$matrix", "[", "t_", "]"}], "  ", "=", " ", 
   RowBox[{"\[Rho]$temp", " ", "/.", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Ix", "\[Rule]", " ", "mIx"}], ",", " ", 
      RowBox[{"Iy", "\[Rule]", " ", "mIy"}], ",", " ", 
      RowBox[{"Iz", "\[Rule]", " ", "mIz"}], ",", " ", 
      RowBox[{"Sx", "\[Rule]", " ", "mSx"}], ",", " ", 
      RowBox[{"Sy", "\[Rule]", " ", "mSy"}], ",", " ", 
      RowBox[{"Sz", "\[Rule]", " ", "mSz"}]}], "}"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.671446283504434*^9, 3.671446370013102*^9}, {
  3.859900839721766*^9, 3.8599008746061563`*^9}, {3.859901349863592*^9, 
  3.85990136359834*^9}, {3.859901398139648*^9, 3.859901420964809*^9}, {
  3.8599015554727993`*^9, 3.859901628586875*^9}, {3.8599016883356743`*^9, 
  3.8599017190851803`*^9}, {3.859901832689295*^9, 3.8599019034863234`*^9}, {
  3.8599020157005043`*^9, 3.859902049955055*^9}, {3.8599020864539948`*^9, 
  3.85990208891566*^9}, {3.859902162704073*^9, 3.8599021823705397`*^9}, {
  3.859902372530554*^9, 3.8599023810736237`*^9}},
 FontSize->16,
 CellLabel->"In[44]:=",ExpressionUUID->"cda4d189-8e5d-49b2-80b0-8e5f6aa9cf58"],

Cell["\<\
Check that the resulting object is a 4 x 4 matrix as expected.\
\>", "Text",
 CellChangeTimes->{{3.859901672373654*^9, 3.859901684915783*^9}, {
  3.859901907065651*^9, 3.859901933782159*^9}},
 FontSize->18,ExpressionUUID->"f72a8bff-ed0a-4453-8c58-d3ebcd4bdb11"],

Cell[BoxData[
 RowBox[{"Dimensions", "[", 
  RowBox[{"\[Rho]$matrix", "[", "t", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.859901514235689*^9, 3.8599015728133507`*^9}, {
  3.859901645494369*^9, 3.859901664373424*^9}},
 FontSize->16,
 CellLabel->"In[47]:=",ExpressionUUID->"954a805e-eefd-42e9-a649-7d498e511b42"],

Cell["\<\
From this matrix we can calculate the I-spin signals as Trace[\[Rho] Ix] and \
Trace[\[Rho] Iy]\
\>", "Text",
 CellChangeTimes->{{3.671446415848536*^9, 3.6714464343628063`*^9}, {
  3.671446572921509*^9, 3.671446610169005*^9}},
 FontSize->18,ExpressionUUID->"5ba50181-334b-49dd-b2a8-32fd4e09ae9e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Tr", "[", 
   RowBox[{
    RowBox[{"\[Rho]$matrix", "[", "t", "]"}], " ", ".", " ", "mIx"}], "]"}], 
  " ", "//", " ", "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tr", "[", 
   RowBox[{
    RowBox[{"\[Rho]$matrix", "[", "t", "]"}], " ", ".", " ", "mIy"}], "]"}], 
  " ", "//", " ", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.671446436184062*^9, 3.671446460159924*^9}, {
  3.671446493512258*^9, 3.671446525803396*^9}, {3.671446589260594*^9, 
  3.6714465911514063`*^9}, {3.8599024012335443`*^9, 3.859902403279496*^9}},
 FontSize->16,
 CellLabel->"In[48]:=",ExpressionUUID->"be6189c1-db5d-45b1-80db-ca1487d5ee0f"],

Cell["\<\
We can mimic the complex signal collected by the NMR spectrometer by \
calculating the expectation value of the Ix + I Iy operator: Trace[\[Rho] \
(Ix+ I Iy)].\
\>", "Text",
 CellChangeTimes->{{3.671446615373083*^9, 3.671446675573143*^9}},
 FontSize->18,ExpressionUUID->"13313468-51da-4a4a-80b0-8ec29e0a1dbd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "S", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S", "[", "t_", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"Tr", "[", 
    RowBox[{
     RowBox[{"\[Rho]$matrix", "[", "t", "]"}], " ", ".", " ", 
     RowBox[{"(", 
      RowBox[{"mIx", "-", " ", 
       RowBox[{"I", " ", "mIy"}]}], ")"}]}], "]"}], "  ", "//", " ", 
   "TrigToExp", " "}]}]}], "Input",
 CellChangeTimes->{{3.671446537674589*^9, 3.671446565590992*^9}, {
   3.671446679689185*^9, 3.671446686372024*^9}, {3.671446793205759*^9, 
   3.671446804190036*^9}, 3.6714481371244497`*^9, {3.6714505565428677`*^9, 
   3.671450556829133*^9}, {3.85990112188903*^9, 3.859901145714314*^9}, 
   3.859901226752716*^9, {3.859902412650629*^9, 3.859902412852398*^9}},
 FontSize->16,
 CellLabel->"In[50]:=",ExpressionUUID->"1c1073be-7d88-452b-9512-b3174998d9d5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plot the signal as a function of time", "Subsection",
 CellChangeTimes->{{3.671446822352291*^9, 3.6714468757257767`*^9}},
 FontSize->18,ExpressionUUID->"b6f424bd-f7ac-4ab8-95b6-1fd8d9da141e"],

Cell["\<\
Create a more realistic experimental signal by multiplying the \
above-calculated signal by a decaying exponential.\
\>", "Text",
 CellChangeTimes->{{3.6714469211618567`*^9, 3.6714470073287077`*^9}},
 FontSize->18,ExpressionUUID->"e6b699c3-eb95-4b50-b0e8-5d02c9fe3fbb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "S$expt", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S$expt", "[", "t_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"S", "[", "t", "]"}], " ", 
   RowBox[{"Exp", "[", 
    RowBox[{
     RowBox[{"-", "t"}], "/", "T2"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.671446889252241*^9, 3.6714469026844177`*^9}, {
  3.671446959436038*^9, 3.671446970904915*^9}, {3.671447429270523*^9, 
  3.6714474332727137`*^9}, {3.8599011272242737`*^9, 3.859901165678814*^9}, {
  3.859901233446213*^9, 3.859901248154087*^9}, {3.859901335588386*^9, 
  3.859901335834333*^9}},
 FontSize->16,
 CellLabel->"In[52]:=",ExpressionUUID->"cbdfd4de-64c0-49db-b61a-2c0951ae6240"],

Cell["\<\
To plot, set the total number of points (NN) and the total time (T).  We set \
NN equal to a power of 2 in anticipation of taking a digital Fourier \
transform.\
\>", "Text",
 CellChangeTimes->{{3.5949414229321012`*^9, 3.594941479672656*^9}},
 FontSize->18,ExpressionUUID->"e640b672-ffe0-431b-87f3-9505b6edb67c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"NN", " ", "=", " ", 
   RowBox[{"2", "^", "10"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"T$final", " ", "=", " ", "10.0"}], ";"}]}], "Input",
 CellChangeTimes->{{3.594991722414856*^9, 3.5949917229397697`*^9}, {
   3.6714502329166527`*^9, 3.671450233424068*^9}, {3.671450477554515*^9, 
   3.6714504778582277`*^9}, 3.859899950775682*^9},
 FontSize->18,
 CellLabel->"In[54]:=",ExpressionUUID->"d8efecf0-2a62-458e-b62f-4b33e8b56403"],

Cell["\<\
From NN and T$final we derive the time step (dt) and the frequency step (df). \
 Now generate a list of data points based on the above function.  At the same \
time, generate a list of time points (t) and frequency points (f) for \
plotting. \
\>", "Text",
 CellChangeTimes->{{3.59494150240346*^9, 3.594941603782978*^9}, {
  3.859899958105795*^9, 3.8598999590267763`*^9}},
 FontSize->18,ExpressionUUID->"154b1608-ad44-44c9-af55-1b59d9355349"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dt", " ", "=", " ", 
   RowBox[{"T$final", "/", 
    RowBox[{"(", 
     RowBox[{"NN", "-", "1"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"df", " ", "=", " ", 
    RowBox[{"1", "/", "dt"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f$table", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"jj", "/", "T$final"}], ",", 
     RowBox[{"{", 
      RowBox[{"jj", ",", 
       RowBox[{
        RowBox[{"-", "NN"}], "/", "2"}], ",", 
       RowBox[{
        RowBox[{"NN", "/", "2"}], "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t$table", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"ii", "*", "dt"}], ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", "0", ",", 
        RowBox[{"NN", "-", "1"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<The time step is \>\"", ",", "dt", ",", "\"\< s\>\""}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<The Nyquist frequency is \>\"", ",", 
   RowBox[{"1", "/", 
    RowBox[{"(", 
     RowBox[{"2", "*", "dt"}], ")"}]}], ",", "\"\< Hz\>\""}], "]"}]}], "Input",\

 CellChangeTimes->{{3.59493235695424*^9, 3.5949324622740393`*^9}, {
   3.5949329212374773`*^9, 3.594933020293639*^9}, {3.594941484330391*^9, 
   3.594941501373295*^9}, {3.594941696885819*^9, 3.5949417765822287`*^9}, {
   3.594941818366678*^9, 3.594941819859702*^9}, {3.5949469989336433`*^9, 
   3.594947001044293*^9}, 3.5949577630752707`*^9, {3.859899967730145*^9, 
   3.859899974070663*^9}, {3.859902433600025*^9, 3.859902449967457*^9}, {
   3.859902481080266*^9, 3.8599024876023083`*^9}},
 FontSize->18,
 CellLabel->"In[56]:=",ExpressionUUID->"fbee6dd7-73b7-425f-a688-dd2fedfa9610"],

Cell["Give numbers for the chemical shift and the J-coupling.", "Text",
 CellChangeTimes->{{3.671447394983695*^9, 3.6714474158952637`*^9}},
 FontSize->18,ExpressionUUID->"83372887-9c68-4ad3-bbaf-f1f9e7633ea2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalDelta]$I$value", " ", "=", " ", 
    RowBox[{"2", "\[Pi]", " ", "\[Times]", "10.0"}]}], ";"}], "    ", 
  RowBox[{"(*", " ", 
   RowBox[{"chemical", " ", 
    RowBox[{"shift", " ", "[", 
     RowBox[{"rad", "/", "s"}], "]"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"J$value", " ", "=", "  ", 
    RowBox[{"2", "\[Pi]", " ", "\[Times]", " ", "8.0"}]}], ";"}], "         ", 
  RowBox[{"(*", " ", 
   RowBox[{"heteronuclear", " ", "scalar", " ", "coupling", " ", 
    RowBox[{"constant", " ", "[", 
     RowBox[{"rad", "/", "s"}], "]"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"T2$value", " ", "=", " ", "1.0"}], ";", "                  ", 
  RowBox[{"(*", " ", 
   RowBox[{"spin", " ", "dephasing", " ", 
    RowBox[{"time", " ", "[", "s", "]"}]}], " ", "*)"}], 
  "\[IndentingNewLine]"}]}], "Input",
 CellChangeTimes->{{3.671447604729793*^9, 3.671447668917508*^9}, {
  3.6714477541558647`*^9, 3.671447778543397*^9}, {3.671450991153552*^9, 
  3.671451022391514*^9}, {3.8599024967911453`*^9, 3.859902510933222*^9}, {
  3.8599025995481*^9, 3.8599026006667433`*^9}, {3.8599027887183523`*^9, 
  3.859902800358717*^9}},
 FontSize->18,
 CellLabel->"In[62]:=",ExpressionUUID->"1de97f2a-6dc3-4037-911b-c87f4a56654c"],

Cell["Create an array of complex signal.", "Text",
 CellChangeTimes->{{3.8599027700211782`*^9, 3.859902785891461*^9}},
 FontSize->18,ExpressionUUID->"894b6005-0866-4514-a87a-0db8f63e30a2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"S$table", " ", "=", " ", 
   RowBox[{
    RowBox[{"S$expt", "[", "t", "]"}], " ", "/.", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"t", "->", " ", "t$table"}], ",", " ", 
      RowBox[{
      "\[CapitalDelta]$I", " ", "->", " ", "\[CapitalDelta]$I$value"}], ",", 
      " ", 
      RowBox[{"J", "->", " ", "J$value"}], ",", " ", 
      RowBox[{"T2", " ", "->", " ", "T2$value"}]}], "}"}]}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.859902805270455*^9, 3.859902856958015*^9}},
 FontSize->18,
 CellLabel->"In[65]:=",ExpressionUUID->"9e13bd85-d0ea-4380-bce5-be5cc118b76a"],

Cell["Plot the real and imaginary part of the signal", "Text",
 CellChangeTimes->{{3.6714500367811728`*^9, 3.67145005728123*^9}},
 FontSize->18,ExpressionUUID->"c36d0436-50ef-41a2-bead-2cfde80ef98d"],

Cell[BoxData[
 RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"t$table", ",", " ", 
        RowBox[{"Re", "[", "S$table", "]"}]}], "}"}], " ", "//", " ", 
      "Transpose"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"t$table", ",", " ", 
        RowBox[{"Im", "[", "S$table", "]"}]}], "}"}], " ", "//", " ", 
      "Transpose"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Joined", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", "\[IndentingNewLine]", 
   RowBox[{
   "PlotLabel", "\[Rule]", 
    "\"\<Free induction decay of 1H coupled to 13C\\n\>\""}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<time [s]\>\"", ",", "\"\<Signal(t)\>\""}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.67144779890044*^9, 3.671447848340846*^9}, {
   3.671447937029454*^9, 3.6714479473527603`*^9}, {3.671447999669054*^9, 
   3.671448034363092*^9}, {3.671449785628702*^9, 3.671449951663116*^9}, {
   3.8599025239964*^9, 3.859902578876005*^9}, {3.859902647481073*^9, 
   3.85990266325028*^9}, 3.8599028272780333`*^9, {3.859902866351367*^9, 
   3.859902880506741*^9}},
 FontSize->18,
 CellLabel->"In[66]:=",ExpressionUUID->"835fb826-51ef-478e-bf2f-bb55b9b73fe0"],

Cell["\<\
A function to calculate the digital Fourier transform of signal.\
\>", "Text",
 CellChangeTimes->{{3.67145051013356*^9, 3.671450534424446*^9}},
 FontSize->18,ExpressionUUID->"3807d7d3-1841-4546-bb04-9d37fc78e5c8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DFFT", "[", 
   RowBox[{"signal$table_", ",", "time$table_", ",", " ", 
    RowBox[{"query_", ":", "True"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "True", " ", "to", " ", "plot", " ", "both", " ", "real", " ", "and", " ", 
    "imaginary", " ", "FT", " ", "parts"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"NN", ",", "T$final"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"NN", " ", "=", " ", 
      RowBox[{
       RowBox[{"Dimensions", "[", "signal$table", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"FFTS$table", "=", " ", 
      RowBox[{"RotateRight", "[", 
       RowBox[{
        RowBox[{"Fourier", "[", "signal$table", "]"}], ",", 
        RowBox[{"NN", "/", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"T$final", " ", "=", " ", 
      RowBox[{"time$table", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"f$table", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"jj", "/", "T$final"}], ",", 
        RowBox[{"{", 
         RowBox[{"jj", ",", 
          RowBox[{
           RowBox[{"-", "NN"}], "/", "2"}], ",", 
          RowBox[{
           RowBox[{"NN", "/", "2"}], "-", "1"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"p1", "=", " ", 
      RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"time$table", ",", 
             RowBox[{"Re", "[", "signal$table", "]"}]}], "}"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"time$table", ",", 
             RowBox[{"Im", "[", "signal$table", "]"}]}], "}"}], "]"}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"AxesLabel", "\[Rule]", " ", 
         RowBox[{"{", 
          RowBox[{"\"\<time [s]\>\"", ",", "\"\<signal\>\""}], "}"}]}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"query", " ", "\[Equal]", " ", "True"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"p2", "=", 
        RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{"f$table", ",", 
               RowBox[{"Re", "[", "FFTS$table", "]"}]}], "}"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{"f$table", ",", 
               RowBox[{"Im", "[", "FFTS$table", "]"}]}], "}"}], "]"}]}], " ", 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"PlotRange", "\[Rule]", " ", "All"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<freq [Hz]\>\"", ",", "\"\<DFT{signal}\>\""}], 
            "}"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"p2", "=", 
        RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"f$table", ",", 
             RowBox[{"Re", "[", "FFTS$table", "]"}]}], "}"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"PlotRange", "\[Rule]", " ", "All"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<freq [Hz]\>\"", ",", "\"\<DFT{signal}\>\""}], 
            "}"}]}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{"GraphicsGrid", "[", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"p1", ",", "p2"}], "}"}], "}"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.594944534421811*^9, 3.5949447042651577`*^9}, {
   3.594944761549816*^9, 3.5949447856729527`*^9}, {3.5949457080553913`*^9, 
   3.594945725580372*^9}, 3.594957008065167*^9, {3.5949599090104303`*^9, 
   3.594959943126217*^9}, {3.671420918194263*^9, 3.671420985060692*^9}, {
   3.6714500698553047`*^9, 3.6714501975055017`*^9}, {3.671450354497389*^9, 
   3.671450368115725*^9}, {3.6714504102572317`*^9, 3.671450429646456*^9}, {
   3.6714507085616426`*^9, 3.671450719913899*^9}, {3.671450779304175*^9, 
   3.671450820615818*^9}, {3.6714508637422657`*^9, 3.671450868872673*^9}, {
   3.6714509162185383`*^9, 3.671450949134245*^9}, {3.6714510544854803`*^9, 
   3.671451069853394*^9}, {3.859899988700041*^9, 3.859900006948498*^9}, {
   3.859902688052862*^9, 3.8599027001263247`*^9}, {3.859902892819016*^9, 
   3.859903052650466*^9}, {3.859903253889744*^9, 3.859903388607252*^9}, {
   3.859903455278821*^9, 3.859903470179755*^9}, {3.859903551630775*^9, 
   3.859903589468793*^9}, {3.859903721037855*^9, 3.859903753695388*^9}, {
   3.8599042554529667`*^9, 3.859904256154804*^9}},
 FontSize->18,
 CellLabel->"In[67]:=",ExpressionUUID->"44ccebcc-e4e6-4cef-93eb-8eb2dabaa7ae"],

Cell["Fourier transform the signal to obtain the spectrum.", "Text",
 CellChangeTimes->{{3.6714510493757668`*^9, 3.6714510513046627`*^9}, {
  3.671451088925737*^9, 3.671451100765924*^9}},
 FontSize->18,ExpressionUUID->"96978c98-aeb0-4bc8-ba58-6e65b86bb7f5"],

Cell[BoxData[
 RowBox[{"DFFT", "[", 
  RowBox[{"S$table", ",", "t$table", ",", " ", "False"}], "]"}]], "Input",
 CellChangeTimes->{{3.6714476849652023`*^9, 3.671447688933979*^9}, {
   3.671450451756751*^9, 3.671450457086381*^9}, {3.671450955985718*^9, 
   3.671450959835928*^9}, {3.671451075639289*^9, 3.6714510806381702`*^9}, {
   3.8599027294202337`*^9, 3.859902730479754*^9}, {3.859903070319248*^9, 
   3.859903074166995*^9}, {3.8599035426301928`*^9, 3.859903581324877*^9}, 
   3.859903730474251*^9},
 FontSize->18,
 CellLabel->"In[68]:=",ExpressionUUID->"35349024-74bd-45c4-bbd7-c1aad2e282cf"],

Cell[TextData[{
 "Find peaks in the FT spectrum.  Require the peaks to be larger than 1.0.   \
See the FindPeaks function documentation ",
 ButtonBox["here",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://reference.wolfram.com/language/ref/FindPeaks.html"], None},
  ButtonNote->"https://reference.wolfram.com/language/ref/FindPeaks.html"],
 "."
}], "Text",
 CellChangeTimes->{{3.859904074803982*^9, 3.859904162669261*^9}},
 FontSize->18,ExpressionUUID->"226421c5-9fdd-461d-bf17-a19be61552fa"],

Cell[BoxData[
 RowBox[{"peaks", " ", "=", " ", 
  RowBox[{"FindPeaks", "[", 
   RowBox[{
    RowBox[{"Re", "[", "FFTS$table", "]"}], ",", " ", "0", ",", " ", "0", ",",
     " ", "1."}], "]"}]}]], "Input",
 CellChangeTimes->{{3.859903825190135*^9, 3.859903866938795*^9}, {
  3.859903913142873*^9, 3.859903919826733*^9}, {3.859903990661255*^9, 
  3.859904070467599*^9}, {3.8599041690877323`*^9, 3.859904169738769*^9}},
 FontSize->16,
 CellLabel->"In[69]:=",ExpressionUUID->"5d35f71b-8a0a-4491-b5b5-85982060ada4"],

Cell["\<\
Read out the frequencies at which the peaks are located.  We see peaks at the \
expected frequencies of 10-8/2 = 6 Hz and 10+8/2 = 14 Hz.\
\>", "Text",
 CellChangeTimes->{{3.859904177210867*^9, 3.8599041942769947`*^9}, {
  3.859904417458054*^9, 3.859904434749054*^9}, {3.859904495320896*^9, 
  3.8599045088912477`*^9}},
 FontSize->18,ExpressionUUID->"73e6a9eb-006f-4454-a078-392f66b31294"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Part", "[", 
   RowBox[{"f$table", ",", 
    RowBox[{
     RowBox[{"Transpose", "[", "peaks", "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "]"}], " "}]], "Input",
 CellChangeTimes->{{3.859904200160055*^9, 3.85990429170259*^9}, 
   3.8599044080733547`*^9},
 FontSize->16,
 CellLabel->"In[70]:=",ExpressionUUID->"cc1504b1-2d9c-4f08-bcd5-849d5f9c7733"]
}, Open  ]]
}, Open  ]],

Cell["Clean up", "Section",
 CellChangeTimes->{{3.661434199971715*^9, 
  3.661434206498426*^9}},ExpressionUUID->"1fdea6c8-e550-49d2-a137-\
73e817082a28"]
}, Open  ]]
},
WindowSize->{1318, 969},
WindowMargins->{{64, Automatic}, {Automatic, 166}},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
FrontEndVersion->"13.0 for Mac OS X x86 (64-bit) (December 2, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"77085660-538d-438f-95bc-e0a6c707bd55"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 311, 5, 98, "Title",ExpressionUUID->"9bff736d-4c0d-4164-ac50-6010707a1cd6"],
Cell[894, 29, 211, 6, 90, "Text",ExpressionUUID->"6f7894b0-f9a0-42a7-9171-6194e366610c"],
Cell[1108, 37, 673, 14, 38, "Text",ExpressionUUID->"7e9f2b5e-cdd0-4460-b6e7-cc0ad521ad19"],
Cell[CellGroupData[{
Cell[1806, 55, 171, 3, 67, "Section",ExpressionUUID->"53c56eb4-cde7-499c-badb-528efbdc7dc2"],
Cell[1980, 60, 370, 9, 84, "Text",ExpressionUUID->"9ddeefdf-eb4a-4c24-954b-28b5f7c3109e"],
Cell[2353, 71, 828, 17, 61, "Input",ExpressionUUID->"a419521a-c7ad-4f1d-b671-6a4dbc030bd8"],
Cell[3184, 90, 207, 2, 36, "Text",ExpressionUUID->"6166a40f-9cd5-4040-890a-26018e2090b1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3428, 97, 160, 3, 67, "Section",ExpressionUUID->"468777c8-bf9a-43fc-b526-fa4a7e7a1196"],
Cell[3591, 102, 741, 15, 64, "Text",ExpressionUUID->"97047fec-134c-4195-9ad4-2411a10634fb"],
Cell[4335, 119, 796, 18, 113, "Input",ExpressionUUID->"54113382-83cc-48fc-9f56-15f3f7f7521c"],
Cell[5134, 139, 383, 7, 64, "Text",ExpressionUUID->"76c4313c-63f7-4ce5-8da3-5f8f965c2a0c"],
Cell[5520, 148, 668, 14, 61, "Input",ExpressionUUID->"663f0f98-230c-4e74-a5d9-d519ad4fca77"]
}, Closed]],
Cell[CellGroupData[{
Cell[6225, 167, 174, 3, 53, "Section",ExpressionUUID->"6e04c5f1-bd3d-4e48-a954-33f17b608c40"],
Cell[6402, 172, 558, 14, 61, "Input",ExpressionUUID->"3b79a2b4-c5b1-427d-81cc-9b898b8033f8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6997, 191, 334, 5, 67, "Section",ExpressionUUID->"f6b43116-b609-4e9c-b16c-abdb4f965a10"],
Cell[CellGroupData[{
Cell[7356, 200, 168, 3, 54, "Subsection",ExpressionUUID->"a6bea89f-30b9-4fb1-ad88-85f066779394"],
Cell[7527, 205, 1009, 26, 64, "Text",ExpressionUUID->"7e4d1fff-4084-4f39-bb2e-211541b1ffd3"],
Cell[8539, 233, 2925, 61, 321, "Input",ExpressionUUID->"e27ff726-a31d-4280-9da5-b3ec0413d867"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11501, 299, 279, 4, 51, "Subsection",ExpressionUUID->"b296b0ef-707f-4427-bf88-3f932ba353eb"],
Cell[11783, 305, 572, 12, 39, "Text",ExpressionUUID->"8c4ddf58-9e12-4d7a-a1b2-e39a7011a1f9"],
Cell[12358, 319, 507, 10, 67, "Input",ExpressionUUID->"1e69b901-3a7f-4793-9b7e-da44f03e76c0"],
Cell[12868, 331, 375, 5, 38, "Text",ExpressionUUID->"4e2eadd0-83dc-4ff4-8aee-e1ab179f97d4"],
Cell[13246, 338, 1067, 19, 37, "Input",ExpressionUUID->"c99fe488-de19-4937-a048-776a190352e6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14350, 362, 221, 3, 51, "Subsection",ExpressionUUID->"3a888b7e-71cf-468a-91ce-f0ca1666c759"],
Cell[14574, 367, 550, 12, 39, "Text",ExpressionUUID->"3f9232f8-f86f-4f92-9383-000dc8758ff8"],
Cell[15127, 381, 524, 11, 67, "Input",ExpressionUUID->"6cbc036e-1b76-4e0c-8440-ec01ed30e832"],
Cell[15654, 394, 375, 5, 38, "Text",ExpressionUUID->"35c1528c-5f39-4b8c-b5dc-820b6cca3463"],
Cell[16032, 401, 1014, 16, 37, "Input",ExpressionUUID->"e399ead3-8c9b-4625-9721-b1487c38b024"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[17095, 423, 383, 6, 67, "Section",ExpressionUUID->"684595b5-1db8-4b78-8c65-f4e450c5d9fe"],
Cell[CellGroupData[{
Cell[17503, 433, 217, 4, 54, "Subsection",ExpressionUUID->"9d81a36a-8d42-4abc-90b8-70432f110a6b"],
Cell[17723, 439, 1009, 26, 64, "Text",ExpressionUUID->"9361befa-f2a8-4535-9485-c390512fc0e6"],
Cell[18735, 467, 4078, 86, 477, "Input",ExpressionUUID->"aa221a61-11f4-40ee-ab06-7a1db9d83b98"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22850, 558, 332, 4, 51, "Subsection",ExpressionUUID->"5f6cb74e-219c-45e9-8745-333005cc07b3"],
Cell[23185, 564, 576, 12, 39, "Text",ExpressionUUID->"0d0d45a4-9b4c-4c4e-9fd5-55c424f24d39"],
Cell[23764, 578, 985, 21, 96, "Input",ExpressionUUID->"a00dcacb-437c-4f36-839c-e925ff9a9abf"],
Cell[24752, 601, 405, 5, 38, "Text",ExpressionUUID->"6146a20e-e81d-4da7-a74d-066b888f45bb"],
Cell[25160, 608, 504, 10, 37, "Input",ExpressionUUID->"009bb6a3-4959-4135-894a-ea1e8e62a288"],
Cell[25667, 620, 816, 13, 64, "Text",ExpressionUUID->"da25078d-f7a4-4cc5-b8e9-a9440c7db5ea"],
Cell[26486, 635, 618, 15, 37, "Input",ExpressionUUID->"8b19999b-45e0-4234-a62f-e2467a9a91df"],
Cell[27107, 652, 372, 7, 38, "Text",ExpressionUUID->"5dc683d5-9720-468d-8a4a-261ab1f93e5d"],
Cell[27482, 661, 570, 14, 37, "Input",ExpressionUUID->"f2e2b454-70cb-4958-b4ad-3b5aa09639f5"],
Cell[28055, 677, 212, 2, 38, "Text",ExpressionUUID->"9fa4c359-92ed-44f7-bd57-97d7150a9173"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28304, 684, 481, 6, 51, "Subsection",ExpressionUUID->"900e6483-1356-497f-8419-667ab249f42b"],
Cell[28788, 692, 285, 5, 38, "Text",ExpressionUUID->"f0a13f73-9adf-4099-89ea-810a8aea9408"],
Cell[29076, 699, 231, 4, 34, "Input",ExpressionUUID->"e09b53da-7781-4a5f-80b4-2302df931d48"],
Cell[29310, 705, 208, 2, 38, "Text",ExpressionUUID->"20524f0c-f0f7-4f1a-a313-cd31b5871c6c"],
Cell[29521, 709, 360, 6, 67, "Input",ExpressionUUID->"b3d33e44-c391-4925-9952-e75f223a4c4d"],
Cell[29884, 717, 497, 10, 116, "Text",ExpressionUUID->"47c29951-2635-4173-8c18-89a753dcd1ce"],
Cell[30384, 729, 724, 20, 101, "Input",ExpressionUUID->"75ac0881-3718-4e14-ae67-3279c0940096"],
Cell[31111, 751, 542, 12, 61, "Input",ExpressionUUID->"57f6e5db-0e3a-4d3e-a2a3-99ea8947662b"],
Cell[31656, 765, 413, 7, 64, "Text",ExpressionUUID->"5a6818dd-027f-4a6a-a7d2-ced5add9e6ea"],
Cell[32072, 774, 203, 5, 34, "Input",ExpressionUUID->"a9d6d1b3-f2e4-467b-9dc8-9135de17bb64"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32312, 784, 295, 4, 54, "Subsection",ExpressionUUID->"e54a5818-8a28-4218-a188-7e67d5d3ac23"],
Cell[32610, 790, 235, 4, 38, "Text",ExpressionUUID->"3af15648-fb3c-4a4a-808f-527af5905935"],
Cell[32848, 796, 256, 5, 30, "Input",ExpressionUUID->"7d4cc931-0111-4dbc-b7e8-40749702ba4b"],
Cell[33107, 803, 398, 7, 64, "Text",ExpressionUUID->"3b05a16a-acf3-4271-be14-59833de80251"],
Cell[33508, 812, 786, 17, 30, "Input",ExpressionUUID->"8bea8132-36b3-4e56-93f7-44122001fdf2"],
Cell[34297, 831, 217, 3, 30, "Input",ExpressionUUID->"1082791b-92d1-44ce-a391-7ac2b03dcb0b"],
Cell[34517, 836, 190, 2, 38, "Text",ExpressionUUID->"48564b56-62a0-4837-acd7-12acc8797d9a"],
Cell[34710, 840, 1552, 32, 87, "Input",ExpressionUUID->"cda4d189-8e5d-49b2-80b0-8e5f6aa9cf58"],
Cell[36265, 874, 271, 5, 38, "Text",ExpressionUUID->"f72a8bff-ed0a-4453-8c58-d3ebcd4bdb11"],
Cell[36539, 881, 314, 6, 34, "Input",ExpressionUUID->"954a805e-eefd-42e9-a649-7d498e511b42"],
Cell[36856, 889, 306, 6, 38, "Text",ExpressionUUID->"5ba50181-334b-49dd-b2a8-32fd4e09ae9e"],
Cell[37165, 897, 665, 15, 61, "Input",ExpressionUUID->"be6189c1-db5d-45b1-80db-ca1487d5ee0f"],
Cell[37833, 914, 319, 6, 38, "Text",ExpressionUUID->"13313468-51da-4a4a-80b0-8ec29e0a1dbd"],
Cell[38155, 922, 866, 19, 61, "Input",ExpressionUUID->"1c1073be-7d88-452b-9512-b3174998d9d5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39058, 946, 197, 2, 51, "Subsection",ExpressionUUID->"b6f424bd-f7ac-4ab8-95b6-1fd8d9da141e"],
Cell[39258, 950, 279, 5, 38, "Text",ExpressionUUID->"e6b699c3-eb95-4b50-b0e8-5d02c9fe3fbb"],
Cell[39540, 957, 716, 16, 61, "Input",ExpressionUUID->"cbdfd4de-64c0-49db-b61a-2c0951ae6240"],
Cell[40259, 975, 322, 6, 38, "Text",ExpressionUUID->"e640b672-ffe0-431b-87f3-9505b6edb67c"],
Cell[40584, 983, 480, 10, 67, "Input",ExpressionUUID->"d8efecf0-2a62-458e-b62f-4b33e8b56403"],
Cell[41067, 995, 452, 8, 64, "Text",ExpressionUUID->"154b1608-ad44-44c9-af55-1b59d9355349"],
Cell[41522, 1005, 1895, 50, 246, "Input",ExpressionUUID->"fbee6dd7-73b7-425f-a688-dd2fedfa9610"],
Cell[43420, 1057, 209, 2, 38, "Text",ExpressionUUID->"83372887-9c68-4ad3-bbaf-f1f9e7633ea2"],
Cell[43632, 1061, 1319, 29, 125, "Input",ExpressionUUID->"1de97f2a-6dc3-4037-911b-c87f4a56654c"],
Cell[44954, 1092, 188, 2, 38, "Text",ExpressionUUID->"894b6005-0866-4514-a87a-0db8f63e30a2"],
Cell[45145, 1096, 615, 16, 37, "Input",ExpressionUUID->"9e13bd85-d0ea-4380-bce5-be5cc118b76a"],
Cell[45763, 1114, 199, 2, 38, "Text",ExpressionUUID->"c36d0436-50ef-41a2-bead-2cfde80ef98d"],
Cell[45965, 1118, 1427, 32, 241, "Input",ExpressionUUID->"835fb826-51ef-478e-bf2f-bb55b9b73fe0"],
Cell[47395, 1152, 223, 4, 38, "Text",ExpressionUUID->"3807d7d3-1841-4546-bb04-9d37fc78e5c8"],
Cell[47621, 1158, 5655, 128, 916, "Input",ExpressionUUID->"44ccebcc-e4e6-4cef-93eb-8eb2dabaa7ae"],
Cell[53279, 1288, 257, 3, 38, "Text",ExpressionUUID->"96978c98-aeb0-4bc8-ba58-6e65b86bb7f5"],
Cell[53539, 1293, 597, 10, 37, "Input",ExpressionUUID->"35349024-74bd-45c4-bbd7-c1aad2e282cf"],
Cell[54139, 1305, 505, 11, 38, "Text",ExpressionUUID->"226421c5-9fdd-461d-bf17-a19be61552fa"],
Cell[54647, 1318, 510, 10, 34, "Input",ExpressionUUID->"5d35f71b-8a0a-4491-b5b5-85982060ada4"],
Cell[55160, 1330, 399, 7, 38, "Text",ExpressionUUID->"73e6a9eb-006f-4454-a078-392f66b31294"],
Cell[55562, 1339, 391, 10, 34, "Input",ExpressionUUID->"cc1504b1-2d9c-4f08-bcd5-849d5f9c7733"]
}, Open  ]]
}, Open  ]],
Cell[55980, 1353, 153, 3, 67, "Section",ExpressionUUID->"1fdea6c8-e550-49d2-a137-73e817082a28"]
}, Open  ]]
}
]
*)

