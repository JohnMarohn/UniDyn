(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     46526,       1254]
NotebookOptionsPosition[     42849,       1137]
NotebookOutlinePosition[     43206,       1153]
CellTagsIndexPosition[     43163,       1150]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["UniDyn--Demo-04.nb", "Title",
 CellChangeTimes->{{3.6352690845273046`*^9, 3.635269100847275*^9}, {
  3.6609180081345453`*^9, 3.660918013241088*^9}, {3.661433595181979*^9, 
  3.661433595493599*^9}, {3.671421633380262*^9, 3.6714216336468887`*^9}}],

Cell["\<\
John A. Marohn
jam99@cornell.edu
Cornell University\
\>", "Text",
 CellChangeTimes->{{3.635269101985786*^9, 3.635269121580956*^9}},
 FontSize->18],

Cell[TextData[{
 StyleBox["Abstract:",
  FontWeight->"Bold"],
 "  Use the ",
 StyleBox["UniDyn",
  FontWeight->"Bold"],
 " Evolver function to calculate the evolution of the magnetization of a two \
coupled spin = 1/2 particles."
}], "Text",
 CellChangeTimes->{{3.6352698622319117`*^9, 3.635269926908793*^9}, {
  3.6352701305950613`*^9, 3.635270138669529*^9}, {3.6614336154747458`*^9, 
  3.661433666560676*^9}, {3.661433776071369*^9, 3.6614337761699266`*^9}, {
  3.6614620415959*^9, 3.66146210493357*^9}, {3.67142163980396*^9, 
  3.671421654441256*^9}, {3.6714566972027082`*^9, 3.6714567047338247`*^9}},
 FontSize->18],

Cell[CellGroupData[{

Cell["Set the path to the package", "Section",
 CellChangeTimes->{{3.635270036711257*^9, 3.63527004852262*^9}}],

Cell[TextData[{
 "Tell ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " the path to the directory containing the package.    \n\nEDIT THE \
FOLLOWING PATH STRING:"
}], "Text",
 CellChangeTimes->{{3.635270060901009*^9, 3.635270086988311*^9}, {
  3.6610825274488792`*^9, 3.6610825288209763`*^9}},
 FontSize->16],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
   "$PackagePath", " ", "=", 
    "\"\</Users/jam99/Dropbox/MarohnGroup__Software_Library/UniDyn/unidyn\>\"\
"}], ";"}], " "}]], "Input",
 CellChangeTimes->{{3.6349053527016897`*^9, 3.6349054064223843`*^9}, {
  3.634910931339162*^9, 3.634910931457775*^9}, {3.634914337947165*^9, 
  3.6349143671071568`*^9}, {3.634922597904743*^9, 3.634922606812076*^9}, {
  3.635268730835155*^9, 3.635268731125407*^9}, {3.635269951638358*^9, 
  3.635269958323474*^9}, {3.660918115324842*^9, 3.660918132325369*^9}, {
  3.660918590921587*^9, 3.660918600403768*^9}},
 FontSize->16],

Cell["YOU SHOULD NOT NEED TO EDIT ANYTHING FROM HERE ONWARDS.", "Text",
 CellChangeTimes->{{3.635270073196437*^9, 3.635270077357624*^9}},
 FontSize->16]
}, Open  ]],

Cell[CellGroupData[{

Cell["Load the package", "Section",
 CellChangeTimes->{{3.635269129230983*^9, 3.63526913095236*^9}}],

Cell[TextData[{
 "Append the package path to the system path.  Before trying to load the \
package, ask ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " to find it.  This is a test that we directed ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " to the correct directory.  The output of this command should be the full \
system path to the UniDyn.m file.   "
}], "Text",
 CellChangeTimes->{{3.635269223597199*^9, 3.635269340159473*^9}, {
   3.635269947982662*^9, 3.6352699492517843`*^9}, {3.635269985297124*^9, 
   3.63527000724584*^9}, 3.635270066996499*^9, {3.63527010818321*^9, 
   3.6352701131658497`*^9}, {3.660918102499856*^9, 3.6609181035465183`*^9}},
 FontSize->18],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$Path", " ", "=", " ", 
   RowBox[{"AppendTo", "[", 
    RowBox[{"$Path", ",", "$PackagePath"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"FindFile", "[", "\"\<UniDyn`\>\"", "]"}]}], "Input",
 CellChangeTimes->{{3.634906393354924*^9, 3.634906398308229*^9}, {
  3.634922599063291*^9, 3.634922599752222*^9}, {3.635268728673848*^9, 
  3.6352687402094*^9}, {3.635269954012105*^9, 3.6352699550474253`*^9}},
 FontSize->16],

Cell["\<\
Now that we are confident that the path is set correctlly, load the package.  \
Setting the global $VerboseLoad variable to True will print out the help \
strings for key commands in the package.  \
\>", "Text",
 CellChangeTimes->{{3.635269347360386*^9, 3.63526943190546*^9}},
 FontSize->18],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$VerboseLoad", " ", "=", "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Needs", "[", "\"\<UniDyn`\>\"", "]"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQfYUjQpVD9LXjxxR+TRC9peyGEyeQ/lH0EExXTKuJ
BdGbVk8B0zYvFOpA9Ik35o0gmsEzcwKI3ruyF0yrn4ubDqITDHPAdMGBGUdA
9K1JG8G0V4+DGg+Q1vtwBUyLu5WcAtE8yv6nQfT861tdBUDm3NFxA9F2v/Ym
g+h4M4cUED09+VEGiC6rzcoH0RUNSUHSQHqfnVQoiP6uyGkiC6T5nmeCabdp
f25FAekIO8nbINqkKUQlBUiz/Z0DplNs3jwG0Q88GJ+A6Bf2PcZdQNqjYi6Y
XnQt//l3t9eOqzNZX4DoFiF11h9A+sM0WzCtqnCwYKH7a8c9B1ULQTQAyl6Q
EA==
  "],
 FontSize->16],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.671444060089981*^9, 3.671444060645646*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Evolver with simplification", "Section",
 CellChangeTimes->{{3.6714440687071867`*^9, 3.671444088666716*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SimplifyingEvolver", "[", 
   RowBox[{"H_", ",", "t_", ",", "\[Rho]$0_"}], "]"}], ":=", "  ", 
  "\[IndentingNewLine]", "\t", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Evolver", "[", 
      RowBox[{"H", ",", " ", "t", ",", " ", "\[Rho]$0"}], "]"}], "//", 
     "Simplify"}], "//", " ", "ExpToTrig"}], " ", "//", " ", "FullSimplify", 
   " "}]}]], "Input",
 CellChangeTimes->{{3.671444089823865*^9, 3.671444165795093*^9}},
 FontSize->18]
}, Open  ]],

Cell[CellGroupData[{

Cell["Unitary evolution of a single spin 1/2 ", "Section",
 CellChangeTimes->{{3.6614338330758963`*^9, 3.661433850988009*^9}, {
  3.6614339433230333`*^9, 3.661433947755453*^9}, {3.671422107818894*^9, 
  3.671422108739214*^9}, {3.671445264092331*^9, 3.6714452741228848`*^9}}],

Cell[CellGroupData[{

Cell["Create a single spin", "Subsection",
 CellChangeTimes->{{3.661433931683024*^9, 3.661433953976736*^9}}],

Cell[TextData[{
 "The assumptions define below are required for ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " to recognize ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SqrtBox[
     RowBox[{"\[Dash]", 
      RowBox[{
       SuperscriptBox["\[CapitalDelta]", "2"], "-", 
       SuperscriptBox["\[Omega]", "2"]}]}]], "=", " ", 
    RowBox[{"I", 
     SqrtBox[
      RowBox[{
       SuperscriptBox["\[CapitalDelta]", "2"], "+", 
       SuperscriptBox["\[Omega]", "2"]}]]}]}], TraditionalForm]],
  FontSize->14],
 " inside an exponential.   One of the variables has to be defined to be > 0 \
and not just \[GreaterSlantEqual] 0."
}], "Text",
 CellChangeTimes->{{3.661454934610312*^9, 3.661455077339642*^9}, {
   3.661455120999338*^9, 3.6614551250107203`*^9}, {3.66145516298409*^9, 
   3.661455238939184*^9}, {3.6614552751916943`*^9, 3.6614553005499*^9}, 
   3.66169791700492*^9},
 FontSize->18],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"\[CapitalDelta]\[Omega]", ",", "                     ", 
    RowBox[{"(*", " ", 
     RowBox[{"Resonance", " ", "offset", " ", "frequency"}], " ", "*)"}], 
    "\[IndentingNewLine]", "\[Omega]$1", ",", "                  ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Rabi", " ", "frequency", " ", "of", " ", "the", " ", "applied", " ", 
      "irradiation"}], " ", "*)"}], "\[IndentingNewLine]", "Ix", ",", " ", 
    "Iy", ",", " ", "Iz", ",", "  ", 
    RowBox[{"(*", " ", 
     RowBox[{"Spin", " ", "angular", " ", "momentum", " ", "operators"}], " ",
      "*)"}], "\[IndentingNewLine]", "\[Rho]$0", ",", "                  ", 
    RowBox[{"(*", " ", 
     RowBox[{"Initial", " ", "spin", " ", "density", " ", "operator"}], " ", 
     "*)"}], "\[IndentingNewLine]", "H"}], "                          ", 
   RowBox[{"(*", " ", 
    RowBox[{"Spin", " ", "Hamiltonian"}], " ", "*)"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CreateScalar", "[", 
   RowBox[{"\[CapitalDelta]\[Omega]", ",", "\[Omega]$1"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SpinSingle$CreateOperators", "[", 
    RowBox[{"Ix", ",", " ", "Iy", ",", " ", "Iz", ",", " ", 
     RowBox[{"L", "=", 
      RowBox[{"1", "/", "2"}]}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$Assumptions", "  ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Element", "[", 
      RowBox[{"\[CapitalDelta]\[Omega]", ",", " ", "Reals"}], "]"}], ",", " ", 
     RowBox[{
     "\[CapitalDelta]\[Omega]", " ", "\[GreaterSlantEqual]", " ", "0"}], ",", 
     " ", 
     RowBox[{"Element", "[", 
      RowBox[{"\[Omega]$1", ",", " ", "Reals"}], "]"}], ",", " ", 
     RowBox[{
      RowBox[{"\[Omega]", " ", "$1"}], " ", ">", " ", "0"}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.6614339585492563`*^9, 3.661434010703532*^9}, {
   3.661434214867899*^9, 3.661434222437502*^9}, {3.661434384868638*^9, 
   3.6614346039604807`*^9}, {3.6614346490398808`*^9, 3.661434789890903*^9}, {
   3.661435094092959*^9, 3.661435125986967*^9}, {3.6614352184576807`*^9, 
   3.661435260920999*^9}, 3.661454979504386*^9, {3.6614550830373096`*^9, 
   3.6614550896485147`*^9}, {3.661455140167131*^9, 3.66145514338946*^9}, {
   3.6614552141564493`*^9, 3.661455268214559*^9}, {3.67144439281918*^9, 
   3.671444466838715*^9}, {3.6714447797901983`*^9, 3.67144478623868*^9}},
 FontSize->16]
}, Open  ]],

Cell[CellGroupData[{

Cell["On-resonance nutation", "Subsection",
 CellChangeTimes->{{3.661433867714074*^9, 3.661433876857678*^9}, {
  3.671421868173057*^9, 3.671421871614409*^9}, {3.6714219148357353`*^9, 
  3.671421918418017*^9}},
 FontSize->18],

Cell[TextData[{
 "On-resonance irradiation Hamilonian written in the interaction \
representation.  The intial density operator is parallel to ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["I", "x"], TraditionalForm]]],
 "."
}], "Text",
 CellChangeTimes->{{3.66145534764102*^9, 3.661455424815099*^9}, {
  3.671421878357871*^9, 3.671421899244645*^9}, {3.671421943547707*^9, 
  3.671421954189911*^9}},
 FontSize->18],

Cell[BoxData[{
 RowBox[{
  RowBox[{"H", " ", "=", " ", 
   RowBox[{"\[Omega]$1", " ", "Ix"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]$0", " ", "=", " ", "Iz"}], ";"}]}], "Input",
 CellChangeTimes->{{3.661435227848398*^9, 3.6614352284068127`*^9}, {
  3.67142180007626*^9, 3.6714218530576353`*^9}, {3.671421959643671*^9, 
  3.6714219696004133`*^9}, {3.67144444768364*^9, 3.671444447928295*^9}},
 FontSize->18],

Cell["Calculate the time-dependent denstity operator.  ", "Text",
 CellChangeTimes->{{3.6614351443358517`*^9, 3.661435173054531*^9}, {
  3.6614549233087606`*^9, 3.661454923410828*^9}, {3.66145543210454*^9, 
  3.661455456329935*^9}, {3.671444261951881*^9, 3.671444267395067*^9}},
 FontSize->18],

Cell[BoxData[
 RowBox[{
  RowBox[{"SimplifyingEvolver", "[", 
   RowBox[{"H", ",", "t", ",", "\[Rho]$0"}], "]"}], " ", "/.", " ", 
  RowBox[{"{", " ", 
   RowBox[{"\[Omega]$1", "->", " ", 
    RowBox[{"Subscript", "[", 
     RowBox[{"\[Omega]", ",", "1"}], "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.6614340197481413`*^9, 3.661434178968038*^9}, {
   3.661434272954471*^9, 3.661434333128969*^9}, {3.661434640514575*^9, 
   3.661434643212017*^9}, {3.661434786650895*^9, 3.661434809637779*^9}, {
   3.661435106977956*^9, 3.661435116198124*^9}, {3.6614351828003273`*^9, 
   3.661435197915441*^9}, 3.661455661961378*^9, {3.6614557085212173`*^9, 
   3.6614557978065453`*^9}, {3.661455834919834*^9, 3.6614558778332987`*^9}, {
   3.6714218159749727`*^9, 3.671421839685802*^9}, {3.67142199694174*^9, 
   3.671422014075262*^9}, {3.671443825072248*^9, 3.6714439215422697`*^9}, {
   3.671444206438972*^9, 3.671444233751779*^9}, {3.671444450342011*^9, 
   3.671444450487729*^9}},
 FontSize->18]
}, Open  ]],

Cell[CellGroupData[{

Cell["Free evolution", "Subsection",
 CellChangeTimes->{{3.661433867714074*^9, 3.661433876857678*^9}, {
  3.671421868173057*^9, 3.671421871614409*^9}},
 FontSize->18],

Cell[TextData[{
 "Zeeman-interaction Hamilonian written in the interaction representation.  \
The initial density operator is parallel to ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["I", "x"], TraditionalForm]]],
 "."
}], "Text",
 CellChangeTimes->{{3.66145534764102*^9, 3.661455424815099*^9}, {
  3.671421878357871*^9, 3.671421937332016*^9}, {3.6714442931458473`*^9, 
  3.6714442946514378`*^9}},
 FontSize->18],

Cell[BoxData[{
 RowBox[{
  RowBox[{"H", " ", "=", " ", 
   RowBox[{"\[CapitalDelta]\[Omega]", " ", "Iz"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]$0", " ", "=", " ", "Ix"}], ";"}]}], "Input",
 CellChangeTimes->{{3.661435227848398*^9, 3.6614352284068127`*^9}, {
  3.67142180007626*^9, 3.6714218530576353`*^9}, {3.6714220466047583`*^9, 
  3.671422048575047*^9}, {3.671444387730156*^9, 3.671444388691031*^9}},
 FontSize->18],

Cell["Calculate the time-dependent denstity operator.  ", "Text",
 CellChangeTimes->{{3.6614351443358517`*^9, 3.661435173054531*^9}, {
  3.6614549233087606`*^9, 3.661454923410828*^9}, {3.66145543210454*^9, 
  3.661455456329935*^9}, {3.671444261951881*^9, 3.671444267395067*^9}},
 FontSize->18],

Cell[BoxData[
 RowBox[{
  RowBox[{"SimplifyingEvolver", "[", 
   RowBox[{"H", ",", "t", ",", "\[Rho]$0"}], "]"}], " "}]], "Input",
 CellChangeTimes->{{3.6614340197481413`*^9, 3.661434178968038*^9}, {
   3.661434272954471*^9, 3.661434333128969*^9}, {3.661434640514575*^9, 
   3.661434643212017*^9}, {3.661434786650895*^9, 3.661434809637779*^9}, {
   3.661435106977956*^9, 3.661435116198124*^9}, {3.6614351828003273`*^9, 
   3.661435197915441*^9}, 3.661455661961378*^9, {3.6614557085212173`*^9, 
   3.6614557978065453`*^9}, {3.661455834919834*^9, 3.6614558778332987`*^9}, {
   3.6714218159749727`*^9, 3.671421839685802*^9}, {3.67142199694174*^9, 
   3.671422014075262*^9}, {3.671443825072248*^9, 3.6714439215422697`*^9}, {
   3.671444206438972*^9, 3.671444233751779*^9}, {3.671444303923465*^9, 
   3.6714443370387487`*^9}, {3.671444373803419*^9, 3.67144438068778*^9}, {
   3.6714444813129387`*^9, 3.6714444814771967`*^9}},
 FontSize->18]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Unitary evolution of two coupled spins", "Section",
 CellChangeTimes->{{3.6614338330758963`*^9, 3.661433850988009*^9}, {
  3.6614339433230333`*^9, 3.661433947755453*^9}, {3.671422107818894*^9, 
  3.671422108739214*^9}, {3.6714222011816072`*^9, 3.671422206982089*^9}, {
  3.67144525430057*^9, 3.6714453019043407`*^9}}],

Cell[CellGroupData[{

Cell["Create a two spins", "Subsection",
 CellChangeTimes->{{3.661433931683024*^9, 3.661433953976736*^9}, {
  3.6714222121324053`*^9, 3.671422215219035*^9}}],

Cell[TextData[{
 "The assumptions define below are required for ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " to recognize ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SqrtBox[
     RowBox[{"\[Dash]", 
      RowBox[{
       SuperscriptBox["\[CapitalDelta]", "2"], "-", 
       SuperscriptBox["\[Omega]", "2"]}]}]], "=", " ", 
    RowBox[{"I", 
     SqrtBox[
      RowBox[{
       SuperscriptBox["\[CapitalDelta]", "2"], "+", 
       SuperscriptBox["\[Omega]", "2"]}]]}]}], TraditionalForm]],
  FontSize->14],
 " inside an exponential.   One of the variables has to be defined to be > 0 \
and not just \[GreaterSlantEqual] 0."
}], "Text",
 CellChangeTimes->{{3.661454934610312*^9, 3.661455077339642*^9}, {
   3.661455120999338*^9, 3.6614551250107203`*^9}, {3.66145516298409*^9, 
   3.661455238939184*^9}, {3.6614552751916943`*^9, 3.6614553005499*^9}, 
   3.66169791700492*^9},
 FontSize->18],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"\[CapitalDelta]$I", ",", "                 ", 
    RowBox[{"(*", " ", 
     RowBox[{"Resonance", " ", "offset", " ", "frequency"}], " ", "*)"}], 
    "\[IndentingNewLine]", "\[CapitalDelta]$S", ",", "                 ", 
    RowBox[{"(*", " ", 
     RowBox[{"Resonance", " ", "offset", " ", "frequency"}], " ", "*)"}], 
    "\[IndentingNewLine]", "J", ",", "                      ", 
    RowBox[{"(*", " ", 
     RowBox[{"Spin", "-", 
      RowBox[{"spin", " ", "coupling"}]}], " ", "*)"}], "\[IndentingNewLine]",
     "Ix", ",", " ", "Iy", ",", " ", "Iz", ",", " ", 
    RowBox[{"(*", " ", 
     RowBox[{"Spin", " ", "angular", " ", "momentum", " ", "operators"}], " ",
      "*)"}], "\[IndentingNewLine]", "Sx", ",", " ", "Sy", ",", " ", "Sz", 
    ",", " ", 
    RowBox[{"(*", " ", 
     RowBox[{"Spin", " ", "angular", " ", "momentum", " ", "operators"}], " ",
      "*)"}], "\[IndentingNewLine]", "\[Rho]", ",", "                      ", 
    
    RowBox[{"(*", " ", 
     RowBox[{"Spin", " ", "density", " ", "operator"}], " ", "*)"}], " ", 
    "\[IndentingNewLine]", "t", ",", "                       ", 
    RowBox[{"(*", " ", "Time", " ", "*)"}], "\[IndentingNewLine]", "\[Rho]$0",
     ",", "                  ", 
    RowBox[{"(*", " ", 
     RowBox[{"Initial", " ", "spin", " ", "density", " ", "operator"}], " ", 
     "*)"}], "\[IndentingNewLine]", "H"}], "                          ", 
   RowBox[{"(*", " ", 
    RowBox[{"Spin", " ", "Hamiltonian"}], " ", "*)"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CreateScalar", "[", 
   RowBox[{
   "\[CapitalDelta]$I", ",", "\[CapitalDelta]$S", ",", "J", ",", "t"}], " ", 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CreateOperator", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Ix", ",", " ", "Iy", ",", " ", "Iz"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Sx", ",", " ", "Sy", ",", " ", "Sz"}], "}"}]}], "}"}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"SpinSingle$CreateOperators", "[", 
   RowBox[{"Ix", ",", " ", "Iy", ",", " ", "Iz", ",", " ", 
    RowBox[{"L", "=", 
     RowBox[{"1", "/", "2"}]}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SpinSingle$CreateOperators", "[", 
    RowBox[{"Sx", ",", " ", "Sy", ",", " ", "Sz", ",", " ", 
     RowBox[{"L", "=", 
      RowBox[{"1", "/", "2"}]}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$Assumptions", "  ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Element", "[", 
      RowBox[{"\[CapitalDelta]$I", ",", " ", "Reals"}], "]"}], ",", " ", 
     RowBox[{"\[CapitalDelta]$I", " ", "\[GreaterSlantEqual]", " ", "0"}], 
     ",", " ", 
     RowBox[{"Element", "[", 
      RowBox[{"\[CapitalDelta]$S", ",", " ", "Reals"}], "]"}], ",", " ", 
     RowBox[{"\[CapitalDelta]$S", " ", "\[GreaterSlantEqual]", " ", "0"}], 
     ",", " ", 
     RowBox[{"Element", "[", 
      RowBox[{"J", ",", " ", "Reals"}], "]"}], ",", " ", 
     RowBox[{"J", "  ", ">", " ", "0"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6614339585492563`*^9, 3.661434010703532*^9}, {
   3.661434214867899*^9, 3.661434222437502*^9}, {3.661434384868638*^9, 
   3.6614346039604807`*^9}, {3.6614346490398808`*^9, 3.661434789890903*^9}, {
   3.661435094092959*^9, 3.661435125986967*^9}, {3.6614352184576807`*^9, 
   3.661435260920999*^9}, 3.661454979504386*^9, {3.6614550830373096`*^9, 
   3.6614550896485147`*^9}, {3.661455140167131*^9, 3.66145514338946*^9}, {
   3.6614552141564493`*^9, 3.661455268214559*^9}, {3.671422223446307*^9, 
   3.671422276457761*^9}, {3.6714223930390167`*^9, 3.671422478451767*^9}, {
   3.6714445143764687`*^9, 3.671444514801667*^9}, {3.6714447631748466`*^9, 
   3.671444772352507*^9}, {3.671445003838581*^9, 3.6714450185403843`*^9}},
 FontSize->16]
}, Open  ]],

Cell[CellGroupData[{

Cell["Evolution under J coupling", "Subsection",
 CellChangeTimes->{{3.661433867714074*^9, 3.661433876857678*^9}, {
  3.671421868173057*^9, 3.671421871614409*^9}, {3.6714219148357353`*^9, 
  3.671421918418017*^9}, {3.671422672061537*^9, 3.6714226776017923`*^9}},
 FontSize->18],

Cell[TextData[{
 "On-resonance irradiation Hamilonian written in the interaction \
representation.  The intial density operator is parallel to ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["I", "x"], TraditionalForm]]],
 "."
}], "Text",
 CellChangeTimes->{{3.66145534764102*^9, 3.661455424815099*^9}, {
  3.671421878357871*^9, 3.671421899244645*^9}, {3.671421943547707*^9, 
  3.671421954189911*^9}},
 FontSize->18],

Cell[BoxData[{
 RowBox[{
  RowBox[{"H$0", " ", "=", " ", 
   RowBox[{
    RowBox[{"\[CapitalDelta]$I", " ", "Iz"}], " ", "+", " ", 
    RowBox[{"\[CapitalDelta]$S", " ", "Sz"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H$J", " ", "=", "  ", 
   RowBox[{"J", " ", 
    RowBox[{"Iz", " ", "**", "Sz"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]$0", " ", "=", " ", "Ix"}], ";"}]}], "Input",
 CellChangeTimes->{{3.661435227848398*^9, 3.6614352284068127`*^9}, {
  3.67142180007626*^9, 3.6714218530576353`*^9}, {3.671421959643671*^9, 
  3.6714219696004133`*^9}, {3.6714223575305777`*^9, 3.6714223833917007`*^9}, {
  3.671422492003399*^9, 3.6714225172812433`*^9}, {3.671422565223255*^9, 
  3.6714226639457006`*^9}, {3.671422720776108*^9, 3.671422732714869*^9}, {
  3.671422884191368*^9, 3.671422906513636*^9}, {3.671445306458117*^9, 
  3.671445315152834*^9}},
 FontSize->18],

Cell["Try to calculate the density operator in a single step.", "Text",
 CellChangeTimes->{{3.6614351443358517`*^9, 3.661435173054531*^9}, {
  3.6614549233087606`*^9, 3.661454923410828*^9}, {3.66145543210454*^9, 
  3.661455456329935*^9}, {3.671423019921378*^9, 3.671423027975905*^9}, {
  3.671444610818163*^9, 3.6714446239059343`*^9}},
 FontSize->18],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"\[Rho]$0", "//", " ", 
   RowBox[{
    RowBox[{"SimplifyingEvolver", "[", 
     RowBox[{
      RowBox[{"H$0", "+", "H$J"}], ",", "t", ",", " ", "#"}], "]"}], "&"}]}], 
  " ", "*)"}]], "Input",
 CellChangeTimes->{{3.6714445338823757`*^9, 3.67144458551854*^9}, {
  3.67144462976528*^9, 3.6714446319951973`*^9}, {3.6714560711542673`*^9, 
  3.671456073271255*^9}},
 FontSize->18],

Cell["\<\
This single-step evolution fails.  Instead calculate the denstity operator in \
two steps.  We can do this because the H$J and H$0 Hamiltonians commute. \
Evolve under the J-coupling first and under the chemical shift second.\
\>", "Text",
 CellChangeTimes->{{3.6614351443358517`*^9, 3.661435173054531*^9}, {
  3.6614549233087606`*^9, 3.661454923410828*^9}, {3.66145543210454*^9, 
  3.661455456329935*^9}, {3.671423019921378*^9, 3.671423027975905*^9}, {
  3.671444658306387*^9, 3.671444659698904*^9}, {3.6714449146063337`*^9, 
  3.6714449155532513`*^9}, {3.6714450795854177`*^9, 3.67144514621312*^9}, {
  3.671445228941722*^9, 3.671445240799491*^9}},
 FontSize->18],

Cell[BoxData[
 RowBox[{"\[Rho]", " ", "=", " ", 
  RowBox[{
   RowBox[{"\[Rho]$0", "//", " ", 
    RowBox[{
     RowBox[{"SimplifyingEvolver", "[", 
      RowBox[{"H$J", ",", "t", ",", " ", "#"}], "]"}], "&"}]}], " ", "//", 
   " ", 
   RowBox[{
    RowBox[{"SimplifyingEvolver", "[", 
     RowBox[{"H$0", ",", "t", ",", " ", "#"}], "]"}], "&"}]}]}]], "Input",
 CellChangeTimes->{{3.6714445338823757`*^9, 3.67144458551854*^9}, {
  3.671444718970388*^9, 3.671444720200667*^9}, {3.67144506677122*^9, 
  3.671445068444508*^9}},
 FontSize->18],

Cell["\<\
Try another way -- evolve under the chemical shift first and under the \
J-coupling second.\
\>", "Text",
 CellChangeTimes->{{3.671444834167573*^9, 3.671444836235317*^9}, 
   3.6714448860615*^9, {3.67144504811789*^9, 3.6714450516386957`*^9}, {
   3.671445149850709*^9, 3.671445168663072*^9}},
 FontSize->18],

Cell[BoxData[
 RowBox[{"\[Rho]", " ", "=", " ", 
  RowBox[{
   RowBox[{"\[Rho]$0", "//", " ", 
    RowBox[{
     RowBox[{"SimplifyingEvolver", "[", 
      RowBox[{"H$0", ",", "t", ",", " ", "#"}], "]"}], "&"}]}], " ", "//", 
   " ", 
   RowBox[{
    RowBox[{"SimplifyingEvolver", "[", 
     RowBox[{"H$J", ",", "t", ",", " ", "#"}], "]"}], "&"}]}]}]], "Input",
 CellChangeTimes->{{3.671444842217965*^9, 3.67144484462682*^9}, {
  3.671445070458337*^9, 3.6714450715733213`*^9}},
 FontSize->18],

Cell["We see by inspection that we get the same answer either way.", "Text",
 CellChangeTimes->{{3.671445189839492*^9, 3.671445213699987*^9}},
 FontSize->18]
}, Open  ]],

Cell[CellGroupData[{

Cell["Load spin 1/2 operator matrices", "Subsection",
 CellChangeTimes->{{3.661433867714074*^9, 3.661433876857678*^9}, {
  3.671421868173057*^9, 3.671421871614409*^9}, {3.6714219148357353`*^9, 
  3.671421918418017*^9}, {3.671422672061537*^9, 3.6714226776017923`*^9}, {
  3.671445358783841*^9, 3.671445362453095*^9}, {3.671446027798325*^9, 
  3.6714460412821283`*^9}, {3.6714462497064*^9, 3.671446264593584*^9}},
 FontSize->18],

Cell["\<\
Load matrices representing two J=1/2 spins and give them a test drive.\
\>", "Text",
 CellChangeTimes->{{3.6714456820202208`*^9, 3.6714457113829813`*^9}, {
  3.671445998615802*^9, 3.6714460069003553`*^9}},
 FontSize->18],

Cell[BoxData[
 RowBox[{"<<", "Matrices--two-spin-half.m"}]], "Input",
 CellChangeTimes->{{3.671445490424717*^9, 3.6714454909529467`*^9}},
 FontSize->16],

Cell["Let's look at one of the matrices, the matrix for Iz. ", "Text",
 CellChangeTimes->{{3.671446066910582*^9, 3.6714461288371677`*^9}},
 FontSize->18],

Cell[BoxData[{
 RowBox[{"mIz", " ", "//", " ", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"mSz", " ", "//", " ", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.6714461004791517`*^9, 3.671446108624913*^9}, {
  3.6714561340688353`*^9, 3.6714561363062973`*^9}},
 FontSize->18],

Cell["\<\
For a single spin 1/2 particle, Iz is a 2 x 2 matrix.  In the product space \
of two spin 1/2 particles, however, the Iz is now a 4 x 4 matrix.  All the \
operators are 4 x 4 matrices.

Check that the [Ix, Iy]/I = Iz and [Sx, Sy]/I = Sz commutation relations hold \
with the matrices.\
\>", "Text",
 CellChangeTimes->{{3.6714457461606293`*^9, 3.671445793433889*^9}, {
  3.671446130846957*^9, 3.6714462332544622`*^9}},
 FontSize->18],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"m$1", "=", " ", 
    FractionBox[
     RowBox[{
      RowBox[{"mIx", " ", ".", " ", "mIy"}], " ", "-", " ", 
      RowBox[{"mIy", ".", "mIx"}]}], "I"]}], " ", ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"m$2", " ", "=", " ", 
    FractionBox[
     RowBox[{
      RowBox[{"mSx", " ", ".", " ", "mSy"}], " ", "-", " ", 
      RowBox[{"mSy", ".", "mSx"}]}], "I"]}], " ", ";"}], " "}]}], "Input",
 CellChangeTimes->{{3.671445494504896*^9, 3.671445533291304*^9}, {
  3.671445568666006*^9, 3.67144560414019*^9}, {3.6714458103519*^9, 
  3.671445839226697*^9}},
 FontSize->16],

Cell[BoxData[{
 RowBox[{
  RowBox[{"m$1", " ", "//", " ", "MatrixForm"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"should", " ", "be", " ", "Iz"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"m$2", " ", "//", " ", "MatrixForm", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"should", " ", "be", " ", "Sz"}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.67144559223693*^9, 3.671445621775893*^9}, {
  3.671445829324806*^9, 3.671445840614127*^9}},
 FontSize->16],

Cell["\<\
Make the (matrix) operator I$total = Iz + Sz.  We can see by inspection that \
this matrix looks correct.  The I$total operator should have eigenvalues \
{-1,0,0,+1}.  The matrix I$total is diagonal and we can read the eigenvalues \
off diagonal elements.\
\>", "Text",
 CellChangeTimes->{{3.671445880334059*^9, 3.6714459936436*^9}},
 FontSize->18],

Cell[BoxData[
 RowBox[{
  RowBox[{"m$1", " ", "+", " ", "m$2"}], " ", "//", " ", 
  "MatrixForm"}]], "Input",
 FontSize->16]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculate the analytical signal using the matrices", "Subsection",
 CellChangeTimes->{{3.671446273220752*^9, 3.671446279573361*^9}, {
  3.671446693404964*^9, 3.6714467036370564`*^9}, {3.671446816216303*^9, 
  3.671446818974146*^9}}],

Cell["Calculate the density operator matrix.", "Text",
 CellChangeTimes->{{3.671446402857369*^9, 3.671446411712953*^9}},
 FontSize->18],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Rho]$matrix", " ", "=", " ", 
   RowBox[{"\[Rho]", " ", "/.", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Ix", "\[Rule]", " ", "mIx"}], ",", " ", 
      RowBox[{"Iy", "\[Rule]", " ", "mIy"}], ",", " ", 
      RowBox[{"Iz", "\[Rule]", " ", "mIz"}], ",", " ", 
      RowBox[{"Sx", "\[Rule]", " ", "mSx"}], ",", " ", 
      RowBox[{"Sy", "\[Rule]", " ", "mSy"}], ",", " ", 
      RowBox[{"Sz", "\[Rule]", " ", "mSz"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"\[Rho]$matrix", " ", "//", " ", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.671446283504434*^9, 3.671446370013102*^9}},
 FontSize->16],

Cell["\<\
From this matrix we can calculate the I-spin signals as Trace[\[Rho] Ix] and \
Trace[\[Rho] Iy]\
\>", "Text",
 CellChangeTimes->{{3.671446415848536*^9, 3.6714464343628063`*^9}, {
  3.671446572921509*^9, 3.671446610169005*^9}},
 FontSize->18],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Tr", "[", 
   RowBox[{"\[Rho]$matrix", " ", ".", " ", "mIx"}], "]"}], " ", "//", " ", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tr", "[", 
   RowBox[{"\[Rho]$matrix", " ", ".", " ", "mIy"}], "]"}], " ", "//", " ", 
  "Simplify"}]}], "Input",
 CellChangeTimes->{{3.671446436184062*^9, 3.671446460159924*^9}, {
  3.671446493512258*^9, 3.671446525803396*^9}, {3.671446589260594*^9, 
  3.6714465911514063`*^9}},
 FontSize->16],

Cell["\<\
We can mimic the complex signal collected by the NMR spectrometer by \
calculating the expectation value of the Ix + I Iy operator: Trace[\[Rho] \
(Ix+ I Iy)].\
\>", "Text",
 CellChangeTimes->{{3.671446615373083*^9, 3.671446675573143*^9}},
 FontSize->18],

Cell[BoxData[
 RowBox[{
  RowBox[{"S", "[", "t_", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"Tr", "[", 
    RowBox[{"\[Rho]$matrix", " ", ".", " ", 
     RowBox[{"(", 
      RowBox[{"mIx", "-", " ", 
       RowBox[{"I", " ", "mIy"}]}], ")"}]}], "]"}], "  ", "//", " ", 
   "TrigToExp", " "}]}]], "Input",
 CellChangeTimes->{{3.671446537674589*^9, 3.671446565590992*^9}, {
   3.671446679689185*^9, 3.671446686372024*^9}, {3.671446793205759*^9, 
   3.671446804190036*^9}, 3.6714481371244497`*^9, {3.6714505565428677`*^9, 
   3.671450556829133*^9}},
 FontSize->16]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plot the signal as a function of time", "Subsection",
 CellChangeTimes->{{3.671446822352291*^9, 3.6714468757257767`*^9}},
 FontSize->18],

Cell["\<\
Create a more realistic experimental signal by multiplying the \
above-calculated signal by a decaying exponential.\
\>", "Text",
 CellChangeTimes->{{3.6714469211618567`*^9, 3.6714470073287077`*^9}},
 FontSize->18],

Cell[BoxData[
 RowBox[{
  RowBox[{"S$expt", "[", "t_", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{"S", "[", "t", "]"}], " ", 
   RowBox[{"Exp", "[", 
    RowBox[{
     RowBox[{"-", "t"}], "/", "T2"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.671446889252241*^9, 3.6714469026844177`*^9}, {
  3.671446959436038*^9, 3.671446970904915*^9}, {3.671447429270523*^9, 
  3.6714474332727137`*^9}},
 FontSize->16],

Cell["\<\
To plot, set the total number of points (NN) and the total time (T).  We set \
NN equal to a power of 2 in anticipation of taking a digital Fourier \
transform.\
\>", "Text",
 CellChangeTimes->{{3.5949414229321012`*^9, 3.594941479672656*^9}},
 FontSize->18],

Cell[BoxData[{
 RowBox[{
  RowBox[{"NN", " ", "=", " ", 
   RowBox[{"2", "^", "10"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"T", " ", "=", " ", "10.0"}], ";"}]}], "Input",
 CellChangeTimes->{{3.594991722414856*^9, 3.5949917229397697`*^9}, {
  3.6714502329166527`*^9, 3.671450233424068*^9}, {3.671450477554515*^9, 
  3.6714504778582277`*^9}},
 FontSize->18],

Cell["\<\
From NN and T we derive the time step (dt) and the frequency step (df).  Now \
generate a list of data points based on the above function.  At the same \
time, generate a list of time points (t) and frequency points (f) for \
plotting. \
\>", "Text",
 CellChangeTimes->{{3.59494150240346*^9, 3.594941603782978*^9}},
 FontSize->18],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dt", " ", "=", " ", 
   RowBox[{"T", "/", 
    RowBox[{"(", 
     RowBox[{"NN", "-", "1"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"df", " ", "=", " ", 
    RowBox[{"1", "/", "dt"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Y", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"y", "[", "t", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "0", ",", "T", ",", "dt"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"jj", "/", "T"}], ",", 
     RowBox[{"{", 
      RowBox[{"jj", ",", 
       RowBox[{
        RowBox[{"-", "NN"}], "/", "2"}], ",", 
       RowBox[{
        RowBox[{"NN", "/", "2"}], "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"ii", "*", "dt"}], ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", "0", ",", 
        RowBox[{"NN", "-", "1"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<The time step is \>\"", ",", "dt", ",", "\"\< s\>\""}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<The Nyquist frequency is \>\"", ",", 
   RowBox[{"1", "/", 
    RowBox[{"(", 
     RowBox[{"2", "*", "dt"}], ")"}]}], ",", "\"\< Hz\>\""}], "]"}]}], "Input",\

 CellChangeTimes->{{3.59493235695424*^9, 3.5949324622740393`*^9}, {
   3.5949329212374773`*^9, 3.594933020293639*^9}, {3.594941484330391*^9, 
   3.594941501373295*^9}, {3.594941696885819*^9, 3.5949417765822287`*^9}, {
   3.594941818366678*^9, 3.594941819859702*^9}, {3.5949469989336433`*^9, 
   3.594947001044293*^9}, 3.5949577630752707`*^9},
 FontSize->18],

Cell["Give numbers for the chemical shift and the J-coupling.", "Text",
 CellChangeTimes->{{3.671447394983695*^9, 3.6714474158952637`*^9}},
 FontSize->18],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalDelta]$I", " ", "=", " ", 
    RowBox[{"2", "\[Pi]", " ", "\[Times]", "10.0"}]}], ";"}], "    ", 
  RowBox[{"(*", " ", 
   RowBox[{"chemical", " ", 
    RowBox[{"shift", " ", "[", 
     RowBox[{"rad", "/", "s"}], "]"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"J", " ", "=", "  ", 
    RowBox[{"2", "\[Pi]", " ", "\[Times]", " ", "8.0"}]}], ";"}], "         ", 
  RowBox[{"(*", " ", 
   RowBox[{"heteronuclear", " ", "scalar", " ", "coupling", " ", 
    RowBox[{"constant", " ", "[", 
     RowBox[{"rad", "/", "s"}], "]"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"T2", " ", "=", " ", "1.0"}], ";"}], "                  ", 
  RowBox[{"(*", " ", 
   RowBox[{"spin", " ", "dephasing", " ", 
    RowBox[{"time", " ", "[", "s", "]"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.671447604729793*^9, 3.671447668917508*^9}, {
  3.6714477541558647`*^9, 3.671447778543397*^9}, {3.671450991153552*^9, 
  3.671451022391514*^9}},
 FontSize->18],

Cell["Plot the real and imaginary part of the signal", "Text",
 CellChangeTimes->{{3.6714500367811728`*^9, 3.67145005728123*^9}},
 FontSize->18],

Cell[BoxData[
 RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"t", ",", " ", 
        RowBox[{
         RowBox[{"S$expt", " ", "/@", " ", "t"}], " ", "//", " ", "Re"}]}], 
       "}"}], " ", "//", " ", "Transpose"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"t", ",", " ", 
        RowBox[{
         RowBox[{"S$expt", " ", "/@", " ", "t"}], " ", "//", " ", "Im"}]}], 
       "}"}], " ", "//", " ", "Transpose"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Joined", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", "\[IndentingNewLine]", 
   RowBox[{
   "PlotLabel", "\[Rule]", 
    "\"\<Free induction decay of 1H coupled to 13C\\n\>\""}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<time [s]\>\"", ",", "\"\<Signal(t)\>\""}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.67144779890044*^9, 3.671447848340846*^9}, {
  3.671447937029454*^9, 3.6714479473527603`*^9}, {3.671447999669054*^9, 
  3.671448034363092*^9}, {3.671449785628702*^9, 3.671449951663116*^9}},
 FontSize->18],

Cell["\<\
A function to calculate the digital Fourier transform of signal.\
\>", "Text",
 CellChangeTimes->{{3.67145051013356*^9, 3.671450534424446*^9}},
 FontSize->18],

Cell[BoxData[
 RowBox[{
  RowBox[{"DFFT", "[", 
   RowBox[{"signal_", ",", "t_", ",", " ", 
    RowBox[{"query_:", "True"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "True", " ", "to", " ", "plot", " ", "both", " ", "real", " ", "and", " ", 
    "imaginary", " ", "FT", " ", "parts"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "NN", "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"NN", " ", "=", " ", 
      RowBox[{
       RowBox[{"Dimensions", "[", 
        RowBox[{"signal", " ", "/@", " ", "t"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"FFTS", " ", "=", " ", 
      RowBox[{"RotateRight", "[", 
       RowBox[{
        RowBox[{"Fourier", "[", 
         RowBox[{"signal", "/@", " ", "t"}], "]"}], ",", 
        RowBox[{"NN", "/", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"T", " ", "=", " ", 
      RowBox[{"t", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"f", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"jj", "/", "T"}], ",", 
        RowBox[{"{", 
         RowBox[{"jj", ",", 
          RowBox[{
           RowBox[{"-", "NN"}], "/", "2"}], ",", 
          RowBox[{
           RowBox[{"NN", "/", "2"}], "-", "1"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"p1", "=", " ", 
      RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"t", ",", 
             RowBox[{"Re", "[", 
              RowBox[{"signal", " ", "/@", " ", "t"}], "]"}]}], "}"}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"t", ",", 
             RowBox[{"Im", "[", 
              RowBox[{"signal", "/@", " ", "t"}], "]"}]}], "}"}], "]"}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"AxesLabel", "\[Rule]", " ", 
         RowBox[{"{", 
          RowBox[{"\"\<time [s]\>\"", ",", "\"\<signal\>\""}], "}"}]}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"query", " ", "\[Equal]", " ", "True"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"p2", "=", 
        RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{"f", ",", 
               RowBox[{"Re", "[", "FFTS", "]"}]}], "}"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{"f", ",", 
               RowBox[{"Im", "[", "FFTS", "]"}]}], "}"}], "]"}]}], " ", "}"}],
           ",", "\[IndentingNewLine]", 
          RowBox[{"PlotRange", "\[Rule]", " ", "All"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<freq [Hz]\>\"", ",", "\"\<DFT{signal}\>\""}], 
            "}"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"p2", "=", 
        RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"f", ",", 
             RowBox[{"Re", "[", "FFTS", "]"}]}], "}"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"PlotRange", "\[Rule]", " ", "All"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<freq [Hz]\>\"", ",", "\"\<DFT{signal}\>\""}], 
            "}"}]}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{"GraphicsGrid", "[", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"p1", ",", "p2"}], "}"}], "}"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.594944534421811*^9, 3.5949447042651577`*^9}, {
   3.594944761549816*^9, 3.5949447856729527`*^9}, {3.5949457080553913`*^9, 
   3.594945725580372*^9}, 3.594957008065167*^9, {3.5949599090104303`*^9, 
   3.594959943126217*^9}, {3.671420918194263*^9, 3.671420985060692*^9}, {
   3.6714500698553047`*^9, 3.6714501975055017`*^9}, {3.671450354497389*^9, 
   3.671450368115725*^9}, {3.6714504102572317`*^9, 3.671450429646456*^9}, {
   3.6714507085616426`*^9, 3.671450719913899*^9}, {3.671450779304175*^9, 
   3.671450820615818*^9}, {3.6714508637422657`*^9, 3.671450868872673*^9}, {
   3.6714509162185383`*^9, 3.671450949134245*^9}, {3.6714510544854803`*^9, 
   3.671451069853394*^9}},
 FontSize->18],

Cell["Fourier transform the signal to obtain the spectrum.", "Text",
 CellChangeTimes->{{3.6714510493757668`*^9, 3.6714510513046627`*^9}, {
  3.671451088925737*^9, 3.671451100765924*^9}},
 FontSize->18],

Cell[BoxData[{
 RowBox[{"DFFT", "[", 
  RowBox[{"S$expt", ",", "t"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"DFFT", "[", 
  RowBox[{"S$expt", ",", "t", ",", " ", "False"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6714476849652023`*^9, 3.671447688933979*^9}, {
  3.671450451756751*^9, 3.671450457086381*^9}, {3.671450955985718*^9, 
  3.671450959835928*^9}, {3.671451075639289*^9, 3.6714510806381702`*^9}},
 FontSize->18]
}, Open  ]]
}, Open  ]],

Cell["Clean up", "Section",
 CellChangeTimes->{{3.661434199971715*^9, 3.661434206498426*^9}}]
}, Open  ]]
},
WindowSize->{896, 969},
WindowMargins->{{46, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September 9, \
2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 251, 3, 92, "Title"],
Cell[834, 27, 156, 6, 83, "Text"],
Cell[993, 35, 618, 14, 59, "Text"],
Cell[CellGroupData[{
Cell[1636, 53, 111, 1, 64, "Section"],
Cell[1750, 56, 315, 9, 77, "Text"],
Cell[2068, 67, 608, 13, 54, "Input"],
Cell[2679, 82, 152, 2, 33, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2868, 89, 100, 1, 64, "Section"],
Cell[2971, 92, 686, 15, 83, "Text"],
Cell[3660, 109, 463, 10, 53, "Input"],
Cell[4126, 121, 301, 6, 59, "Text"],
Cell[4430, 129, 590, 13, 53, "Input"],
Cell[5023, 144, 92, 1, 28, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5152, 150, 114, 1, 64, "Section"],
Cell[5269, 153, 480, 13, 57, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5786, 171, 274, 3, 64, "Section"],
Cell[CellGroupData[{
Cell[6085, 178, 108, 1, 44, "Subsection"],
Cell[6196, 181, 899, 26, 65, "Text"],
Cell[7098, 209, 2534, 53, 253, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9669, 267, 224, 4, 42, "Subsection"],
Cell[9896, 273, 413, 11, 61, "Text"],
Cell[10312, 286, 428, 9, 57, "Input"],
Cell[10743, 297, 293, 4, 35, "Text"],
Cell[11039, 303, 988, 18, 33, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12064, 326, 166, 3, 42, "Subsection"],
Cell[12233, 331, 412, 11, 61, "Text"],
Cell[12648, 344, 445, 10, 57, "Input"],
Cell[13096, 356, 293, 4, 35, "Text"],
Cell[13392, 362, 935, 15, 33, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[14376, 383, 323, 4, 64, "Section"],
Cell[CellGroupData[{
Cell[14724, 391, 157, 2, 44, "Subsection"],
Cell[14884, 395, 899, 26, 65, "Text"],
Cell[15786, 423, 3947, 84, 393, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19770, 512, 277, 4, 42, "Subsection"],
Cell[20050, 518, 413, 11, 61, "Text"],
Cell[20466, 531, 906, 20, 80, "Input"],
Cell[21375, 553, 350, 5, 35, "Text"],
Cell[21728, 560, 421, 11, 33, "Input"],
Cell[22152, 573, 675, 11, 83, "Text"],
Cell[22830, 586, 539, 14, 57, "Input"],
Cell[23372, 602, 317, 7, 35, "Text"],
Cell[23692, 611, 491, 13, 57, "Input"],
Cell[24186, 626, 157, 2, 35, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24380, 633, 426, 6, 42, "Subsection"],
Cell[24809, 641, 230, 5, 35, "Text"],
Cell[25042, 648, 152, 3, 32, "Input"],
Cell[25197, 653, 153, 2, 35, "Text"],
Cell[25353, 657, 281, 5, 57, "Input"],
Cell[25637, 664, 442, 10, 107, "Text"],
Cell[26082, 676, 645, 19, 99, "Input"],
Cell[26730, 697, 463, 11, 53, "Input"],
Cell[27196, 710, 358, 7, 83, "Text"],
Cell[27557, 719, 124, 4, 32, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27718, 728, 238, 3, 44, "Subsection"],
Cell[27959, 733, 135, 2, 35, "Text"],
Cell[28097, 737, 659, 15, 53, "Input"],
Cell[28759, 754, 251, 6, 35, "Text"],
Cell[29013, 762, 478, 12, 53, "Input"],
Cell[29494, 776, 264, 6, 59, "Text"],
Cell[29761, 784, 560, 14, 33, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30358, 803, 142, 2, 42, "Subsection"],
Cell[30503, 807, 224, 5, 59, "Text"],
Cell[30730, 814, 406, 11, 33, "Input"],
Cell[31139, 827, 267, 6, 59, "Text"],
Cell[31409, 835, 371, 9, 57, "Input"],
Cell[31783, 846, 340, 7, 83, "Text"],
Cell[32126, 855, 1930, 56, 241, "Input"],
Cell[34059, 913, 154, 2, 35, "Text"],
Cell[34216, 917, 1089, 27, 126, "Input"],
Cell[35308, 946, 144, 2, 35, "Text"],
Cell[35455, 950, 1261, 31, 195, "Input"],
Cell[36719, 983, 168, 4, 35, "Text"],
Cell[36890, 989, 5194, 125, 747, "Input"],
Cell[42087, 1116, 202, 3, 35, "Text"],
Cell[42292, 1121, 421, 8, 57, "Input"]
}, Open  ]]
}, Open  ]],
Cell[42740, 1133, 93, 1, 64, "Section"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
